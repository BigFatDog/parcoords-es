{"version":3,"file":"parcoords.js","sources":["../src/util/renderQueue.js","../src/util/width.js","../src/brush/invertByScale.js","../src/brush/1d/brushExtents.js","../src/brush/1d/brushReset.js","../src/brush/1d/selected.js","../src/brush/1d/brushFor.js","../src/brush/1d/install.js","../src/brush/1d/uninstall.js","../src/brush/1d/index.js","../src/brush/1d-multi/drawBrushes.js","../src/brush/1d-multi/selected.js","../src/brush/1d-multi/newBrush.js","../src/brush/1d-multi/brushExtents.js","../src/brush/1d-multi/brushReset.js","../src/brush/1d-multi/brushFor.js","../src/brush/1d-multi/install.js","../src/brush/1d-multi/uninstall.js","../src/brush/1d-multi/index.js","../src/brush/strums/uninstall.js","../src/brush/strums/selected.js","../src/brush/strums/removeStrum.js","../src/brush/strums/onDragEnd.js","../src/brush/strums/onDrag.js","../src/util/height.js","../src/brush/dimensionsForPoint.js","../src/brush/strums/onDragStart.js","../src/brush/strums/brushReset.js","../src/brush/consecutive.js","../src/brush/strums/install.js","../src/brush/strums/index.js","../src/brush/angular/uninstall.js","../src/brush/angular/util/hypothenuse.js","../src/brush/angular/selected.js","../src/brush/angular/removeStrum.js","../src/brush/angular/onDragEnd.js","../src/brush/angular/onDrag.js","../src/brush/angular/onDragStart.js","../src/brush/angular/brushReset.js","../src/brush/angular/install.js","../src/brush/angular/index.js","../src/api/intersection.js","../src/api/mergeParcoords.js","../src/api/selected.js","../src/api/brushMode.js","../src/util/dimensionLabels.js","../src/util/flipAxisAndUpdatePCP.js","../src/util/rotateLabels.js","../src/api/updateAxes.js","../src/util/getRange.js","../src/api/autoscale.js","../src/api/brushable.js","../src/api/commonScale.js","../src/api/computeRealCentroids.js","../src/api/applyDimensionDefaults.js","../src/api/createAxes.js","../src/api/axisDots.js","../src/api/applyAxisConfig.js","../src/api/reorderable.js","../src/api/resize.js","../src/api/reorder.js","../src/api/sortDimensions.js","../src/api/sortDimensionsByRowData.js","../src/util/isBrushed.js","../src/api/clear.js","../node_modules/sylvester-es6/src/PRECISION.js","../node_modules/sylvester-es6/src/Matrix.js","../node_modules/sylvester-es6/src/Vector.js","../src/util/computeCentroids.js","../src/util/computeControlPoints.js","../src/util/colorPath.js","../src/util/functor.js","../src/api/renderMarked.js","../src/api/renderBrushed.js","../src/api/brushReset.js","../src/api/toType.js","../src/api/toString.js","../src/api/adjacentPairs.js","../src/api/highlight.js","../src/api/unhighlight.js","../src/api/mark.js","../src/api/unmark.js","../src/api/removeAxes.js","../src/api/render.js","../src/api/renderDefault.js","../src/api/toTypeCoerceNumbers.js","../src/api/detectDimensionTypes.js","../src/api/getOrderedDimensionKeys.js","../src/api/interactive.js","../src/api/shadows.js","../src/api/init.js","../src/api/flip.js","../src/api/detectDimensions.js","../src/api/scale.js","../src/state/defaultConfig.js","../src/state/index.js","../src/util/computeClusterCentroids.js","../src/state/sideEffects.js","../src/util/getset.js","../src/bindEvents.js","../src/index.js"],"sourcesContent":["import 'requestanimationframe';\r\n\r\nconst renderQueue = function(func) {\r\n  let _queue = [], // data to be rendered\r\n    _rate = 1000, // number of calls per frame\r\n    _invalidate = function() {}, // invalidate last render queue\r\n    _clear = function() {}; // clearing function\r\n\r\n  let rq = function(data) {\r\n    if (data) rq.data(data);\r\n    _invalidate();\r\n    _clear();\r\n    rq.render();\r\n  };\r\n\r\n  rq.render = function() {\r\n    let valid = true;\r\n    _invalidate = rq.invalidate = function() {\r\n      valid = false;\r\n    };\r\n\r\n    function doFrame() {\r\n      if (!valid) return true;\r\n      let chunk = _queue.splice(0, _rate);\r\n      chunk.map(func);\r\n      requestAnimationFrame(doFrame);\r\n    }\r\n\r\n    doFrame();\r\n  };\r\n\r\n  rq.data = function(data) {\r\n    _invalidate();\r\n    _queue = data.slice(0); // creates a copy of the data\r\n    return rq;\r\n  };\r\n\r\n  rq.add = function(data) {\r\n    _queue = _queue.concat(data);\r\n  };\r\n\r\n  rq.rate = function(value) {\r\n    if (!arguments.length) return _rate;\r\n    _rate = value;\r\n    return rq;\r\n  };\r\n\r\n  rq.remaining = function() {\r\n    return _queue.length;\r\n  };\r\n\r\n  // clear the canvas\r\n  rq.clear = function(func) {\r\n    if (!arguments.length) {\r\n      _clear();\r\n      return rq;\r\n    }\r\n    _clear = func;\r\n    return rq;\r\n  };\r\n\r\n  rq.invalidate = _invalidate;\r\n\r\n  return rq;\r\n};\r\n\r\nexport default renderQueue;\r\n","const w = config => config.width - config.margin.right - config.margin.left;\r\n\r\nexport default w;\r\n","const invertCategorical = (selection, scale) => {\r\n  if (selection.length === 0) {\r\n    return [];\r\n  }\r\n  const domain = scale.domain();\r\n  const range = scale.range();\r\n  const found = [];\r\n  range.forEach((d, i) => {\r\n    if (d >= selection[0] && d <= selection[1]) {\r\n      found.push(domain[i]);\r\n    }\r\n  });\r\n  return found;\r\n};\r\n\r\nconst invertByScale = (selection, scale) => {\r\n  if (scale === null) return [];\r\n  return typeof scale.invert === 'undefined'\r\n    ? invertCategorical(selection, scale)\r\n    : selection.map(d => scale.invert(d));\r\n};\r\n\r\nexport default invertByScale;\r\nexport { invertByScale };\r\n","import { select } from 'd3-selection';\r\nimport { brushSelection } from 'd3-brush';\r\n\r\nimport invertByScale from '../invertByScale';\r\n\r\nconst brushExtents = (state, config, pc) => (extents, type = \"scaled\") => {\r\n    const { brushes, brushNodes } = state;\r\n\r\n    if (typeof extents === 'undefined') {\r\n        return Object.keys(config.dimensions).reduce((acc, cur) => {\r\n            const brush = brushes[cur];\r\n            //todo: brush check\r\n            if (brush !== undefined && brushSelection(brushNodes[cur]) !== null) {\r\n                const raw = brushSelection(brushNodes[cur]);\r\n                const yScale = config.dimensions[cur].yscale;\r\n                const scaled = invertByScale(raw, yScale);\r\n\r\n                acc[cur] = {\r\n                    extent: brush.extent(),\r\n                    selection: {\r\n                        raw,\r\n                        scaled,\r\n                    },\r\n                };\r\n            }\r\n\r\n            return acc;\r\n        }, {});\r\n    } else {\r\n        //first get all the brush selections\r\n        const brushSelections = {};\r\n        pc.g()\r\n            .selectAll('.brush')\r\n            .each(function(d) {\r\n                brushSelections[d] = select(this);\r\n            });\r\n\r\n        // loop over each dimension and update appropriately (if it was passed in through extents)\r\n        Object.keys(config.dimensions).forEach(d => {\r\n            if (extents[d] === undefined) {\r\n                return;\r\n            }\r\n\r\n            const brush = brushes[d];\r\n            if (brush !== undefined) {\r\n\r\n                if (type === \"raw\") {\r\n                    brushSelections[d].call(brush).call(brush.move, extents[d]);\r\n                } else {\r\n                    const dim = config.dimensions[d];\r\n                    const yExtent = extents[d].map(dim.yscale);\r\n\r\n                    //update the extent\r\n                    //sets the brushable extent to the specified array of points [[x0, y0], [x1, y1]]\r\n                    //we actually don't need this since we are using brush.move below\r\n                    //extents set the limits of the brush which means a user will not be able\r\n                    //to move or drag the brush beyond the limits set by brush.extent\r\n                    //brush.extent([[-15, yExtent[1]], [15, yExtent[0]]]);\r\n\r\n                    //redraw the brush\r\n                    //https://github.com/d3/d3-brush#brush_move\r\n                    // For an x-brush, it must be defined as [x0, x1]; for a y-brush, it must be defined as [y0, y1].\r\n                    brushSelections[d].call(brush).call(brush.move, yExtent.reverse());\r\n\r\n                    //fire some events\r\n                    // brush.event(brushSelections[d]);\r\n                }\r\n\r\n            }\r\n        });\r\n\r\n        //redraw the chart\r\n        pc.renderBrushed();\r\n\r\n        return pc;\r\n    }\r\n};\r\n\r\nexport default brushExtents;","import { select } from 'd3-selection';\r\n\r\nconst brushReset = (state, config, pc) => dimension => {\r\n  const { brushes } = state;\r\n\r\n  if (dimension === undefined) {\r\n    config.brushed = false;\r\n    if (pc.g() !== undefined && pc.g() !== null) {\r\n      pc.g()\r\n        .selectAll('.brush')\r\n        .each(function(d) {\r\n          if (brushes[d] !== undefined) {\r\n            select(this).call(brushes[d].move, null);\r\n          }\r\n        });\r\n      pc.renderBrushed();\r\n    }\r\n  } else {\r\n    config.brushed = false;\r\n    if (pc.g() !== undefined && pc.g() !== null) {\r\n      pc.g()\r\n        .selectAll('.brush')\r\n        .each(function(d) {\r\n          if (d !== dimension) return;\r\n          select(this).call(brushes[d].move, null);\r\n          if (typeof brushes[d].type === 'function') {\r\n            brushes[d].event(select(this));\r\n          }\r\n        });\r\n      pc.renderBrushed();\r\n    }\r\n  }\r\n  return this;\r\n};\r\n\r\nexport default brushReset;\r\n","import { brushSelection } from 'd3-brush';\r\n//https://github.com/d3/d3-brush/issues/10\r\n\r\n// data within extents\r\nconst selected = (state, config, brushGroup) => () => {\r\n  const { brushNodes } = state;\r\n  const is_brushed = p =>\r\n    brushNodes[p] && brushSelection(brushNodes[p]) !== null;\r\n\r\n  const actives = Object.keys(config.dimensions).filter(is_brushed);\r\n  const extents = actives.map(p => {\r\n    const _brushRange = brushSelection(brushNodes[p]);\r\n\r\n    if (typeof config.dimensions[p].yscale.invert === 'function') {\r\n      return [\r\n        config.dimensions[p].yscale.invert(_brushRange[1]),\r\n        config.dimensions[p].yscale.invert(_brushRange[0]),\r\n      ];\r\n    } else {\r\n      return _brushRange;\r\n    }\r\n  });\r\n  // We don't want to return the full data set when there are no axes brushed.\r\n  // Actually, when there are no axes brushed, by definition, no items are\r\n  // selected. So, let's avoid the filtering and just return false.\r\n  //if (actives.length === 0) return false;\r\n\r\n  // Resolves broken examples for now. They expect to get the full dataset back from empty brushes\r\n  if (actives.length === 0) return config.data;\r\n\r\n  // test if within range\r\n  const within = {\r\n    date: (d, p, dimension) => {\r\n      if (typeof config.dimensions[p].yscale.bandwidth === 'function') {\r\n        // if it is ordinal\r\n        return (\r\n          extents[dimension][0] <= config.dimensions[p].yscale(d[p]) &&\r\n          config.dimensions[p].yscale(d[p]) <= extents[dimension][1]\r\n        );\r\n      } else {\r\n        return extents[dimension][0] <= d[p] && d[p] <= extents[dimension][1];\r\n      }\r\n    },\r\n    number: (d, p, dimension) => {\r\n      if (typeof config.dimensions[p].yscale.bandwidth === 'function') {\r\n        // if it is ordinal\r\n        return (\r\n          extents[dimension][0] <= config.dimensions[p].yscale(d[p]) &&\r\n          config.dimensions[p].yscale(d[p]) <= extents[dimension][1]\r\n        );\r\n      } else {\r\n        return extents[dimension][0] <= d[p] && d[p] <= extents[dimension][1];\r\n      }\r\n    },\r\n    string: (d, p, dimension) => {\r\n      return (\r\n        extents[dimension][0] <= config.dimensions[p].yscale(d[p]) &&\r\n        config.dimensions[p].yscale(d[p]) <= extents[dimension][1]\r\n      );\r\n    },\r\n  };\r\n\r\n  return config.data.filter(d => {\r\n    switch (brushGroup.predicate) {\r\n      case 'AND':\r\n        return actives.every(function(p, dimension) {\r\n          return within[config.dimensions[p].type](d, p, dimension);\r\n        });\r\n      case 'OR':\r\n        return actives.some(function(p, dimension) {\r\n          return within[config.dimensions[p].type](d, p, dimension);\r\n        });\r\n      default:\r\n        throw new Error('Unknown brush predicate ' + config.brushPredicate);\r\n    }\r\n  });\r\n};\r\n\r\nexport default selected;\r\n","import { brushY, brushSelection } from 'd3-brush';\r\nimport { event } from 'd3-selection';\r\nimport invertByScale from '../invertByScale';\r\nimport selected from './selected';\r\n\r\nconst brushUpdated = (config, pc, events, args) => newSelection => {\r\n  config.brushed = newSelection;\r\n  events.call('brush', pc, config.brushed, args);\r\n  pc.renderBrushed();\r\n};\r\n\r\nconst brushFor = (state, config, pc, events, brushGroup) => (\r\n  axis,\r\n  _selector\r\n) => {\r\n  // handle hidden axes which will not be a property of dimensions\r\n  if (!config.dimensions.hasOwnProperty(axis)) {\r\n    return () => {};\r\n  }\r\n\r\n  const brushRangeMax =\r\n    config.dimensions[axis].type === 'string'\r\n      ? config.dimensions[axis].yscale.range()[\r\n          config.dimensions[axis].yscale.range().length - 1\r\n        ]\r\n      : config.dimensions[axis].yscale.range()[0];\r\n\r\n  const _brush = brushY(_selector).extent([[-15, 0], [15, brushRangeMax]]);\r\n\r\n  const convertBrushArguments = args => {\r\n    const args_array = Array.prototype.slice.call(args);\r\n    const axis = args_array[0];\r\n\r\n    const raw = brushSelection(args_array[2][0]) || [];\r\n\r\n    // handle hidden axes which will not have a yscale\r\n    let yscale = null;\r\n    if (config.dimensions.hasOwnProperty(axis)) {\r\n      yscale = config.dimensions[axis].yscale;\r\n    }\r\n\r\n    // ordinal scales do not have invert\r\n    const scaled = invertByScale(raw, yscale);\r\n\r\n    return {\r\n      axis: args_array[0],\r\n      node: args_array[2][0],\r\n      selection: {\r\n        raw,\r\n        scaled,\r\n      },\r\n    };\r\n  };\r\n\r\n  _brush\r\n    .on('start', function() {\r\n      if (event.sourceEvent !== null) {\r\n        events.call(\r\n          'brushstart',\r\n          pc,\r\n          config.brushed,\r\n          convertBrushArguments(arguments)\r\n        );\r\n        if (typeof event.sourceEvent.stopPropagation === 'function') {\r\n          event.sourceEvent.stopPropagation();\r\n        }\r\n      }\r\n    })\r\n    .on('brush', function() {\r\n      brushUpdated(\r\n        config,\r\n        pc,\r\n        events,\r\n        convertBrushArguments(arguments)\r\n      )(selected(state, config, brushGroup)());\r\n    })\r\n    .on('end', function() {\r\n      brushUpdated(config, pc, events)(selected(state, config, brushGroup)());\r\n      events.call(\r\n        'brushend',\r\n        pc,\r\n        config.brushed,\r\n        convertBrushArguments(arguments)\r\n      );\r\n    });\r\n\r\n  state.brushes[axis] = _brush;\r\n  state.brushNodes[axis] = _selector.node();\r\n\r\n  return _brush;\r\n};\r\n\r\nexport default brushFor;\r\n","import { select } from 'd3-selection';\r\nimport brushExtents from './brushExtents';\r\nimport brushReset from './brushReset';\r\nimport brushFor from './brushFor';\r\n\r\nconst install = (state, config, pc, events, brushGroup) => () => {\r\n  if (!pc.g()) {\r\n    pc.createAxes();\r\n  }\r\n\r\n  // Add and store a brush for each axis.\r\n  const brush = pc\r\n    .g()\r\n    .append('svg:g')\r\n    .attr('class', 'brush')\r\n    .each(function(d) {\r\n      select(this).call(\r\n        brushFor(state, config, pc, events, brushGroup)(d, select(this))\r\n      );\r\n    });\r\n  brush\r\n    .selectAll('rect')\r\n    .style('visibility', null)\r\n    .attr('x', -15)\r\n    .attr('width', 30);\r\n\r\n  brush.selectAll('rect.background').style('fill', 'transparent');\r\n\r\n  brush\r\n    .selectAll('rect.extent')\r\n    .style('fill', 'rgba(255,255,255,0.25)')\r\n    .style('stroke', 'rgba(0,0,0,0.6)');\r\n\r\n  brush.selectAll('.resize rect').style('fill', 'rgba(0,0,0,0.1)');\r\n\r\n  pc.brushExtents = brushExtents(state, config, pc);\r\n  pc.brushReset = brushReset(state, config, pc);\r\n  return pc;\r\n};\r\n\r\nexport default install;\r\n","const uninstall = (state, pc) => () => {\r\n  if (pc.g() !== undefined && pc.g() !== null)\r\n    pc.g()\r\n      .selectAll('.brush')\r\n      .remove();\r\n\r\n  state.brushes = {};\r\n  delete pc.brushExtents;\r\n  delete pc.brushReset;\r\n};\r\n\r\nexport default uninstall;\r\n","import brushExtents from './brushExtents';\r\nimport install from './install';\r\nimport selected from './selected';\r\nimport uninstall from './uninstall';\r\n\r\nconst install1DAxes = (brushGroup, config, pc, events) => {\r\n  const state = {\r\n    brushes: {},\r\n    brushNodes: {},\r\n  };\r\n\r\n  brushGroup.modes['1D-axes'] = {\r\n    install: install(state, config, pc, events, brushGroup),\r\n    uninstall: uninstall(state, pc),\r\n    selected: selected(state, config, brushGroup),\r\n    brushState: brushExtents(state, config, pc),\r\n  };\r\n};\r\n\r\nexport default install1DAxes;\r\n","import { select } from 'd3-selection';\r\n\r\nconst drawBrushes = (brushes, config, pc, axis, selector) => {\r\n  const brushSelection = selector.selectAll('.brush').data(brushes, d => d.id);\r\n\r\n  brushSelection\r\n    .enter()\r\n    .insert('g', '.brush')\r\n    .attr('class', 'brush')\r\n    .attr('dimension', axis)\r\n    .attr(\r\n      'id',\r\n      b => 'brush-' + Object.keys(config.dimensions).indexOf(axis) + '-' + b.id\r\n    )\r\n    .each(function(brushObject) {\r\n      brushObject.brush(select(this));\r\n    });\r\n\r\n  brushSelection.each(function(brushObject) {\r\n    select(this)\r\n      .attr('class', 'brush')\r\n      .selectAll('.overlay')\r\n      .style('pointer-events', function() {\r\n        const brush = brushObject.brush;\r\n        if (brushObject.id === brushes.length - 1 && brush !== undefined) {\r\n          return 'all';\r\n        } else {\r\n          return 'none';\r\n        }\r\n      });\r\n  });\r\n\r\n  brushSelection.exit().remove();\r\n};\r\n\r\nexport default drawBrushes;\r\n","import { brushSelection } from 'd3-brush';\r\n\r\n// data within extents\r\nconst selected = (state, config, pc, events, brushGroup) => {\r\n  const { brushes } = state;\r\n\r\n  const is_brushed = (p, pos) => {\r\n    const axisBrushes = brushes[p];\r\n\r\n    for (let i = 0; i < axisBrushes.length; i++) {\r\n      const brush = document.getElementById('brush-' + pos + '-' + i);\r\n\r\n      if (brush && brushSelection(brush) !== null) {\r\n        return true;\r\n      }\r\n    }\r\n\r\n    return false;\r\n  };\r\n\r\n  const actives = Object.keys(config.dimensions).filter(is_brushed);\r\n  const extents = actives.map(p => {\r\n    const axisBrushes = brushes[p];\r\n\r\n    return axisBrushes\r\n      .filter(d => !pc.hideAxis().includes(d))\r\n      .map((d, i) =>\r\n        brushSelection(\r\n          document.getElementById(\r\n            'brush-' + Object.keys(config.dimensions).indexOf(p) + '-' + i\r\n          )\r\n        )\r\n      )\r\n      .map((d, i) => {\r\n        if (d === null || d === undefined) {\r\n          return null;\r\n        } else if (typeof config.dimensions[p].yscale.invert === 'function') {\r\n          return [\r\n            config.dimensions[p].yscale.invert(d[1]),\r\n            config.dimensions[p].yscale.invert(d[0]),\r\n          ];\r\n        } else {\r\n          return d;\r\n        }\r\n      });\r\n  });\r\n\r\n  // We don't want to return the full data set when there are no axes brushed.\r\n  // Actually, when there are no axes brushed, by definition, no items are\r\n  // selected. So, let's avoid the filtering and just return false.\r\n  //if (actives.length === 0) return false;\r\n\r\n  // Resolves broken examples for now. They expect to get the full dataset back from empty brushes\r\n  if (actives.length === 0) return config.data;\r\n\r\n  // test if within range\r\n  const within = {\r\n    date: (d, p, i) => {\r\n      const dimExt = extents[i];\r\n\r\n      if (typeof config.dimensions[p].yscale.bandwidth === 'function') {\r\n        // if it is ordinal\r\n        for (const e of dimExt) {\r\n          if (e === null || e === undefined) {\r\n            continue;\r\n          }\r\n\r\n          if (\r\n            e[0] <= config.dimensions[p].yscale(d[p]) &&\r\n            config.dimensions[p].yscale(d[p]) <= e[1]\r\n          ) {\r\n            return true;\r\n          }\r\n        }\r\n\r\n        return false;\r\n      } else {\r\n        for (const e of dimExt) {\r\n          if (e === null || e === undefined) {\r\n            continue;\r\n          }\r\n\r\n          if (e[0] <= d[p] && d[p] <= e[1]) {\r\n            return true;\r\n          }\r\n        }\r\n\r\n        return false;\r\n      }\r\n    },\r\n    number: (d, p, i) => {\r\n      const dimExt = extents[i];\r\n\r\n      if (typeof config.dimensions[p].yscale.bandwidth === 'function') {\r\n        // if it is ordinal\r\n        for (const e of dimExt) {\r\n          if (e === null || e === undefined) {\r\n            continue;\r\n          }\r\n\r\n          if (\r\n            e[0] <= config.dimensions[p].yscale(d[p]) &&\r\n            config.dimensions[p].yscale(d[p]) <= e[1]\r\n          ) {\r\n            return true;\r\n          }\r\n        }\r\n\r\n        return false;\r\n      } else {\r\n        for (const e of dimExt) {\r\n          if (e === null || e === undefined) {\r\n            continue;\r\n          }\r\n\r\n          if (e[0] <= d[p] && d[p] <= e[1]) {\r\n            return true;\r\n          }\r\n        }\r\n\r\n        return false;\r\n      }\r\n    },\r\n    string: (d, p, i) => {\r\n      const dimExt = extents[i];\r\n\r\n      for (const e of dimExt) {\r\n        if (e === null || e === undefined) {\r\n          continue;\r\n        }\r\n\r\n        if (\r\n          e[0] <= config.dimensions[p].yscale(d[p]) &&\r\n          config.dimensions[p].yscale(d[p]) <= e[1]\r\n        ) {\r\n          return true;\r\n        }\r\n      }\r\n\r\n      return false;\r\n    },\r\n  };\r\n\r\n  return config.data.filter(d => {\r\n    switch (brushGroup.predicate) {\r\n      case 'AND':\r\n        return actives.every((p, i) =>\r\n          within[config.dimensions[p].type](d, p, i)\r\n        );\r\n      case 'OR':\r\n        return actives.some((p, i) =>\r\n          within[config.dimensions[p].type](d, p, i)\r\n        );\r\n      default:\r\n        throw new Error('Unknown brush predicate ' + config.brushPredicate);\r\n    }\r\n  });\r\n};\r\n\r\nexport default selected;\r\n","import { brushY, brushSelection } from 'd3-brush';\r\nimport { event, select } from 'd3-selection';\r\nimport drawBrushes from './drawBrushes';\r\nimport selected from './selected';\r\n\r\nconst brushUpdated = (config, pc, events) => newSelection => {\r\n  config.brushed = newSelection;\r\n  events.call('brush', pc, config.brushed);\r\n  pc.renderBrushed();\r\n};\r\n\r\nconst newBrush = (state, config, pc, events, brushGroup) => (\r\n  axis,\r\n  _selector\r\n) => {\r\n  const { brushes, brushNodes } = state;\r\n\r\n  const brushRangeMax =\r\n    config.dimensions[axis].type === 'string'\r\n      ? config.dimensions[axis].yscale.range()[\r\n          config.dimensions[axis].yscale.range().length - 1\r\n        ]\r\n      : config.dimensions[axis].yscale.range()[0];\r\n\r\n  const brush = brushY().extent([[-15, 0], [15, brushRangeMax]]);\r\n  const id = brushes[axis] ? brushes[axis].length : 0;\r\n  const node =\r\n    'brush-' + Object.keys(config.dimensions).indexOf(axis) + '-' + id;\r\n\r\n  if (brushes[axis]) {\r\n    brushes[axis].push({\r\n      id,\r\n      brush,\r\n      node,\r\n    });\r\n  } else {\r\n    brushes[axis] = [{ id, brush, node }];\r\n  }\r\n\r\n  if (brushNodes[axis]) {\r\n    brushNodes[axis].push({ id, node });\r\n  } else {\r\n    brushNodes[axis] = [{ id, node }];\r\n  }\r\n\r\n  brush\r\n    .on('start', function() {\r\n      if (event.sourceEvent !== null) {\r\n        events.call('brushstart', pc, config.brushed);\r\n        if (typeof event.sourceEvent.stopPropagation === 'function') {\r\n          event.sourceEvent.stopPropagation();\r\n        }\r\n      }\r\n    })\r\n    .on('brush', function(e) {\r\n      // record selections\r\n      brushUpdated(\r\n        config,\r\n        pc,\r\n        events\r\n      )(selected(state, config, pc, events, brushGroup));\r\n    })\r\n    .on('end', function() {\r\n      // Figure out if our latest brush has a selection\r\n      const lastBrushID = brushes[axis][brushes[axis].length - 1].id;\r\n      const lastBrush = document.getElementById(\r\n        'brush-' +\r\n          Object.keys(config.dimensions).indexOf(axis) +\r\n          '-' +\r\n          lastBrushID\r\n      );\r\n      const selection = brushSelection(lastBrush);\r\n\r\n      if (\r\n        selection !== undefined &&\r\n        selection !== null &&\r\n        selection[0] !== selection[1]\r\n      ) {\r\n        newBrush(state, config, pc, events, brushGroup)(axis, _selector);\r\n\r\n        drawBrushes(brushes[axis], config, pc, axis, _selector);\r\n\r\n        brushUpdated(config, pc, events)(\r\n          selected(state, config, pc, events, brushGroup)\r\n        );\r\n      } else {\r\n        if (\r\n          event.sourceEvent &&\r\n          event.sourceEvent.toString() === '[object MouseEvent]' &&\r\n          event.selection === null\r\n        ) {\r\n          pc.brushReset(axis);\r\n        }\r\n      }\r\n\r\n      events.call('brushend', pc, config.brushed);\r\n    });\r\n\r\n  return brush;\r\n};\r\n\r\nexport default newBrush;\r\n","import { select } from 'd3-selection';\r\nimport { brushSelection } from 'd3-brush';\r\nimport newBrush from './newBrush';\r\nimport drawBrushes from './drawBrushes';\r\nimport invertByScale from '../invertByScale';\r\n\r\n/**\r\n *\r\n * extents are in format of [[2,6], [3,5]]\r\n *\r\n * * @param state\r\n * @param config\r\n * @param pc\r\n * @returns {Function}\r\n */\r\nconst brushExtents = (state, config, pc, events, brushGroup) => extents => {\r\n  const { brushes } = state;\r\n  const hiddenAxes = pc.hideAxis();\r\n\r\n  if (typeof extents === 'undefined') {\r\n    return Object.keys(config.dimensions)\r\n      .filter(d => !hiddenAxes.includes(d))\r\n      .reduce((acc, cur, pos) => {\r\n        const axisBrushes = brushes[cur];\r\n\r\n        if (axisBrushes === undefined || axisBrushes === null) {\r\n          acc[cur] = [];\r\n        } else {\r\n          acc[cur] = axisBrushes.reduce((d, p, i) => {\r\n            const raw = brushSelection(\r\n              document.getElementById('brush-' + pos + '-' + i)\r\n            );\r\n\r\n            if (raw) {\r\n              const yScale = config.dimensions[cur].yscale;\r\n              const scaled = invertByScale(raw, yScale);\r\n\r\n              d.push({\r\n                extent: p.brush.extent(),\r\n                selection: {\r\n                  raw,\r\n                  scaled,\r\n                },\r\n              });\r\n            }\r\n            return d;\r\n          }, []);\r\n        }\r\n\r\n        return acc;\r\n      }, {});\r\n  } else {\r\n    // //first get all the brush selections\r\n    // loop over each dimension and update appropriately (if it was passed in through extents)\r\n    Object.keys(config.dimensions).forEach((d, pos) => {\r\n      if (extents[d] === undefined || extents[d] === null) {\r\n        return;\r\n      }\r\n\r\n      const dim = config.dimensions[d];\r\n\r\n      const yExtents = extents[d].map(e => e.map(dim.yscale));\r\n\r\n      const _bs = yExtents.map((e, j) => {\r\n        const _brush = newBrush(state, config, pc, events, brushGroup)(\r\n          d,\r\n          select('#brush-group-' + pos)\r\n        );\r\n        //update the extent\r\n        //sets the brushable extent to the specified array of points [[x0, y0], [x1, y1]]\r\n        _brush.extent([[-15, e[1]], [15, e[0]]]);\r\n\r\n        return {\r\n          id: j,\r\n          brush: _brush,\r\n          ext: e,\r\n        };\r\n      });\r\n\r\n      brushes[d] = _bs;\r\n\r\n      drawBrushes(_bs, config, pc, d, select('#brush-group-' + pos));\r\n\r\n      //redraw the brush\r\n      //https://github.com/d3/d3-brush#brush_move\r\n      // For an x-brush, it must be defined as [x0, x1]; for a y-brush, it must be defined as [y0, y1].\r\n      _bs.forEach((f, k) => {\r\n        select('#brush-' + pos + '-' + k)\r\n          .call(f.brush)\r\n          .call(f.brush.move, f.ext.reverse());\r\n      });\r\n    });\r\n\r\n    //redraw the chart\r\n    pc.renderBrushed();\r\n\r\n    return pc;\r\n  }\r\n};\r\n\r\nexport default brushExtents;\r\n","import { select } from 'd3-selection';\r\nimport { brushSelection } from 'd3-brush';\r\n\r\nconst brushReset = (state, config, pc) => dimension => {\r\n  const { brushes } = state;\r\n\r\n  if (dimension === undefined) {\r\n    if (pc.g() !== undefined && pc.g() !== null) {\r\n      Object.keys(config.dimensions).forEach((d, pos) => {\r\n        const axisBrush = brushes[d];\r\n\r\n        // hidden axes will be undefined\r\n        if (axisBrush) {\r\n          axisBrush.forEach((e, i) => {\r\n            const brush = document.getElementById('brush-' + pos + '-' + i);\r\n            if (brush && brushSelection(brush) !== null) {\r\n              pc.g()\r\n                .select('#brush-' + pos + '-' + i)\r\n                .call(e.brush.move, null);\r\n            }\r\n          });\r\n        }\r\n      });\r\n\r\n      pc.renderBrushed();\r\n    }\r\n  } else {\r\n    if (pc.g() !== undefined && pc.g() !== null) {\r\n      const axisBrush = brushes[dimension];\r\n      const pos = Object.keys(config.dimensions).indexOf(dimension);\r\n\r\n      if (axisBrush) {\r\n        axisBrush.forEach((e, i) => {\r\n          const brush = document.getElementById('brush-' + pos + '-' + i);\r\n          if (brushSelection(brush) !== null) {\r\n            pc.g()\r\n              .select('#brush-' + pos + '-' + i)\r\n              .call(e.brush.move, null);\r\n\r\n            if (typeof e.event === 'function') {\r\n              e.event(select('#brush-' + pos + '-' + i));\r\n            }\r\n          }\r\n        });\r\n      }\r\n\r\n      pc.renderBrushed();\r\n    }\r\n  }\r\n  return this;\r\n};\r\n\r\nexport default brushReset;\r\n","import newBrush from './newBrush';\r\nimport drawBrushes from './drawBrushes';\r\n\r\nconst brushFor = (state, config, pc, events, brushGroup) => (\r\n  axis,\r\n  _selector\r\n) => {\r\n  const { brushes } = state;\r\n  newBrush(state, config, pc, events, brushGroup)(axis, _selector);\r\n  drawBrushes(brushes[axis], config, pc, axis, _selector);\r\n};\r\n\r\nexport default brushFor;\r\n","import { select } from 'd3-selection';\r\nimport brushExtents from './brushExtents';\r\nimport brushReset from './brushReset';\r\nimport brushFor from './brushFor';\r\n\r\nconst install = (state, config, pc, events, brushGroup) => () => {\r\n  if (!pc.g()) {\r\n    pc.createAxes();\r\n  }\r\n\r\n  const hiddenAxes = pc.hideAxis();\r\n\r\n  pc.g()\r\n    .append('svg:g')\r\n    .attr('id', (d, i) => 'brush-group-' + i)\r\n    .attr('class', 'brush-group')\r\n    .attr('dimension', d => d)\r\n    .each(function(d) {\r\n      if (!hiddenAxes.includes(d)) {\r\n        brushFor(state, config, pc, events, brushGroup)(d, select(this));\r\n      }\r\n    });\r\n\r\n  pc.brushExtents = brushExtents(state, config, pc, events, brushGroup);\r\n  pc.brushReset = brushReset(state, config, pc);\r\n  return pc;\r\n};\r\n\r\nexport default install;\r\n","const uninstall = (state, pc) => () => {\r\n  if (pc.g() !== undefined && pc.g() !== null)\r\n    pc.g()\r\n      .selectAll('.brush-group')\r\n      .remove();\r\n\r\n  state.brushes = {};\r\n  delete pc.brushExtents;\r\n  delete pc.brushReset;\r\n};\r\n\r\nexport default uninstall;\r\n","import brushExtents from './brushExtents';\r\nimport install from './install';\r\nimport selected from './selected';\r\nimport uninstall from './uninstall';\r\n\r\nconst install1DMultiAxes = (brushGroup, config, pc, events) => {\r\n  const state = {\r\n    brushes: {},\r\n    brushNodes: {},\r\n  };\r\n\r\n  brushGroup.modes['1D-axes-multi'] = {\r\n    install: install(state, config, pc, events, brushGroup),\r\n    uninstall: uninstall(state, pc),\r\n    selected: selected(state, config, brushGroup),\r\n    brushState: brushExtents(state, config, pc),\r\n  };\r\n};\r\n\r\nexport default install1DMultiAxes;\r\n","const uninstall = (state, pc) => () => {\r\n  pc.selection\r\n    .select('svg')\r\n    .select('g#strums')\r\n    .remove();\r\n  pc.selection\r\n    .select('svg')\r\n    .select('rect#strum-events')\r\n    .remove();\r\n  pc.on('axesreorder.strums', undefined);\r\n  delete pc.brushReset;\r\n\r\n  state.strumRect = undefined;\r\n};\r\n\r\nexport default uninstall;\r\n","// test if point falls between lines\r\nconst containmentTest = (strum, width) => p => {\r\n  const p1 = [strum.p1[0] - strum.minX, strum.p1[1] - strum.minX],\r\n    p2 = [strum.p2[0] - strum.minX, strum.p2[1] - strum.minX],\r\n    m1 = 1 - width / p1[0],\r\n    b1 = p1[1] * (1 - m1),\r\n    m2 = 1 - width / p2[0],\r\n    b2 = p2[1] * (1 - m2);\r\n\r\n  const x = p[0],\r\n    y = p[1],\r\n    y1 = m1 * x + b1,\r\n    y2 = m2 * x + b2;\r\n\r\n  return y > Math.min(y1, y2) && y < Math.max(y1, y2);\r\n};\r\n\r\nconst crossesStrum = (state, config) => (d, id) => {\r\n  let strum = state.strums[id],\r\n    test = containmentTest(strum, state.strums.width(id)),\r\n    d1 = strum.dims.left,\r\n    d2 = strum.dims.right,\r\n    y1 = config.dimensions[d1].yscale,\r\n    y2 = config.dimensions[d2].yscale,\r\n    point = [y1(d[d1]) - strum.minX, y2(d[d2]) - strum.minX];\r\n  return test(point);\r\n};\r\n\r\nconst selected = (brushGroup, state, config) => {\r\n  // Get the ids of the currently active strums.\r\n  const ids = Object.getOwnPropertyNames(state.strums).filter(d => !isNaN(d)),\r\n    brushed = config.data;\r\n\r\n  if (ids.length === 0) {\r\n    return brushed;\r\n  }\r\n\r\n  const crossTest = crossesStrum(state, config);\r\n\r\n  return brushed.filter(d => {\r\n    switch (brushGroup.predicate) {\r\n      case 'AND':\r\n        return ids.every(id => crossTest(d, id));\r\n      case 'OR':\r\n        return ids.some(id => crossTest(d, id));\r\n      default:\r\n        throw new Error('Unknown brush predicate ' + config.brushPredicate);\r\n    }\r\n  });\r\n};\r\n\r\nexport default selected;\r\n","const removeStrum = (state, pc) => {\r\n  const strum = state.strums[state.strums.active],\r\n    svg = pc.selection.select('svg').select('g#strums');\r\n\r\n  delete state.strums[state.strums.active];\r\n  svg.selectAll('line#strum-' + strum.dims.i).remove();\r\n  svg.selectAll('circle#strum-' + strum.dims.i).remove();\r\n};\r\n\r\nexport default removeStrum;\r\n","import selected from './selected';\r\nimport removeStrum from './removeStrum';\r\n\r\nconst onDragEnd = (brushGroup, state, config, pc, events) => () => {\r\n  const strum = state.strums[state.strums.active];\r\n\r\n  // Okay, somewhat unexpected, but not totally unsurprising, a mousclick is\r\n  // considered a drag without move. So we have to deal with that case\r\n  if (strum && strum.p1[0] === strum.p2[0] && strum.p1[1] === strum.p2[1]) {\r\n    removeStrum(state, pc);\r\n  }\r\n\r\n  const brushed = selected(brushGroup, state, config);\r\n  state.strums.active = undefined;\r\n  config.brushed = brushed;\r\n  pc.renderBrushed();\r\n  events.call('brushend', pc, config.brushed);\r\n};\r\n\r\nexport default onDragEnd;\r\n","import { event, select } from 'd3-selection';\r\nimport { drag } from 'd3-drag';\r\nimport onDragEnd from './onDragEnd';\r\n\r\nconst drawStrum = (\r\n  brushGroup,\r\n  state,\r\n  config,\r\n  pc,\r\n  events,\r\n  strum,\r\n  activePoint\r\n) => {\r\n  let _svg = pc.selection.select('svg').select('g#strums'),\r\n    id = strum.dims.i,\r\n    points = [strum.p1, strum.p2],\r\n    _line = _svg.selectAll('line#strum-' + id).data([strum]),\r\n    circles = _svg.selectAll('circle#strum-' + id).data(points),\r\n    _drag = drag();\r\n\r\n  _line\r\n    .enter()\r\n    .append('line')\r\n    .attr('id', 'strum-' + id)\r\n    .attr('class', 'strum');\r\n\r\n  _line\r\n    .attr('x1', d => d.p1[0])\r\n    .attr('y1', d => d.p1[1])\r\n    .attr('x2', d => d.p2[0])\r\n    .attr('y2', d => d.p2[1])\r\n    .attr('stroke', 'black')\r\n    .attr('stroke-width', 2);\r\n\r\n  _drag\r\n    .on('drag', function(d, i) {\r\n      const ev = event;\r\n      i = i + 1;\r\n      strum['p' + i][0] = Math.min(Math.max(strum.minX + 1, ev.x), strum.maxX);\r\n      strum['p' + i][1] = Math.min(Math.max(strum.minY, ev.y), strum.maxY);\r\n      drawStrum(brushGroup, state, config, pc, events, strum, i - 1);\r\n    })\r\n    .on('end', onDragEnd(brushGroup, state, config, pc, events));\r\n\r\n  circles\r\n    .enter()\r\n    .append('circle')\r\n    .attr('id', 'strum-' + id)\r\n    .attr('class', 'strum');\r\n\r\n  circles\r\n    .attr('cx', d => d[0])\r\n    .attr('cy', d => d[1])\r\n    .attr('r', 5)\r\n    .style(\r\n      'opacity',\r\n      (d, i) => (activePoint !== undefined && i === activePoint ? 0.8 : 0)\r\n    )\r\n    .on('mouseover', function() {\r\n      select(this).style('opacity', 0.8);\r\n    })\r\n    .on('mouseout', function() {\r\n      select(this).style('opacity', 0);\r\n    })\r\n    .call(_drag);\r\n};\r\n\r\nconst onDrag = (brushGroup, state, config, pc, events) => () => {\r\n  const ev = event,\r\n    strum = state.strums[state.strums.active];\r\n\r\n  // Make sure that the point is within the bounds\r\n  strum.p2[0] = Math.min(\r\n    Math.max(strum.minX + 1, ev.x - config.margin.left),\r\n    strum.maxX\r\n  );\r\n  strum.p2[1] = Math.min(\r\n    Math.max(strum.minY, ev.y - config.margin.top),\r\n    strum.maxY\r\n  );\r\n\r\n  drawStrum(brushGroup, state, config, pc, events, strum, 1);\r\n};\r\n\r\nexport default onDrag;\r\n","const h = config => config.height - config.margin.top - config.margin.bottom;\r\n\r\nexport default h;\r\n","const dimensionsForPoint = (config, pc, xscale, p) => {\r\n  const dims = { i: -1, left: undefined, right: undefined };\r\n  Object.keys(config.dimensions).some((dim, i) => {\r\n    if (xscale(dim) < p[0]) {\r\n      dims.i = i;\r\n      dims.left = dim;\r\n      dims.right = Object.keys(config.dimensions)[\r\n        pc.getOrderedDimensionKeys().indexOf(dim) + 1\r\n      ];\r\n      return false;\r\n    }\r\n    return true;\r\n  });\r\n\r\n  if (dims.left === undefined) {\r\n    // Event on the left side of the first axis.\r\n    dims.i = 0;\r\n    dims.left = pc.getOrderedDimensionKeys()[0];\r\n    dims.right = pc.getOrderedDimensionKeys()[1];\r\n  } else if (dims.right === undefined) {\r\n    // Event on the right side of the last axis\r\n    dims.i = Object.keys(config.dimensions).length - 1;\r\n    dims.right = dims.left;\r\n    dims.left = pc.getOrderedDimensionKeys()[\r\n      Object.keys(config.dimensions).length - 2\r\n    ];\r\n  }\r\n\r\n  return dims;\r\n};\r\n\r\nexport default dimensionsForPoint;\r\n","import { mouse } from 'd3-selection';\r\nimport h from '../../util/height';\r\nimport dimensionsForPoint from '../dimensionsForPoint';\r\n\r\n// First we need to determine between which two axes the sturm was started.\r\n// This will determine the freedom of movement, because a strum can\r\n// logically only happen between two axes, so no movement outside these axes\r\n// should be allowed.\r\nconst onDragStart = (state, config, pc, xscale) => () => {\r\n  let p = mouse(state.strumRect.node());\r\n\r\n  p[0] = p[0] - config.margin.left;\r\n  p[1] = p[1] - config.margin.top;\r\n\r\n  const dims = dimensionsForPoint(config, pc, xscale, p);\r\n  const strum = {\r\n    p1: p,\r\n    dims: dims,\r\n    minX: xscale(dims.left),\r\n    maxX: xscale(dims.right),\r\n    minY: 0,\r\n    maxY: h(config),\r\n  };\r\n\r\n  // Make sure that the point is within the bounds\r\n  strum.p1[0] = Math.min(Math.max(strum.minX, p[0]), strum.maxX);\r\n  strum.p2 = strum.p1.slice();\r\n\r\n  state.strums[dims.i] = strum;\r\n  state.strums.active = dims.i;\r\n};\r\n\r\nexport default onDragStart;\r\n","import onDragEnd from './onDragEnd';\r\nimport removeStrum from './removeStrum';\r\n\r\nconst brushReset = (brushGroup, state, config, pc, events) => () => {\r\n  const ids = Object.getOwnPropertyNames(state.strums).filter(d => !isNaN(d));\r\n\r\n  ids.forEach(d => {\r\n    state.strums.active = d;\r\n    removeStrum(state, pc);\r\n  });\r\n  onDragEnd(brushGroup, state, config, pc, events)();\r\n};\r\n\r\nexport default brushReset;\r\n","// Checks if the first dimension is directly left of the second dimension.\r\nconst consecutive = dimensions => (first, second) => {\r\n  const keys = Object.keys(dimensions);\r\n\r\n  return keys.some(\r\n    (d, i) =>\r\n      d === first ? i + i < keys.length && dimensions[i + 1] === second : false\r\n  );\r\n};\r\n\r\nexport default consecutive;\r\n","import { drag } from 'd3-drag';\r\nimport onDragEnd from './onDragEnd';\r\nimport onDrag from './onDrag';\r\nimport onDragStart from './onDragStart';\r\nimport removeStrum from './removeStrum';\r\nimport brushReset from './brushReset';\r\nimport w from '../../util/width';\r\nimport h from '../../util/height';\r\nimport consecutive from '../consecutive';\r\n\r\nconst install = (brushGroup, state, config, pc, events, xscale) => () => {\r\n  if (pc.g() === undefined || pc.g() === null) {\r\n    pc.createAxes();\r\n  }\r\n\r\n  const _drag = drag();\r\n\r\n  // Map of current strums. Strums are stored per segment of the PC. A segment,\r\n  // being the area between two axes. The left most area is indexed at 0.\r\n  state.strums.active = undefined;\r\n  // Returns the width of the PC segment where currently a strum is being\r\n  // placed. NOTE: even though they are evenly spaced in our current\r\n  // implementation, we keep for when non-even spaced segments are supported as\r\n  // well.\r\n  state.strums.width = id =>\r\n    state.strums[id] === undefined\r\n      ? undefined\r\n      : state.strums[id].maxX - state.strums[id].minX;\r\n\r\n  pc.on('axesreorder.strums', () => {\r\n    const ids = Object.getOwnPropertyNames(state.strums).filter(d => !isNaN(d));\r\n\r\n    if (ids.length > 0) {\r\n      // We have some strums, which might need to be removed.\r\n      ids.forEach(d => {\r\n        const dims = state.strums[d].dims;\r\n        state.strums.active = d;\r\n        // If the two dimensions of the current strum are not next to each other\r\n        // any more, than we'll need to remove the strum. Otherwise we keep it.\r\n        if (!consecutive(config.dimensions)(dims.left, dims.right)) {\r\n          removeStrum(state, pc);\r\n        }\r\n      });\r\n      onDragEnd(brushGroup, state, config, pc, events)();\r\n    }\r\n  });\r\n\r\n  // Add a new svg group in which we draw the strums.\r\n  pc.selection\r\n    .select('svg')\r\n    .append('g')\r\n    .attr('id', 'strums')\r\n    .attr(\r\n      'transform',\r\n      'translate(' + config.margin.left + ',' + config.margin.top + ')'\r\n    );\r\n\r\n  // Install the required brushReset function\r\n  pc.brushReset = brushReset(brushGroup, state, config, pc, events);\r\n\r\n  _drag\r\n    .on('start', onDragStart(state, config, pc, xscale))\r\n    .on('drag', onDrag(brushGroup, state, config, pc, events))\r\n    .on('end', onDragEnd(brushGroup, state, config, pc, events));\r\n\r\n  // NOTE: The styling needs to be done here and not in the css. This is because\r\n  //       for 1D brushing, the canvas layers should not listen to\r\n  //       pointer-events._.\r\n  state.strumRect = pc.selection\r\n    .select('svg')\r\n    .insert('rect', 'g#strums')\r\n    .attr('id', 'strum-events')\r\n    .attr('x', config.margin.left)\r\n    .attr('y', config.margin.top)\r\n    .attr('width', w(config))\r\n    .attr('height', h(config) + 2)\r\n    .style('opacity', 0)\r\n    .call(_drag);\r\n};\r\n\r\nexport default install;\r\n","import uninstall from './uninstall';\r\nimport install from './install';\r\nimport selected from './selected';\r\n\r\nconst install2DStrums = (brushGroup, config, pc, events, xscale) => {\r\n  const state = {\r\n    strums: {},\r\n    strumRect: {},\r\n  };\r\n\r\n  brushGroup.modes['2D-strums'] = {\r\n    install: install(brushGroup, state, config, pc, events, xscale),\r\n    uninstall: uninstall(state, pc),\r\n    selected: selected(brushGroup, state, config),\r\n    brushState: () => state.strums,\r\n  };\r\n};\r\n\r\nexport default install2DStrums;\r\n","const uninstall = (state, pc) => () => {\r\n  pc.selection\r\n    .select('svg')\r\n    .select('g#arcs')\r\n    .remove();\r\n  pc.selection\r\n    .select('svg')\r\n    .select('rect#arc-events')\r\n    .remove();\r\n  pc.on('axesreorder.arcs', undefined);\r\n\r\n  delete pc.brushReset;\r\n\r\n  state.strumRect = undefined;\r\n};\r\n\r\nexport default uninstall;\r\n","const hypothenuse = (a, b) => Math.sqrt(a * a + b * b);\r\n\r\nexport default hypothenuse;\r\n","import hypothenuse from './util/hypothenuse';\r\n\r\n// [0, 2*PI] -> [-PI/2, PI/2]\r\nconst signedAngle = angle =>\r\n  angle > Math.PI ? 1.5 * Math.PI - angle : 0.5 * Math.PI - angle;\r\n\r\n/**\r\n * angles are stored in radians from in [0, 2*PI], where 0 in 12 o'clock.\r\n * However, one can only select lines from 0 to PI, so we compute the\r\n * 'signed' angle, where 0 is the horizontal line (3 o'clock), and +/- PI/2\r\n * are 12 and 6 o'clock respectively.\r\n */\r\nconst containmentTest = arc => a => {\r\n  let startAngle = signedAngle(arc.startAngle);\r\n  let endAngle = signedAngle(arc.endAngle);\r\n\r\n  if (startAngle > endAngle) {\r\n    const tmp = startAngle;\r\n    startAngle = endAngle;\r\n    endAngle = tmp;\r\n  }\r\n\r\n  // test if segment angle is contained in angle interval\r\n  return a >= startAngle && a <= endAngle;\r\n};\r\n\r\nconst crossesStrum = (state, config) => (d, id) => {\r\n  const arc = state.arcs[id],\r\n    test = containmentTest(arc),\r\n    d1 = arc.dims.left,\r\n    d2 = arc.dims.right,\r\n    y1 = config.dimensions[d1].yscale,\r\n    y2 = config.dimensions[d2].yscale,\r\n    a = state.arcs.width(id),\r\n    b = y1(d[d1]) - y2(d[d2]),\r\n    c = hypothenuse(a, b),\r\n    angle = Math.asin(b / c); // rad in [-PI/2, PI/2]\r\n  return test(angle);\r\n};\r\n\r\nconst selected = (brushGroup, state, config) => {\r\n  const ids = Object.getOwnPropertyNames(state.arcs).filter(d => !isNaN(d));\r\n  const brushed = config.data;\r\n\r\n  if (ids.length === 0) {\r\n    return brushed;\r\n  }\r\n\r\n  const crossTest = crossesStrum(state, config);\r\n\r\n  return brushed.filter(d => {\r\n    switch (brushGroup.predicate) {\r\n      case 'AND':\r\n        return ids.every(id => crossTest(d, id));\r\n      case 'OR':\r\n        return ids.some(id => crossTest(d, id));\r\n      default:\r\n        throw new Error('Unknown brush predicate ' + config.brushPredicate);\r\n    }\r\n  });\r\n};\r\n\r\nexport default selected;\r\n","const removeStrum = (state, pc) => {\r\n  const arc = state.arcs[state.arcs.active],\r\n    svg = pc.selection.select('svg').select('g#arcs');\r\n\r\n  delete state.arcs[state.arcs.active];\r\n  state.arcs.active = undefined;\r\n  svg.selectAll('line#arc-' + arc.dims.i).remove();\r\n  svg.selectAll('circle#arc-' + arc.dims.i).remove();\r\n  svg.selectAll('path#arc-' + arc.dims.i).remove();\r\n};\r\n\r\nexport default removeStrum;\r\n","import selected from './selected';\r\nimport removeStrum from './removeStrum';\r\n\r\nconst onDragEnd = (brushGroup, state, config, pc, events) => () => {\r\n  const arc = state.arcs[state.arcs.active];\r\n\r\n  // Okay, somewhat unexpected, but not totally unsurprising, a mousclick is\r\n  // considered a drag without move. So we have to deal with that case\r\n  if (arc && arc.p1[0] === arc.p2[0] && arc.p1[1] === arc.p2[1]) {\r\n    removeStrum(state, pc);\r\n  }\r\n\r\n  if (arc) {\r\n    const angle = state.arcs.startAngle(state.arcs.active);\r\n\r\n    arc.startAngle = angle;\r\n    arc.endAngle = angle;\r\n    arc.arc\r\n      .outerRadius(state.arcs.length(state.arcs.active))\r\n      .startAngle(angle)\r\n      .endAngle(angle);\r\n  }\r\n\r\n  state.arcs.active = undefined;\r\n  config.brushed = selected(brushGroup, state, config);\r\n  pc.renderBrushed();\r\n  events.call('brushend', pc, config.brushed);\r\n};\r\n\r\nexport default onDragEnd;\r\n","import { event, select } from 'd3-selection';\r\nimport { drag } from 'd3-drag';\r\nimport onDragEnd from './onDragEnd';\r\n\r\nconst drawStrum = (brushGroup, state, config, pc, events, arc, activePoint) => {\r\n  const svg = pc.selection.select('svg').select('g#arcs'),\r\n    id = arc.dims.i,\r\n    points = [arc.p2, arc.p3],\r\n    _line = svg\r\n      .selectAll('line#arc-' + id)\r\n      .data([{ p1: arc.p1, p2: arc.p2 }, { p1: arc.p1, p2: arc.p3 }]),\r\n    circles = svg.selectAll('circle#arc-' + id).data(points),\r\n    _drag = drag(),\r\n    _path = svg.selectAll('path#arc-' + id).data([arc]);\r\n\r\n  _path\r\n    .enter()\r\n    .append('path')\r\n    .attr('id', 'arc-' + id)\r\n    .attr('class', 'arc')\r\n    .style('fill', 'orange')\r\n    .style('opacity', 0.5);\r\n\r\n  _path\r\n    .attr('d', arc.arc)\r\n    .attr('transform', 'translate(' + arc.p1[0] + ',' + arc.p1[1] + ')');\r\n\r\n  _line\r\n    .enter()\r\n    .append('line')\r\n    .attr('id', 'arc-' + id)\r\n    .attr('class', 'arc');\r\n\r\n  _line\r\n    .attr('x1', d => d.p1[0])\r\n    .attr('y1', d => d.p1[1])\r\n    .attr('x2', d => d.p2[0])\r\n    .attr('y2', d => d.p2[1])\r\n    .attr('stroke', 'black')\r\n    .attr('stroke-width', 2);\r\n\r\n  _drag\r\n    .on('drag', (d, i) => {\r\n      const ev = event;\r\n      i = i + 2;\r\n\r\n      arc['p' + i][0] = Math.min(Math.max(arc.minX + 1, ev.x), arc.maxX);\r\n      arc['p' + i][1] = Math.min(Math.max(arc.minY, ev.y), arc.maxY);\r\n\r\n      const angle =\r\n        i === 3 ? state.arcs.startAngle(id) : state.arcs.endAngle(id);\r\n\r\n      if (\r\n        (arc.startAngle < Math.PI &&\r\n          arc.endAngle < Math.PI &&\r\n          angle < Math.PI) ||\r\n        (arc.startAngle >= Math.PI &&\r\n          arc.endAngle >= Math.PI &&\r\n          angle >= Math.PI)\r\n      ) {\r\n        if (i === 2) {\r\n          arc.endAngle = angle;\r\n          arc.arc.endAngle(angle);\r\n        } else if (i === 3) {\r\n          arc.startAngle = angle;\r\n          arc.arc.startAngle(angle);\r\n        }\r\n      }\r\n\r\n      drawStrum(brushGroup, state, config, pc, events, arc, i - 2);\r\n    })\r\n    .on('end', onDragEnd(brushGroup, state, config, pc, events));\r\n\r\n  circles\r\n    .enter()\r\n    .append('circle')\r\n    .attr('id', 'arc-' + id)\r\n    .attr('class', 'arc');\r\n\r\n  circles\r\n    .attr('cx', d => d[0])\r\n    .attr('cy', d => d[1])\r\n    .attr('r', 5)\r\n    .style(\r\n      'opacity',\r\n      (d, i) => (activePoint !== undefined && i === activePoint ? 0.8 : 0)\r\n    )\r\n    .on('mouseover', function() {\r\n      select(this).style('opacity', 0.8);\r\n    })\r\n    .on('mouseout', function() {\r\n      select(this).style('opacity', 0);\r\n    })\r\n    .call(_drag);\r\n};\r\n\r\nconst onDrag = (brushGroup, state, config, pc, events) => () => {\r\n  const ev = event,\r\n    arc = state.arcs[state.arcs.active];\r\n\r\n  // Make sure that the point is within the bounds\r\n  arc.p2[0] = Math.min(\r\n    Math.max(arc.minX + 1, ev.x - config.margin.left),\r\n    arc.maxX\r\n  );\r\n  arc.p2[1] = Math.min(Math.max(arc.minY, ev.y - config.margin.top), arc.maxY);\r\n  arc.p3 = arc.p2.slice();\r\n  drawStrum(brushGroup, state, config, pc, events, arc, 1);\r\n};\r\n\r\nexport default onDrag;\r\n","import { mouse } from 'd3-selection';\r\nimport { arc as d3Arc } from 'd3-shape';\r\nimport dimensionsForPoint from '../dimensionsForPoint';\r\nimport h from '../../util/height';\r\n\r\n// First we need to determine between which two axes the arc was started.\r\n// This will determine the freedom of movement, because a arc can\r\n// logically only happen between two axes, so no movement outside these axes\r\n// should be allowed.\r\nconst onDragStart = (state, config, pc, xscale) => () => {\r\n  const p = mouse(state.strumRect.node());\r\n\r\n  p[0] = p[0] - config.margin.left;\r\n  p[1] = p[1] - config.margin.top;\r\n\r\n  const dims = dimensionsForPoint(config, pc, xscale, p);\r\n  const arc = {\r\n    p1: p,\r\n    dims: dims,\r\n    minX: xscale(dims.left),\r\n    maxX: xscale(dims.right),\r\n    minY: 0,\r\n    maxY: h(config),\r\n    startAngle: undefined,\r\n    endAngle: undefined,\r\n    arc: d3Arc().innerRadius(0),\r\n  };\r\n\r\n  // Make sure that the point is within the bounds\r\n  arc.p1[0] = Math.min(Math.max(arc.minX, p[0]), arc.maxX);\r\n  arc.p2 = arc.p1.slice();\r\n  arc.p3 = arc.p1.slice();\r\n\r\n  state.arcs[dims.i] = arc;\r\n  state.arcs.active = dims.i;\r\n};\r\n\r\nexport default onDragStart;\r\n","import onDragEnd from './onDragEnd';\r\nimport removeStrum from './removeStrum';\r\n\r\nconst brushReset = (brushGroup, state, config, pc, events) => () => {\r\n  const ids = Object.getOwnPropertyNames(state.arcs).filter(d => !isNaN(d));\r\n\r\n  ids.forEach(d => {\r\n    state.arcs.active = d;\r\n    removeStrum(state, pc);\r\n  });\r\n  onDragEnd(brushGroup, state, config, pc, events)();\r\n};\r\n\r\nexport default brushReset;\r\n","import { drag } from 'd3-drag';\r\nimport onDragEnd from './onDragEnd';\r\nimport onDrag from './onDrag';\r\nimport onDragStart from './onDragStart';\r\nimport removeStrum from './removeStrum';\r\nimport brushReset from './brushReset';\r\nimport w from '../../util/width';\r\nimport h from '../../util/height';\r\n\r\nimport hypothenuse from './util/hypothenuse';\r\nimport consecutive from '../consecutive';\r\n\r\n// returns angles in [-PI/2, PI/2]\r\nconst angle = (p1, p2) => {\r\n  const a = p1[0] - p2[0],\r\n    b = p1[1] - p2[1],\r\n    c = hypothenuse(a, b);\r\n\r\n  return Math.asin(b / c);\r\n};\r\n\r\nconst endAngle = state => id => {\r\n  const arc = state.arcs[id];\r\n  if (arc === undefined) {\r\n    return undefined;\r\n  }\r\n  let sAngle = angle(arc.p1, arc.p2),\r\n    uAngle = -sAngle + Math.PI / 2;\r\n\r\n  if (arc.p1[0] > arc.p2[0]) {\r\n    uAngle = 2 * Math.PI - uAngle;\r\n  }\r\n\r\n  return uAngle;\r\n};\r\n\r\nconst startAngle = state => id => {\r\n  const arc = state.arcs[id];\r\n  if (arc === undefined) {\r\n    return undefined;\r\n  }\r\n\r\n  let sAngle = angle(arc.p1, arc.p3),\r\n    uAngle = -sAngle + Math.PI / 2;\r\n\r\n  if (arc.p1[0] > arc.p3[0]) {\r\n    uAngle = 2 * Math.PI - uAngle;\r\n  }\r\n\r\n  return uAngle;\r\n};\r\n\r\nconst length = state => id => {\r\n  const arc = state.arcs[id];\r\n\r\n  if (arc === undefined) {\r\n    return undefined;\r\n  }\r\n\r\n  const a = arc.p1[0] - arc.p2[0],\r\n    b = arc.p1[1] - arc.p2[1];\r\n\r\n  return hypothenuse(a, b);\r\n};\r\n\r\nconst install = (brushGroup, state, config, pc, events, xscale) => () => {\r\n  if (!pc.g()) {\r\n    pc.createAxes();\r\n  }\r\n\r\n  const _drag = drag();\r\n\r\n  // Map of current arcs. arcs are stored per segment of the PC. A segment,\r\n  // being the area between two axes. The left most area is indexed at 0.\r\n  state.arcs.active = undefined;\r\n  // Returns the width of the PC segment where currently a arc is being\r\n  // placed. NOTE: even though they are evenly spaced in our current\r\n  // implementation, we keep for when non-even spaced segments are supported as\r\n  // well.\r\n  state.arcs.width = id => {\r\n    const arc = state.arcs[id];\r\n    return arc === undefined ? undefined : arc.maxX - arc.minX;\r\n  };\r\n\r\n  // returns angles in [0, 2 * PI]\r\n  state.arcs.endAngle = endAngle(state);\r\n  state.arcs.startAngle = startAngle(state);\r\n  state.arcs.length = length(state);\r\n\r\n  pc.on('axesreorder.arcs', () => {\r\n    const ids = Object.getOwnPropertyNames(arcs).filter(d => !isNaN(d));\r\n\r\n    if (ids.length > 0) {\r\n      // We have some arcs, which might need to be removed.\r\n      ids.forEach(d => {\r\n        const dims = arcs[d].dims;\r\n        state.arcs.active = d;\r\n        // If the two dimensions of the current arc are not next to each other\r\n        // any more, than we'll need to remove the arc. Otherwise we keep it.\r\n        if (!consecutive(dims)(dims.left, dims.right)) {\r\n          removeStrum(state, pc);\r\n        }\r\n      });\r\n      onDragEnd(brushGroup, state, config, pc, events)();\r\n    }\r\n  });\r\n\r\n  // Add a new svg group in which we draw the arcs.\r\n  pc.selection\r\n    .select('svg')\r\n    .append('g')\r\n    .attr('id', 'arcs')\r\n    .attr(\r\n      'transform',\r\n      'translate(' + config.margin.left + ',' + config.margin.top + ')'\r\n    );\r\n\r\n  // Install the required brushReset function\r\n  pc.brushReset = brushReset(brushGroup, state, config, pc, events);\r\n\r\n  _drag\r\n    .on('start', onDragStart(state, config, pc, xscale))\r\n    .on('drag', onDrag(brushGroup, state, config, pc, events))\r\n    .on('end', onDragEnd(brushGroup, state, config, pc, events));\r\n\r\n  // NOTE: The styling needs to be done here and not in the css. This is because\r\n  //       for 1D brushing, the canvas layers should not listen to\r\n  //       pointer-events._.\r\n  state.strumRect = pc.selection\r\n    .select('svg')\r\n    .insert('rect', 'g#arcs')\r\n    .attr('id', 'arc-events')\r\n    .attr('x', config.margin.left)\r\n    .attr('y', config.margin.top)\r\n    .attr('width', w(config))\r\n    .attr('height', h(config) + 2)\r\n    .style('opacity', 0)\r\n    .call(_drag);\r\n};\r\n\r\nexport default install;\r\n","import uninstall from './uninstall';\r\nimport install from './install';\r\nimport selected from './selected';\r\n\r\nconst installAngularBrush = (brushGroup, config, pc, events, xscale) => {\r\n  const state = {\r\n    arcs: {},\r\n    strumRect: {},\r\n  };\r\n\r\n  brushGroup.modes['angular'] = {\r\n    install: install(brushGroup, state, config, pc, events, xscale),\r\n    uninstall: uninstall(state, pc),\r\n    selected: selected(brushGroup, state, config),\r\n    brushState: () => state.arcs,\r\n  };\r\n};\r\n\r\nexport default installAngularBrush;\r\n","// calculate 2d intersection of line a->b with line c->d\r\n// points are objects with x and y properties\r\nconst intersection = (a, b, c, d) => {\r\n  return {\r\n    x:\r\n      ((a.x * b.y - a.y * b.x) * (c.x - d.x) -\r\n        (a.x - b.x) * (c.x * d.y - c.y * d.x)) /\r\n      ((a.x - b.x) * (c.y - d.y) - (a.y - b.y) * (c.x - d.x)),\r\n    y:\r\n      ((a.x * b.y - a.y * b.x) * (c.y - d.y) -\r\n        (a.y - b.y) * (c.x * d.y - c.y * d.x)) /\r\n      ((a.x - b.x) * (c.y - d.y) - (a.y - b.y) * (c.x - d.x)),\r\n  };\r\n};\r\n\r\nexport default intersection;\r\n","import { select, selectAll } from 'd3-selection';\r\n\r\n// Merges the canvases and SVG elements into one canvas element which is then passed into the callback\r\n// (so you can choose to save it to disk, etc.)\r\nconst mergeParcoords = pc => callback => {\r\n  // Retina display, etc.\r\n  const devicePixelRatio = window.devicePixelRatio || 1;\r\n\r\n  // Create a canvas element to store the merged canvases\r\n  const mergedCanvas = document.createElement('canvas');\r\n\r\n  const foregroundCanvas = pc.canvas.foreground;\r\n  // We will need to adjust for canvas margins to align the svg and canvas\r\n  const canvasMarginLeft = Number(\r\n    foregroundCanvas.style.marginLeft.replace('px', '')\r\n  );\r\n\r\n  const textTopAdjust = 15;\r\n  const canvasMarginTop =\r\n    Number(foregroundCanvas.style.marginTop.replace('px', '')) + textTopAdjust;\r\n  const width =\r\n    (foregroundCanvas.clientWidth + canvasMarginLeft) * devicePixelRatio;\r\n  const height =\r\n    (foregroundCanvas.clientHeight + canvasMarginTop) * devicePixelRatio;\r\n  mergedCanvas.width = width + 50; // pad so that svg labels at right will not get cut off\r\n  mergedCanvas.height = height + 30; // pad so that svg labels at bottom will not get cut off\r\n  mergedCanvas.style.width = mergedCanvas.width / devicePixelRatio + 'px';\r\n  mergedCanvas.style.height = mergedCanvas.height / devicePixelRatio + 'px';\r\n\r\n  // Give the canvas a white background\r\n  const context = mergedCanvas.getContext('2d');\r\n  context.fillStyle = '#ffffff';\r\n  context.fillRect(0, 0, mergedCanvas.width, mergedCanvas.height);\r\n\r\n  // Merge all the canvases\r\n  for (const key in pc.canvas) {\r\n    context.drawImage(\r\n      pc.canvas[key],\r\n      canvasMarginLeft * devicePixelRatio,\r\n      canvasMarginTop * devicePixelRatio,\r\n      width - canvasMarginLeft * devicePixelRatio,\r\n      height - canvasMarginTop * devicePixelRatio\r\n    );\r\n  }\r\n\r\n  // Add SVG elements to canvas\r\n  const DOMURL = window.URL || window.webkitURL || window;\r\n  const serializer = new XMLSerializer();\r\n  // axis labels are translated (0,-5) so we will clone the svg\r\n  //   and translate down so the labels are drawn on the canvas\r\n  const svgNodeCopy = pc.selection\r\n    .select('svg')\r\n    .node()\r\n    .cloneNode(true);\r\n  svgNodeCopy.setAttribute('transform', 'translate(0,' + textTopAdjust + ')');\r\n  svgNodeCopy.setAttribute(\r\n    'height',\r\n    svgNodeCopy.getAttribute('height') + textTopAdjust\r\n  );\r\n  // text will need fill attribute since css styles will not get picked up\r\n  //   this is not sophisticated since it doesn't look up css styles\r\n  //   if the user changes\r\n  select(svgNodeCopy)\r\n    .selectAll('text')\r\n    .attr('fill', 'black');\r\n  const svgStr = serializer.serializeToString(svgNodeCopy);\r\n\r\n  // Create a Data URI.\r\n  const src = 'data:image/svg+xml;base64,' + window.btoa(svgStr);\r\n  const img = new Image();\r\n  img.onload = () => {\r\n    context.drawImage(\r\n      img,\r\n      0,\r\n      0,\r\n      img.width * devicePixelRatio,\r\n      img.height * devicePixelRatio\r\n    );\r\n    if (typeof callback === 'function') {\r\n      callback(mergedCanvas);\r\n    }\r\n  };\r\n  img.src = src;\r\n};\r\n\r\nexport default mergeParcoords;\r\n","import { brushSelection } from 'd3-brush';\r\n\r\nconst selected = (config, pc) => () => {\r\n  let actives = [];\r\n  let extents = [];\r\n  let ranges = {};\r\n  //get brush selections from each node, convert to actual values\r\n  //invert order of values in array to comply with the parcoords architecture\r\n  if (config.brushes.length === 0) {\r\n    let nodes = pc\r\n      .g()\r\n      .selectAll('.brush')\r\n      .nodes();\r\n    for (let k = 0; k < nodes.length; k++) {\r\n      if (brushSelection(nodes[k]) !== null) {\r\n        actives.push(nodes[k].__data__);\r\n        let values = [];\r\n        let ranger = brushSelection(nodes[k]);\r\n        if (\r\n          typeof config.dimensions[nodes[k].__data__].yscale.domain()[0] ===\r\n          'number'\r\n        ) {\r\n          for (let i = 0; i < ranger.length; i++) {\r\n            if (\r\n              actives.includes(nodes[k].__data__) &&\r\n              config.flipAxes.includes(nodes[k].__data__)\r\n            ) {\r\n              values.push(\r\n                config.dimensions[nodes[k].__data__].yscale.invert(ranger[i])\r\n              );\r\n            } else if (config.dimensions[nodes[k].__data__].yscale() !== 1) {\r\n              values.unshift(\r\n                config.dimensions[nodes[k].__data__].yscale.invert(ranger[i])\r\n              );\r\n            }\r\n          }\r\n          extents.push(values);\r\n          for (let ii = 0; ii < extents.length; ii++) {\r\n            if (extents[ii].length === 0) {\r\n              extents[ii] = [1, 1];\r\n            }\r\n          }\r\n        } else {\r\n          ranges[nodes[k].__data__] = brushSelection(nodes[k]);\r\n          let dimRange = config.dimensions[nodes[k].__data__].yscale.range();\r\n          let dimDomain = config.dimensions[nodes[k].__data__].yscale.domain();\r\n          for (let j = 0; j < dimRange.length; j++) {\r\n            if (\r\n              dimRange[j] >= ranger[0] &&\r\n              dimRange[j] <= ranger[1] &&\r\n              actives.includes(nodes[k].__data__) &&\r\n              config.flipAxes.includes(nodes[k].__data__)\r\n            ) {\r\n              values.push(dimRange[j]);\r\n            } else if (dimRange[j] >= ranger[0] && dimRange[j] <= ranger[1]) {\r\n              values.unshift(dimRange[j]);\r\n            }\r\n          }\r\n          extents.push(values);\r\n          for (let ii = 0; ii < extents.length; ii++) {\r\n            if (extents[ii].length === 0) {\r\n              extents[ii] = [1, 1];\r\n            }\r\n          }\r\n        }\r\n      }\r\n    }\r\n    // test if within range\r\n    const within = {\r\n      date: function(d, p, dimension) {\r\n        let category = d[p];\r\n        let categoryIndex = config.dimensions[p].yscale\r\n          .domain()\r\n          .indexOf(category);\r\n        let categoryRangeValue = config.dimensions[p].yscale.range()[\r\n          categoryIndex\r\n        ];\r\n        return (\r\n          categoryRangeValue >= ranges[p][0] &&\r\n          categoryRangeValue <= ranges[p][1]\r\n        );\r\n      },\r\n      number: function(d, p, dimension) {\r\n        return extents[dimension][0] <= d[p] && d[p] <= extents[dimension][1];\r\n      },\r\n      string: function(d, p, dimension) {\r\n        let category = d[p];\r\n        let categoryIndex = config.dimensions[p].yscale\r\n          .domain()\r\n          .indexOf(category);\r\n        let categoryRangeValue = config.dimensions[p].yscale.range()[\r\n          categoryIndex\r\n        ];\r\n        return (\r\n          categoryRangeValue >= ranges[p][0] &&\r\n          categoryRangeValue <= ranges[p][1]\r\n        );\r\n      },\r\n    };\r\n    return config.data.filter(d =>\r\n      actives.every((p, dimension) =>\r\n        within[config.dimensions[p].type](d, p, dimension)\r\n      )\r\n    );\r\n  } else {\r\n    // need to get data from each brush instead of each axis\r\n    // first must find active axes by iterating through all brushes\r\n    // then go through similiar process as above.\r\n    let multiBrushData = [];\r\n    for (let idx = 0; idx < config.brushes.length; idx++) {\r\n      let brush = config.brushes[idx];\r\n      let values = [];\r\n      let ranger = brush.extent;\r\n      let actives = [brush.data];\r\n      if (\r\n        typeof config.dimensions[brush.data].yscale.domain()[0] === 'number'\r\n      ) {\r\n        for (let i = 0; i < ranger.length; i++) {\r\n          if (\r\n            actives.includes(brush.data) &&\r\n            config.flipAxes.includes(brush.data)\r\n          ) {\r\n            values.push(config.dimensions[brush.data].yscale.invert(ranger[i]));\r\n          } else if (config.dimensions[brush.data].yscale() !== 1) {\r\n            values.unshift(\r\n              config.dimensions[brush.data].yscale.invert(ranger[i])\r\n            );\r\n          }\r\n        }\r\n        extents.push(values);\r\n        for (let ii = 0; ii < extents.length; ii++) {\r\n          if (extents[ii].length === 0) {\r\n            extents[ii] = [1, 1];\r\n          }\r\n        }\r\n      } else {\r\n        ranges[brush.data] = brush.extent;\r\n        let dimRange = config.dimensions[brush.data].yscale.range();\r\n        let dimDomain = config.dimensions[brush.data].yscale.domain();\r\n        for (let j = 0; j < dimRange.length; j++) {\r\n          if (\r\n            dimRange[j] >= ranger[0] &&\r\n            dimRange[j] <= ranger[1] &&\r\n            actives.includes(brush.data) &&\r\n            config.flipAxes.includes(brush.data)\r\n          ) {\r\n            values.push(dimRange[j]);\r\n          } else if (dimRange[j] >= ranger[0] && dimRange[j] <= ranger[1]) {\r\n            values.unshift(dimRange[j]);\r\n          }\r\n        }\r\n        extents.push(values);\r\n        for (let ii = 0; ii < extents.length; ii++) {\r\n          if (extents[ii].length === 0) {\r\n            extents[ii] = [1, 1];\r\n          }\r\n        }\r\n      }\r\n      let within = {\r\n        date: function(d, p, dimension) {\r\n          let category = d[p];\r\n          let categoryIndex = config.dimensions[p].yscale\r\n            .domain()\r\n            .indexOf(category);\r\n          let categoryRangeValue = config.dimensions[p].yscale.range()[\r\n            categoryIndex\r\n          ];\r\n          return (\r\n            categoryRangeValue >= ranges[p][0] &&\r\n            categoryRangeValue <= ranges[p][1]\r\n          );\r\n        },\r\n        number: function(d, p, dimension) {\r\n          return extents[idx][0] <= d[p] && d[p] <= extents[idx][1];\r\n        },\r\n        string: function(d, p, dimension) {\r\n          let category = d[p];\r\n          let categoryIndex = config.dimensions[p].yscale\r\n            .domain()\r\n            .indexOf(category);\r\n          let categoryRangeValue = config.dimensions[p].yscale.range()[\r\n            categoryIndex\r\n          ];\r\n          return (\r\n            categoryRangeValue >= ranges[p][0] &&\r\n            categoryRangeValue <= ranges[p][1]\r\n          );\r\n        },\r\n      };\r\n\r\n      // filter data, but instead of returning it now,\r\n      // put it into multiBrush data which is returned after\r\n      // all brushes are iterated through.\r\n      let filtered = config.data.filter(d =>\r\n        actives.every((p, dimension) =>\r\n          within[config.dimensions[p].type](d, p, dimension)\r\n        )\r\n      );\r\n      for (let z = 0; z < filtered.length; z++) {\r\n        multiBrushData.push(filtered[z]);\r\n      }\r\n      actives = [];\r\n      ranges = {};\r\n    }\r\n    return multiBrushData;\r\n  }\r\n};\r\n\r\nexport default selected;\r\n","const brushPredicate = (brushGroup, config, pc) => (predicate = null) => {\r\n  if (predicate === null) {\r\n    return brushGroup.predicate;\r\n  }\r\n\r\n  predicate = String(predicate).toUpperCase();\r\n  if (predicate !== 'AND' && predicate !== 'OR') {\r\n    throw new Error('Invalid predicate ' + predicate);\r\n  }\r\n\r\n  brushGroup.predicate = predicate;\r\n  config.brushed = brushGroup.currentMode().selected();\r\n  pc.renderBrushed();\r\n  return pc;\r\n};\r\n\r\nconst brushMode = (brushGroup, config, pc) => (mode = null) => {\r\n  if (mode === null) {\r\n    return brushGroup.mode;\r\n  }\r\n\r\n  if (pc.brushModes().indexOf(mode) === -1) {\r\n    throw new Error('pc.brushmode: Unsupported brush mode: ' + mode);\r\n  }\r\n\r\n  // Make sure that we don't trigger unnecessary events by checking if the mode\r\n  // actually changes.\r\n  if (mode !== brushGroup.mode) {\r\n    // When changing brush modes, the first thing we need to do is clearing any\r\n    // brushes from the current mode, if any.\r\n    if (brushGroup.mode !== 'None') {\r\n      pc.brushReset();\r\n    }\r\n\r\n    // Next, we need to 'uninstall' the current brushMode.\r\n    brushGroup.modes[brushGroup.mode].uninstall(pc);\r\n    // Finally, we can install the requested one.\r\n    brushGroup.mode = mode;\r\n    brushGroup.modes[brushGroup.mode].install();\r\n    if (mode === 'None') {\r\n      delete pc.brushPredicate;\r\n    } else {\r\n      pc.brushPredicate = brushPredicate(brushGroup, config, pc);\r\n    }\r\n  }\r\n\r\n  return pc;\r\n};\r\n\r\nexport default brushMode;\r\n","/**\r\n * dimension display names\r\n *\r\n * @param config\r\n * @param d\r\n * @returns {*}\r\n */\r\nconst dimensionLabels = config => d =>\r\n  config.dimensions[d].title ? config.dimensions[d].title : d;\r\n\r\nexport default dimensionLabels;\r\n","import { select, selectAll } from 'd3-selection';\r\n\r\nconst flipAxisAndUpdatePCP = (config, pc, axis) =>\r\n  function(dimension) {\r\n    pc.flip(dimension);\r\n    pc.brushReset(dimension);\r\n\r\n    // select(this.parentElement)\r\n    pc.selection\r\n      .select('svg')\r\n      .selectAll('g.axis')\r\n      .filter(d => d === dimension)\r\n      .transition()\r\n      .duration(config.animationTime)\r\n      .call(axis.scale(config.dimensions[dimension].yscale));\r\n    pc.render();\r\n  };\r\n\r\nexport default flipAxisAndUpdatePCP;\r\n","import { event } from 'd3-selection';\r\n\r\nconst rotateLabels = (config, pc) => {\r\n  if (!config.rotateLabels) return;\r\n\r\n  let delta = event.deltaY;\r\n  delta = delta < 0 ? -5 : delta;\r\n  delta = delta > 0 ? 5 : delta;\r\n\r\n  config.dimensionTitleRotation += delta;\r\n  pc.svg\r\n    .selectAll('text.label')\r\n    .attr(\r\n      'transform',\r\n      'translate(0,-5) rotate(' + config.dimensionTitleRotation + ')'\r\n    );\r\n  event.preventDefault();\r\n};\r\n\r\nexport default rotateLabels;\r\n","import { select } from 'd3-selection';\r\n\r\nimport dimensionLabels from '../util/dimensionLabels';\r\nimport flipAxisAndUpdatePCP from '../util/flipAxisAndUpdatePCP';\r\nimport rotateLabels from '../util/rotateLabels';\r\n\r\nconst updateAxes = (config, pc, position, axis, flags) => (\r\n  animationTime = null\r\n) => {\r\n  if (animationTime === null) {\r\n    animationTime = config.animationTime;\r\n  }\r\n\r\n  const g_data = pc.svg\r\n    .selectAll('.dimension')\r\n    .data(pc.getOrderedDimensionKeys());\r\n  // Enter\r\n  g_data\r\n    .enter()\r\n    .append('svg:g')\r\n    .attr('class', 'dimension')\r\n    .attr('transform', p => 'translate(' + position(p) + ')')\r\n    .style('opacity', 0)\r\n    .append('svg:g')\r\n    .attr('class', 'axis')\r\n    .attr('transform', 'translate(0,0)')\r\n    .each(function(d) {\r\n      const axisElement = select(this).call(\r\n        pc.applyAxisConfig(axis, config.dimensions[d])\r\n      );\r\n\r\n      axisElement\r\n        .selectAll('path')\r\n        .style('fill', 'none')\r\n        .style('stroke', '#222')\r\n        .style('shape-rendering', 'crispEdges');\r\n\r\n      axisElement\r\n        .selectAll('line')\r\n        .style('fill', 'none')\r\n        .style('stroke', '#222')\r\n        .style('shape-rendering', 'crispEdges');\r\n    })\r\n    .append('svg:text')\r\n    .attr('text-anchor', 'middle')\r\n    .attr('class', 'label')\r\n    .attr('x', 0)\r\n    .attr('y', 0)\r\n    .attr(\r\n      'transform',\r\n      'translate(0,-5) rotate(' + config.dimensionTitleRotation + ')'\r\n    )\r\n    .text(dimensionLabels(config))\r\n    .on('dblclick', flipAxisAndUpdatePCP(config, pc, axis))\r\n    .on('wheel', rotateLabels(config, pc));\r\n\r\n  // Update\r\n  g_data.attr('opacity', 0);\r\n  g_data\r\n    .select('.axis')\r\n    .transition()\r\n    .duration(animationTime)\r\n    .each(function(d) {\r\n      select(this).call(pc.applyAxisConfig(axis, config.dimensions[d]));\r\n    });\r\n  g_data\r\n    .select('.label')\r\n    .transition()\r\n    .duration(animationTime)\r\n    .text(dimensionLabels(config))\r\n    .attr(\r\n      'transform',\r\n      'translate(0,-5) rotate(' + config.dimensionTitleRotation + ')'\r\n    );\r\n\r\n  // Exit\r\n  g_data.exit().remove();\r\n\r\n  const g = pc.svg.selectAll('.dimension');\r\n  g.transition()\r\n    .duration(animationTime)\r\n    .attr('transform', p => 'translate(' + position(p) + ')')\r\n    .style('opacity', 1);\r\n\r\n  pc.svg\r\n    .selectAll('.axis')\r\n    .transition()\r\n    .duration(animationTime)\r\n    .each(function(d) {\r\n      select(this).call(pc.applyAxisConfig(axis, config.dimensions[d]));\r\n    });\r\n\r\n  if (flags.brushable) pc.brushable();\r\n  if (flags.reorderable) pc.reorderable();\r\n  if (pc.brushMode() !== 'None') {\r\n    const mode = pc.brushMode();\r\n    pc.brushMode('None');\r\n    pc.brushMode(mode);\r\n  }\r\n  return this;\r\n};\r\n\r\nexport default updateAxes;\r\n","/** adjusts an axis' default range [h()+1, 1] if a NullValueSeparator is set */\r\nconst getRange = config => {\r\n  const h = config.height - config.margin.top - config.margin.bottom;\r\n\r\n  if (config.nullValueSeparator == 'bottom') {\r\n    return [\r\n      h +\r\n        1 -\r\n        config.nullValueSeparatorPadding.bottom -\r\n        config.nullValueSeparatorPadding.top,\r\n      1,\r\n    ];\r\n  } else if (config.nullValueSeparator == 'top') {\r\n    return [\r\n      h + 1,\r\n      1 +\r\n        config.nullValueSeparatorPadding.bottom +\r\n        config.nullValueSeparatorPadding.top,\r\n    ];\r\n  }\r\n  return [h + 1, 1];\r\n};\r\n\r\nexport default getRange;\r\n","import { scaleLinear, scaleOrdinal, scalePoint, scaleTime } from 'd3-scale';\r\nimport { extent } from 'd3-array';\r\n\r\nimport getRange from '../util/getRange';\r\nimport w from '../util/width';\r\nimport h from '../util/height';\r\n\r\nconst autoscale = (config, pc, xscale, ctx) =>\r\n  function() {\r\n    // yscale\r\n    const defaultScales = {\r\n      date: function(k) {\r\n        let _extent = extent(config.data, d => (d[k] ? d[k].getTime() : null));\r\n        // special case if single value\r\n        if (_extent[0] === _extent[1]) {\r\n          return scalePoint()\r\n            .domain(_extent)\r\n            .range(getRange(config));\r\n        }\r\n        if (config.flipAxes.includes(k)) {\r\n          _extent = _extent.map(val => tempDate.unshift(val));\r\n        }\r\n        return scaleTime()\r\n          .domain(_extent)\r\n          .range(getRange(config));\r\n      },\r\n      number: function(k) {\r\n        let _extent = extent(config.data, d => +d[k]);\r\n        // special case if single value\r\n        if (_extent[0] === _extent[1]) {\r\n          return scalePoint()\r\n            .domain(_extent)\r\n            .range(getRange(config));\r\n        }\r\n        if (config.flipAxes.includes(k)) {\r\n          _extent = _extent.map(val => tempDate.unshift(val));\r\n        }\r\n        return scaleLinear()\r\n          .domain(_extent)\r\n          .range(getRange(config));\r\n      },\r\n      string: function(k) {\r\n        let counts = {},\r\n          domain = [];\r\n        // Let's get the count for each value so that we can sort the domain based\r\n        // on the number of items for each value.\r\n        config.data.map(p => {\r\n          if (p[k] === undefined && config.nullValueSeparator !== 'undefined') {\r\n            return null; // null values will be drawn beyond the horizontal null value separator!\r\n          }\r\n          if (counts[p[k]] === undefined) {\r\n            counts[p[k]] = 1;\r\n          } else {\r\n            counts[p[k]] = counts[p[k]] + 1;\r\n          }\r\n        });\r\n        if (config.flipAxes.includes(k)) {\r\n          domain = Object.getOwnPropertyNames(counts).sort();\r\n        } else {\r\n          let tempArr = Object.getOwnPropertyNames(counts).sort();\r\n          for (let i = 0; i < Object.getOwnPropertyNames(counts).length; i++) {\r\n            domain.push(tempArr.pop());\r\n          }\r\n        }\r\n\r\n        //need to create an ordinal scale for categorical data\r\n        let categoricalRange = [];\r\n        if (domain.length === 1) {\r\n          //edge case\r\n          domain = [' ', domain[0], ' '];\r\n        }\r\n        let addBy = getRange(config)[0] / (domain.length - 1);\r\n        for (let j = 0; j < domain.length; j++) {\r\n          if (categoricalRange.length === 0) {\r\n            categoricalRange.push(0);\r\n            continue;\r\n          }\r\n          categoricalRange.push(categoricalRange[j - 1] + addBy);\r\n        }\r\n        return scaleOrdinal()\r\n          .domain(domain)\r\n          .range(categoricalRange);\r\n      },\r\n    };\r\n    Object.keys(config.dimensions).forEach(function(k) {\r\n      if (\r\n        config.dimensions[k].yscale === undefined ||\r\n        config.dimensions[k].yscale === null\r\n      ) {\r\n        config.dimensions[k].yscale = defaultScales[config.dimensions[k].type](\r\n          k\r\n        );\r\n      }\r\n    });\r\n\r\n    // xscale\r\n    // add padding for d3 >= v4 default 0.2\r\n    xscale.range([0, w(config)]).padding(0.2);\r\n\r\n    // Retina display, etc.\r\n    const devicePixelRatio = window.devicePixelRatio || 1;\r\n\r\n    // canvas sizes\r\n    pc.selection\r\n      .selectAll('canvas')\r\n      .style('margin-top', config.margin.top + 'px')\r\n      .style('margin-left', config.margin.left + 'px')\r\n      .style('width', w(config) + 2 + 'px')\r\n      .style('height', h(config) + 2 + 'px')\r\n      .attr('width', (w(config) + 2) * devicePixelRatio)\r\n      .attr('height', (h(config) + 2) * devicePixelRatio);\r\n    // default styles, needs to be set when canvas width changes\r\n    ctx.foreground.strokeStyle = config.color;\r\n    ctx.foreground.lineWidth = config.lineWidth;\r\n    ctx.foreground.globalCompositeOperation = config.composite;\r\n    ctx.foreground.globalAlpha = config.alpha;\r\n    ctx.foreground.scale(devicePixelRatio, devicePixelRatio);\r\n    ctx.brushed.strokeStyle = config.brushedColor;\r\n    ctx.brushed.lineWidth = config.lineWidth;\r\n    ctx.brushed.globalCompositeOperation = config.composite;\r\n    ctx.brushed.globalAlpha = config.alpha;\r\n    ctx.brushed.scale(devicePixelRatio, devicePixelRatio);\r\n    ctx.highlight.lineWidth = config.highlightedLineWidth;\r\n    ctx.highlight.scale(devicePixelRatio, devicePixelRatio);\r\n    ctx.marked.lineWidth = config.markedLineWidth;\r\n    ctx.marked.shadowColor = config.markedShadowColor;\r\n    ctx.marked.shadowBlur = config.markedShadowBlur;\r\n    ctx.marked.scale(devicePixelRatio, devicePixelRatio);\r\n\r\n    return this;\r\n  };\r\n\r\nexport default autoscale;\r\n","import { brushSelection, brushY } from 'd3-brush';\r\nimport { event, select } from 'd3-selection';\r\n\r\nconst brushable = (config, pc, flags) =>\r\n  function() {\r\n    if (!pc.g()) {\r\n      pc.createAxes();\r\n    }\r\n\r\n    const g = pc.g();\r\n\r\n    // Add and store a brush for each axis.\r\n    g.append('svg:g')\r\n      .attr('class', 'brush')\r\n      .each(function(d) {\r\n        if (config.dimensions[d] !== undefined) {\r\n          config.dimensions[d]['brush'] = brushY(select(this)).extent([\r\n            [-15, 0],\r\n            [15, config.dimensions[d].yscale.range()[0]],\r\n          ]);\r\n          select(this).call(\r\n            config.dimensions[d]['brush']\r\n              .on('start', function() {\r\n                if (event.sourceEvent !== null && !event.sourceEvent.ctrlKey) {\r\n                  pc.brushReset();\r\n                }\r\n              })\r\n              .on('brush', function() {\r\n                if (!event.sourceEvent.ctrlKey) {\r\n                  pc.brush();\r\n                }\r\n              })\r\n              .on('end', function() {\r\n                // save brush selection is ctrl key is held\r\n                // store important brush information and\r\n                // the html element of the selection,\r\n                // to make a dummy selection element\r\n                if (event.sourceEvent.ctrlKey) {\r\n                  let html = select(this)\r\n                    .select('.selection')\r\n                    .nodes()[0].outerHTML;\r\n                  html = html.replace(\r\n                    'class=\"selection\"',\r\n                    'class=\"selection dummy' +\r\n                      ' selection-' +\r\n                      config.brushes.length +\r\n                      '\"'\r\n                  );\r\n                  let dat = select(this).nodes()[0].__data__;\r\n                  let brush = {\r\n                    id: config.brushes.length,\r\n                    extent: brushSelection(this),\r\n                    html: html,\r\n                    data: dat,\r\n                  };\r\n                  config.brushes.push(brush);\r\n                  select(select(this).nodes()[0].parentNode)\r\n                    .select('.axis')\r\n                    .nodes()[0].outerHTML += html;\r\n                  pc.brush();\r\n                  config.dimensions[d].brush.move(select(this, null));\r\n                  select(this)\r\n                    .select('.selection')\r\n                    .attr('style', 'display:none');\r\n                  pc.brushable();\r\n                } else {\r\n                  pc.brush();\r\n                }\r\n              })\r\n          );\r\n          select(this).on('dblclick', function() {\r\n            pc.brushReset(d);\r\n          });\r\n        }\r\n      });\r\n\r\n    flags.brushable = true;\r\n    return this;\r\n  };\r\n\r\nexport default brushable;\r\n","import { extent } from 'd3-array';\r\n\r\nconst commonScale = (config, pc) =>\r\n  function(global, type) {\r\n    const t = type || 'number';\r\n    if (typeof global === 'undefined') {\r\n      global = true;\r\n    }\r\n\r\n    // try to autodetect dimensions and create scales\r\n    if (!Object.keys(config.dimensions).length) {\r\n      pc.detectDimensions();\r\n    }\r\n    pc.autoscale();\r\n\r\n    // scales of the same type\r\n    const scales = Object.keys(config.dimensions).filter(\r\n      p => config.dimensions[p].type == t\r\n    );\r\n\r\n    if (global) {\r\n      let _extent = extent(\r\n        scales\r\n          .map(d => config.dimensions[d].yscale.domain())\r\n          .reduce((cur, acc) => cur.concat(acc))\r\n      );\r\n\r\n      scales.forEach(d => {\r\n        config.dimensions[d].yscale.domain(_extent);\r\n      });\r\n    } else {\r\n      scales.forEach(d => {\r\n        config.dimensions[d].yscale.domain(extent(config.data, d => +d[k]));\r\n      });\r\n    }\r\n\r\n    // update centroids\r\n    if (config.bundleDimension !== null) {\r\n      pc.bundleDimension(config.bundleDimension);\r\n    }\r\n\r\n    return this;\r\n  };\r\n\r\nexport default commonScale;\r\n","const computeRealCentroids = (config, position) => row =>\r\n  Object.keys(config.dimensions).map(d => {\r\n    const x = position(d);\r\n    const y = config.dimensions[d].yscale(row[d]);\r\n    return [x, y];\r\n  });\r\n\r\nexport default computeRealCentroids;\r\n","const isValid = d => d !== null && d !== undefined;\r\n\r\nconst applyDimensionDefaults = (config, pc) =>\r\n  function(dims) {\r\n    const types = pc.detectDimensionTypes(config.data);\r\n    dims = dims ? dims : Object.keys(types);\r\n\r\n    return dims.reduce((acc, cur, i) => {\r\n      const k = config.dimensions[cur] ? config.dimensions[cur] : {};\r\n      acc[cur] = {\r\n        ...k,\r\n        orient: isValid(k.orient) ? k.orient : 'left',\r\n        ticks: isValid(k.ticks) ? k.ticks : 5,\r\n        innerTickSize: isValid(k.innerTickSize) ? k.innerTickSize : 6,\r\n        outerTickSize: isValid(k.outerTickSize) ? k.outerTickSize : 0,\r\n        tickPadding: isValid(k.tickPadding) ? k.tickPadding : 3,\r\n        type: isValid(k.type) ? k.type : types[cur],\r\n        index: isValid(k.index) ? k.index : i,\r\n      };\r\n\r\n      return acc;\r\n    }, {});\r\n  };\r\n\r\nexport default applyDimensionDefaults;\r\n","import { select } from 'd3-selection';\r\n\r\nimport dimensionLabels from '../util/dimensionLabels';\r\nimport flipAxisAndUpdatePCP from '../util/flipAxisAndUpdatePCP';\r\nimport rotateLabels from '../util/rotateLabels';\r\n\r\nimport w from '../util/width';\r\nimport h from '../util/height';\r\n\r\n/**\r\n * Create static SVG axes with dimension names, ticks, and labels.\r\n *\r\n * @param config\r\n * @param pc\r\n * @param xscale\r\n * @param flags\r\n * @param axis\r\n * @returns {Function}\r\n */\r\nconst createAxes = (config, pc, xscale, flags, axis) =>\r\n  function() {\r\n    if (pc.g() !== undefined) {\r\n      pc.removeAxes();\r\n    }\r\n    // Add a group element for each dimension.\r\n    pc._g = pc.svg\r\n      .selectAll('.dimension')\r\n      .data(pc.getOrderedDimensionKeys(), function(d) {\r\n        return d;\r\n      })\r\n      .enter()\r\n      .append('svg:g')\r\n      .attr('class', 'dimension')\r\n      .attr('transform', function(d) {\r\n        return 'translate(' + xscale(d) + ')';\r\n      });\r\n    // Add an axis and title.\r\n    pc._g\r\n      .append('svg:g')\r\n      .attr('class', 'axis')\r\n      .attr('transform', 'translate(0,0)')\r\n      .each(function(d) {\r\n        let axisElement = select(this).call(\r\n          pc.applyAxisConfig(axis, config.dimensions[d])\r\n        );\r\n\r\n        axisElement\r\n          .selectAll('path')\r\n          .style('fill', 'none')\r\n          .style('stroke', '#222')\r\n          .style('shape-rendering', 'crispEdges');\r\n\r\n        axisElement\r\n          .selectAll('line')\r\n          .style('fill', 'none')\r\n          .style('stroke', '#222')\r\n          .style('shape-rendering', 'crispEdges');\r\n      })\r\n\r\n      .append('svg:text')\r\n      .attr('text-anchor', 'middle')\r\n      .attr('y', 0)\r\n      .attr(\r\n        'transform',\r\n        'translate(0,-5) rotate(' + config.dimensionTitleRotation + ')'\r\n      )\r\n      .attr('x', 0)\r\n      .attr('class', 'label')\r\n      .text(dimensionLabels(config))\r\n      .on('dblclick', flipAxisAndUpdatePCP(config, pc, axis))\r\n      .on('wheel', rotateLabels(config, pc));\r\n\r\n    if (config.nullValueSeparator === 'top') {\r\n      pc.svg\r\n        .append('line')\r\n        .attr('x1', 0)\r\n        .attr('y1', 1 + config.nullValueSeparatorPadding.top)\r\n        .attr('x2', w(config))\r\n        .attr('y2', 1 + config.nullValueSeparatorPadding.top)\r\n        .attr('stroke-width', 1)\r\n        .attr('stroke', '#777')\r\n        .attr('fill', 'none')\r\n        .attr('shape-rendering', 'crispEdges');\r\n    } else if (config.nullValueSeparator === 'bottom') {\r\n      pc.svg\r\n        .append('line')\r\n        .attr('x1', 0)\r\n        .attr('y1', h(config) + 1 - config.nullValueSeparatorPadding.bottom)\r\n        .attr('x2', w(config))\r\n        .attr('y2', h(config) + 1 - config.nullValueSeparatorPadding.bottom)\r\n        .attr('stroke-width', 1)\r\n        .attr('stroke', '#777')\r\n        .attr('fill', 'none')\r\n        .attr('shape-rendering', 'crispEdges');\r\n    }\r\n\r\n    flags.axes = true;\r\n    return this;\r\n  };\r\n\r\nexport default createAxes;\r\n","import { entries } from 'd3-collection';\r\nimport { min } from 'd3-array';\r\n\r\n//draw dots with radius r on the axis line where data intersects\r\nconst axisDots = (config, pc, position) => _r => {\r\n  const r = _r || 0.1;\r\n  const ctx = pc.ctx.dots;\r\n  const startAngle = 0;\r\n  const endAngle = 2 * Math.PI;\r\n  ctx.globalAlpha = min([1 / Math.pow(config.data.length, 1 / 2), 1]);\r\n  config.data.forEach(d => {\r\n    entries(config.dimensions).forEach((p, i) => {\r\n      ctx.beginPath();\r\n      ctx.arc(\r\n        position(p),\r\n        config.dimensions[p.key].yscale(d[p]),\r\n        r,\r\n        startAngle,\r\n        endAngle\r\n      );\r\n      ctx.stroke();\r\n      ctx.fill();\r\n    });\r\n  });\r\n  return this;\r\n};\r\n\r\nexport default axisDots;\r\n","import { axisBottom, axisLeft, axisRight, axisTop } from 'd3-axis';\r\n\r\nconst applyAxisConfig = (axis, dimension) => {\r\n  let axisCfg;\r\n\r\n  switch (dimension.orient) {\r\n    case 'left':\r\n      axisCfg = axisLeft(dimension.yscale);\r\n      break;\r\n    case 'right':\r\n      axisCfg = axisRight(dimension.yscale);\r\n      break;\r\n    case 'top':\r\n      axisCfg = axisTop(dimension.yscale);\r\n      break;\r\n    case 'bottom':\r\n      axisCfg = axisBottom(dimension.yscale);\r\n      break;\r\n    default:\r\n      axisCfg = axisLeft(dimension.yscale);\r\n      break;\r\n  }\r\n\r\n  axisCfg\r\n    .ticks(dimension.ticks)\r\n    .tickValues(dimension.tickValues)\r\n    .tickSizeInner(dimension.innerTickSize)\r\n    .tickSizeOuter(dimension.outerTickSize)\r\n    .tickPadding(dimension.tickPadding)\r\n    .tickFormat(dimension.tickFormat);\r\n\r\n  return axisCfg;\r\n};\r\n\r\nexport default applyAxisConfig;\r\n","import { drag } from 'd3-drag';\r\nimport { event, select } from 'd3-selection';\r\n\r\nimport w from '../util/width';\r\n\r\n// Jason Davies, http://bl.ocks.org/1341281\r\nconst reorderable = (config, pc, xscale, position, dragging, flags) =>\r\n  function() {\r\n    if (pc.g() === undefined) pc.createAxes();\r\n    const g = pc.g();\r\n\r\n    g.style('cursor', 'move').call(\r\n      drag()\r\n        .on('start', function(d) {\r\n          dragging[d] = this.__origin__ = xscale(d);\r\n        })\r\n        .on('drag', function(d) {\r\n          dragging[d] = Math.min(\r\n            w(config),\r\n            Math.max(0, (this.__origin__ += event.dx))\r\n          );\r\n          pc.sortDimensions();\r\n          xscale.domain(pc.getOrderedDimensionKeys());\r\n          pc.render();\r\n          g.attr('transform', d => 'translate(' + position(d) + ')');\r\n        })\r\n        .on('end', function(d) {\r\n          delete this.__origin__;\r\n          delete dragging[d];\r\n          select(this)\r\n            .transition()\r\n            .attr('transform', 'translate(' + xscale(d) + ')');\r\n          pc.render();\r\n          pc.renderMarked();\r\n        })\r\n    );\r\n    flags.reorderable = true;\r\n    return this;\r\n  };\r\n\r\nexport default reorderable;\r\n","// rescale for height, width and margins\r\n// TODO currently assumes chart is brushable, and destroys old brushes\r\nconst resize = (config, pc, flags, events) => {\r\n  return function() {\r\n    // selection size\r\n    pc.selection\r\n      .select('svg')\r\n      .attr('width', config.width)\r\n      .attr('height', config.height);\r\n    pc.svg.attr(\r\n      'transform',\r\n      'translate(' + config.margin.left + ',' + config.margin.top + ')'\r\n    );\r\n\r\n    // FIXME: the current brush state should pass through\r\n    if (flags.brushable) pc.brushReset();\r\n\r\n    // scales\r\n    pc.autoscale();\r\n\r\n    // axes, destroys old brushes.\r\n    if (pc.g()) pc.createAxes();\r\n    if (flags.brushable) pc.brushable();\r\n    if (flags.reorderable) pc.reorderable();\r\n\r\n    events.call('resize', this, {\r\n      width: config.width,\r\n      height: config.height,\r\n      margin: config.margin,\r\n    });\r\n\r\n    return this;\r\n  };\r\n};\r\n\r\nexport default resize;\r\n","// Reorder dimensions, such that the highest value (visually) is on the left and\r\n// the lowest on the right. Visual values are determined by the data values in\r\n// the given row.\r\nconst reorder = (config, pc, xscale) => rowdata => {\r\n  const firstDim = pc.getOrderedDimensionKeys()[0];\r\n\r\n  pc.sortDimensionsByRowData(rowdata);\r\n  // NOTE: this is relatively cheap given that:\r\n  // number of dimensions < number of data items\r\n  // Thus we check equality of order to prevent rerendering when this is the case.\r\n  const reordered = firstDim !== pc.getOrderedDimensionKeys()[0];\r\n\r\n  if (reordered) {\r\n    xscale.domain(pc.getOrderedDimensionKeys());\r\n    const highlighted = config.highlighted.slice(0);\r\n    pc.unhighlight();\r\n\r\n    const marked = config.marked.slice(0);\r\n    pc.unmark();\r\n\r\n    const g = pc.g();\r\n    g.transition()\r\n      .duration(1500)\r\n      .attr('transform', d => 'translate(' + xscale(d) + ')');\r\n    pc.render();\r\n\r\n    // pc.highlight() does not check whether highlighted is length zero, so we do that here.\r\n    if (highlighted.length !== 0) {\r\n      pc.highlight(highlighted);\r\n    }\r\n    if (marked.length !== 0) {\r\n      pc.mark(marked);\r\n    }\r\n  }\r\n};\r\n\r\nexport default reorder;\r\n","const sortDimensions = (config, position) => () => {\r\n  const copy = Object.assign({}, config.dimensions);\r\n  const positionSortedKeys = Object.keys(config.dimensions).sort(\r\n    (a, b) => (position(a) - position(b) === 0 ? 1 : position(a) - position(b))\r\n  );\r\n  config.dimensions = {};\r\n  positionSortedKeys.forEach((p, i) => {\r\n    config.dimensions[p] = copy[p];\r\n    config.dimensions[p].index = i;\r\n  });\r\n};\r\n\r\nexport default sortDimensions;\r\n","const sortDimensionsByRowData = config => rowdata => {\r\n  const copy = Object.assign({}, config.dimensions);\r\n  const positionSortedKeys = Object.keys(config.dimensions).sort((a, b) => {\r\n    const pixelDifference =\r\n      config.dimensions[a].yscale(rowdata[a]) -\r\n      config.dimensions[b].yscale(rowdata[b]);\r\n\r\n    // Array.sort is not necessarily stable, this means that if pixelDifference is zero\r\n    // the ordering of dimensions might change unexpectedly. This is solved by sorting on\r\n    // variable name in that case.\r\n    return pixelDifference === 0 ? a.localeCompare(b) : pixelDifference;\r\n  });\r\n  config.dimensions = {};\r\n  positionSortedKeys.forEach((p, i) => {\r\n    config.dimensions[p] = copy[p];\r\n    config.dimensions[p].index = i;\r\n  });\r\n};\r\n\r\nexport default sortDimensionsByRowData;\r\n","const isBrushed = (config, brushGroup) => {\r\n  if (config.brushed && config.brushed.length !== config.data.length)\r\n    return true;\r\n\r\n  const object = brushGroup.currentMode().brushState();\r\n\r\n  for (let key in object) {\r\n    if (object.hasOwnProperty(key)) {\r\n      return true;\r\n    }\r\n  }\r\n  return false;\r\n};\r\n\r\nexport default isBrushed;\r\n","import isBrushed from '../util/isBrushed';\r\nimport w from '../util/width';\r\nimport h from '../util/height';\r\n\r\nconst clear = (config, pc, ctx, brushGroup) =>\r\n  function(layer) {\r\n    ctx[layer].clearRect(0, 0, w(config) + 2, h(config) + 2);\r\n\r\n    // This will make sure that the foreground items are transparent\r\n    // without the need for changing the opacity style of the foreground canvas\r\n    // as this would stop the css styling from working\r\n    if (layer === 'brushed' && isBrushed(config, brushGroup)) {\r\n      ctx.brushed.fillStyle = pc.selection.style('background-color');\r\n      ctx.brushed.globalAlpha = 1 - config.alphaOnBrushed;\r\n      ctx.brushed.fillRect(0, 0, w(config) + 2, h(config) + 2);\r\n      ctx.brushed.globalAlpha = config.alpha;\r\n    }\r\n    return this;\r\n  };\r\n\r\nexport default clear;\r\n","export const PRECISION = 1e-6;","\"use strict\";\r\n\r\nimport { PRECISION } from \"./PRECISION\";\r\nimport { Vector } from \"./Vector\";\r\n\r\nexport class Matrix\r\n{\r\n    constructor (elements)\r\n    {\r\n        this.setElements(elements);\r\n    }\r\n\r\n    e (i,j)\r\n    {\r\n        if (i < 1 || i > this.elements.length || j < 1 || j > this.elements[0].length)\r\n        {\r\n            return null;\r\n        }\r\n        return this.elements[i-1][j-1];\r\n    }\r\n\r\n    row (i)\r\n    {\r\n        if (i > this.elements.length)\r\n        {\r\n            return null;\r\n        }\r\n        return new Vector(this.elements[i-1]);\r\n    }\r\n\r\n    col (j)\r\n    {\r\n        if (this.elements.length === 0)\r\n        {\r\n            return null;\r\n        }\r\n        if (j > this.elements[0].length)\r\n        {\r\n            return null;\r\n        }\r\n        var col = [], n = this.elements.length;\r\n        for (var i = 0; i < n; i++)\r\n        {\r\n            col.push(this.elements[i][j-1]);\r\n        }\r\n        return new Vector(col);\r\n    }\r\n\r\n    dimensions ()\r\n    {\r\n        var cols = (this.elements.length === 0) ? 0 : this.elements[0].length;\r\n        return {rows: this.elements.length, cols: cols};\r\n    }\r\n\r\n    rows ()\r\n    {\r\n        return this.elements.length;\r\n    }\r\n\r\n    cols ()\r\n    {\r\n        if (this.elements.length === 0)\r\n        {\r\n            return 0;\r\n        }\r\n        return this.elements[0].length;\r\n    }\r\n\r\n    eql (matrix)\r\n    {\r\n        var M = matrix.elements || matrix;\r\n        if (!M[0] || typeof(M[0][0]) === 'undefined')\r\n        {\r\n            M = new Matrix(M).elements;\r\n        }\r\n        if (this.elements.length === 0 || M.length === 0)\r\n        {\r\n            return this.elements.length === M.length;\r\n        }\r\n        if (this.elements.length !== M.length)\r\n        {\r\n            return false;\r\n        }\r\n        if (this.elements[0].length !== M[0].length)\r\n        {\r\n            return false;\r\n        }\r\n        var i = this.elements.length, nj = this.elements[0].length, j;\r\n        while (i--)\r\n        {\r\n            j = nj;\r\n            while (j--)\r\n            {\r\n                if (Math.abs(this.elements[i][j] - M[i][j]) > PRECISION)\r\n                {\r\n                    return false;\r\n                }\r\n            }\r\n        }\r\n        return true;\r\n    }\r\n\r\n    dup ()\r\n    {\r\n        return new Matrix(this.elements);\r\n    }\r\n\r\n    map (fn, context)\r\n    {\r\n        if (this.elements.length === 0)\r\n        {\r\n            return new Matrix([]);\r\n        }\r\n        var els = [], i = this.elements.length, nj = this.elements[0].length, j;\r\n        while (i--)\r\n        {\r\n            j = nj;\r\n            els[i] = [];\r\n            while (j--)\r\n            {\r\n                els[i][j] = fn.call(context, this.elements[i][j], i + 1, j + 1);\r\n            }\r\n        }\r\n        return new Matrix(els);\r\n    }\r\n\r\n    isSameSizeAs (matrix)\r\n    {\r\n        var M = matrix.elements || matrix;\r\n        if (typeof(M[0][0]) === 'undefined')\r\n        {\r\n            M = new Matrix(M).elements;\r\n        }\r\n        if (this.elements.length === 0)\r\n        {\r\n            return M.length === 0;\r\n        }\r\n        return (this.elements.length === M.length && this.elements[0].length === M[0].length);\r\n    }\r\n\r\n    add (matrix)\r\n    {\r\n        if (this.elements.length === 0)\r\n        {\r\n            return this.map(function(x)\r\n                {\r\n                    return x\r\n                });\r\n        }\r\n        var M = matrix.elements || matrix;\r\n        if (typeof(M[0][0]) === 'undefined')\r\n        {\r\n            M = new Matrix(M).elements;\r\n        }\r\n        if (!this.isSameSizeAs(M))\r\n        {\r\n            return null;\r\n        }\r\n        return this.map(function(x, i, j)\r\n            {\r\n                return x + M[i-1][j-1];\r\n            });\r\n    }\r\n\r\n    subtract (matrix)\r\n    {\r\n        if (this.elements.length === 0)\r\n        {\r\n            return this.map(function(x)\r\n            {\r\n                return x;\r\n            });\r\n        }\r\n        var M = matrix.elements || matrix;\r\n        if (typeof(M[0][0]) === 'undefined')\r\n        {\r\n            M = new Matrix(M).elements;\r\n        }\r\n        if (!this.isSameSizeAs(M))\r\n        {\r\n            return null;\r\n        }\r\n        return this.map(function(x, i, j)\r\n            {\r\n                return x - M[i-1][j-1];\r\n            });\r\n    }\r\n\r\n    canMultiplyFromLeft (matrix)\r\n    {\r\n        if (this.elements.length === 0)\r\n        {\r\n            return false;\r\n        }\r\n        var M = matrix.elements || matrix;\r\n        if (typeof(M[0][0]) === 'undefined')\r\n        {\r\n            M = new Matrix(M).elements;\r\n        }\r\n        // this.columns should equal matrix.rows\r\n        return (this.elements[0].length === M.length);\r\n    }\r\n\r\n    multiply (matrix)\r\n    {\r\n        if (this.elements.length === 0)\r\n        {\r\n            return null;\r\n        }\r\n        if (!matrix.elements)\r\n        {\r\n            return this.map(function(x)\r\n            {\r\n                return x * matrix;\r\n            });\r\n        }\r\n        var returnVector = matrix.modulus ? true : false;\r\n        var M = matrix.elements || matrix;\r\n        if (typeof(M[0][0]) === 'undefined')\r\n        {\r\n            M = new Matrix(M).elements;\r\n        }\r\n        if (!this.canMultiplyFromLeft(M))\r\n        {\r\n            return null;\r\n        }\r\n        var i = this.elements.length, nj = M[0].length, j;\r\n        var cols = this.elements[0].length, c, elements = [], sum;\r\n        while (i--)\r\n        {\r\n            j = nj;\r\n            elements[i] = [];\r\n            while (j--)\r\n            {\r\n                c = cols;\r\n                sum = 0;\r\n                while (c--)\r\n                {\r\n                    sum += this.elements[i][c] * M[c][j];\r\n                }\r\n                elements[i][j] = sum;\r\n            }\r\n        }\r\n        var M = new Matrix(elements);\r\n        return returnVector ? M.col(1) : M;\r\n    }\r\n\r\n    minor (a, b, c, d)\r\n    {\r\n        if (this.elements.length === 0)\r\n        {\r\n            return null;\r\n        }\r\n        var elements = [], ni = c, i, nj, j;\r\n        var rows = this.elements.length, cols = this.elements[0].length;\r\n        while (ni--)\r\n        {\r\n            i = c - ni - 1;\r\n            elements[i] = [];\r\n            nj = d;\r\n            while (nj--)\r\n            {\r\n                j = d - nj - 1;\r\n                elements[i][j] = this.elements[(a+i-1)%rows][(b+j-1)%cols];\r\n            }\r\n        }\r\n        return new Matrix(elements);\r\n    }\r\n\r\n    transpose ()\r\n    {\r\n        if (this.elements.length === 0)\r\n        {\r\n            return new Matrix([]);\r\n        }\r\n        var rows = this.elements.length, i, cols = this.elements[0].length, j;\r\n        var elements = [], i = cols;\r\n        while (i--)\r\n        {\r\n            j = rows;\r\n            elements[i] = [];\r\n            while (j--)\r\n            {\r\n                elements[i][j] = this.elements[j][i];\r\n            }\r\n        }\r\n        return new Matrix(elements);\r\n    }\r\n\r\n    isSquare ()\r\n    {\r\n        var cols = (this.elements.length === 0) ? 0 : this.elements[0].length;\r\n        return (this.elements.length === cols);\r\n    }\r\n\r\n    max ()\r\n    {\r\n        if (this.elements.length === 0)\r\n        {\r\n            return null;\r\n        }\r\n        var m = 0, i = this.elements.length, nj = this.elements[0].length, j;\r\n        while (i--)\r\n        {\r\n            j = nj;\r\n            while (j--)\r\n            {\r\n                if (Math.abs(this.elements[i][j]) > Math.abs(m))\r\n                {\r\n                    m = this.elements[i][j];\r\n                }\r\n            }\r\n        }\r\n        return m;\r\n    }\r\n\r\n    indexOf (x)\r\n    {\r\n        if (this.elements.length === 0)\r\n        {\r\n            return null;\r\n        }\r\n        var index = null, ni = this.elements.length, i, nj = this.elements[0].length, j;\r\n        for (i = 0; i < ni; i++)\r\n        {\r\n            for (j = 0; j < nj; j++)\r\n            {\r\n                if (this.elements[i][j] === x)\r\n                {\r\n                    return {\r\n                        i: i+1,\r\n                        j: j+1\r\n                    };\r\n                }\r\n            }\r\n        }\r\n        return null;\r\n    }\r\n\r\n    diagonal ()\r\n    {\r\n        if (!this.isSquare)\r\n        {\r\n            return null;\r\n        }\r\n        var els = [], n = this.elements.length;\r\n        for (var i = 0; i < n; i++)\r\n        {\r\n            els.push(this.elements[i][i]);\r\n        }\r\n        return new Vector(els);\r\n    }\r\n\r\n    toRightTriangular ()\r\n    {\r\n        if (this.elements.length === 0)\r\n        {\r\n            return new Matrix([]);\r\n        }\r\n        var M = this.dup(), els;\r\n        var n = this.elements.length, i, j, np = this.elements[0].length, p;\r\n        for (i = 0; i < n; i++)\r\n        {\r\n            if (M.elements[i][i] === 0)\r\n            {\r\n                for (j = i + 1; j < n; j++)\r\n                {\r\n                    if (M.elements[j][i] !== 0)\r\n                    {\r\n                        els = [];\r\n                        for (p = 0; p < np; p++)\r\n                        {\r\n                            els.push(M.elements[i][p] + M.elements[j][p]);\r\n                        }\r\n                        M.elements[i] = els;\r\n                        break;\r\n                    }\r\n                }\r\n            }\r\n            if (M.elements[i][i] !== 0)\r\n            {\r\n                for (j = i + 1; j < n; j++)\r\n                {\r\n                    var multiplier = M.elements[j][i] / M.elements[i][i];\r\n                    els = [];\r\n                    for (p = 0; p < np; p++)\r\n                    {\r\n                        // Elements with column numbers up to an including the number of the\r\n                        // row that we're subtracting can safely be set straight to zero,\r\n                        // since that's the point of this routine and it avoids having to\r\n                        // loop over and correct rounding errors later\r\n                        els.push(p <= i ? 0 : M.elements[j][p] - M.elements[i][p] * multiplier);\r\n                    }\r\n                    M.elements[j] = els;\r\n                }\r\n            }\r\n        }\r\n        return M;\r\n    }\r\n\r\n    determinant ()\r\n    {\r\n        if (this.elements.length === 0)\r\n        {\r\n            return 1;\r\n        }\r\n        if (!this.isSquare())\r\n        {\r\n            return null;\r\n        }\r\n        var M = this.toRightTriangular();\r\n        var det = M.elements[0][0], n = M.elements.length;\r\n        for (var i = 1; i < n; i++)\r\n        {\r\n            det = det * M.elements[i][i];\r\n        }\r\n        return det;\r\n    }\r\n\r\n    isSingular ()\r\n    {\r\n        return (this.isSquare() && this.determinant() === 0);\r\n    }\r\n\r\n    trace ()\r\n    {\r\n        if (this.elements.length === 0)\r\n        {\r\n            return 0;\r\n        }\r\n        if (!this.isSquare())\r\n        {\r\n            return null;\r\n        }\r\n        var tr = this.elements[0][0], n = this.elements.length;\r\n        for (var i = 1; i < n; i++)\r\n        {\r\n            tr += this.elements[i][i];\r\n        }\r\n        return tr;\r\n    }\r\n\r\n    rank ()\r\n    {\r\n        if (this.elements.length === 0)\r\n        {\r\n            return 0;\r\n        }\r\n        var M = this.toRightTriangular(), rank = 0;\r\n        var i = this.elements.length, nj = this.elements[0].length, j;\r\n        while (i--)\r\n        {\r\n            j = nj;\r\n            while (j--)\r\n            {\r\n                if (Math.abs(M.elements[i][j]) > PRECISION)\r\n                {\r\n                    rank++;\r\n                    break;\r\n                }\r\n            }\r\n        }\r\n        return rank;\r\n    }\r\n\r\n    augment (matrix)\r\n    {\r\n        if (this.elements.length === 0)\r\n        {\r\n            return this.dup();\r\n        }\r\n        var M = matrix.elements || matrix;\r\n        if (typeof(M[0][0]) === 'undefined')\r\n        {\r\n            M = new Matrix(M).elements;\r\n        }\r\n        var T = this.dup(), cols = T.elements[0].length;\r\n        var i = T.elements.length, nj = M[0].length, j;\r\n        if (i !== M.length)\r\n        {\r\n            return null;\r\n        }\r\n        while (i--)\r\n        {\r\n            j = nj;\r\n            while (j--)\r\n            {\r\n                T.elements[i][cols + j] = M[i][j];\r\n            }\r\n        }\r\n        return T;\r\n    }\r\n\r\n    inverse ()\r\n    {\r\n        if (this.elements.length === 0)\r\n        {\r\n            return null;\r\n        }\r\n        if (!this.isSquare() || this.isSingular())\r\n        {\r\n            return null;\r\n        }\r\n        var n = this.elements.length, i= n, j;\r\n        var M = this.augment(Matrix.I(n)).toRightTriangular();\r\n        var np = M.elements[0].length, p, els, divisor;\r\n        var inverse_elements = [], new_element;\r\n        // Matrix is non-singular so there will be no zeros on the\r\n        // diagonal. Cycle through rows from last to first.\r\n        while (i--)\r\n        {\r\n            // First, normalise diagonal elements to 1\r\n            els = [];\r\n            inverse_elements[i] = [];\r\n            divisor = M.elements[i][i];\r\n            for (p = 0; p < np; p++)\r\n            {\r\n                new_element = M.elements[i][p] / divisor;\r\n                els.push(new_element);\r\n                // Shuffle off the current row of the right hand side into the results\r\n                // array as it will not be modified by later runs through this loop\r\n                if (p >= n)\r\n                {\r\n                    inverse_elements[i].push(new_element);\r\n                }\r\n            }\r\n            M.elements[i] = els;\r\n            // Then, subtract this row from those above it to give the identity matrix\r\n            // on the left hand side\r\n            j = i;\r\n            while (j--)\r\n            {\r\n                els = [];\r\n                for (p = 0; p < np; p++)\r\n                {\r\n                    els.push(M.elements[j][p] - M.elements[i][p] * M.elements[j][i]);\r\n                }\r\n                M.elements[j] = els;\r\n            }\r\n        }\r\n        return new Matrix(inverse_elements);\r\n    }\r\n\r\n    round ()\r\n    {\r\n        return this.map(function(x)\r\n            {\r\n                return Math.round(x);\r\n            });\r\n    }\r\n\r\n    snapTo (x)\r\n    {\r\n        return this.map(function(p)\r\n            {\r\n                return (Math.abs(p - x) <= PRECISION) ? x : p;\r\n            });\r\n    }\r\n\r\n    inspect ()\r\n    {\r\n        var matrix_rows = [];\r\n        var n = this.elements.length;\r\n        if (n === 0) return '[]';\r\n        for (var i = 0; i < n; i++)\r\n        {\r\n            matrix_rows.push(new Vector(this.elements[i]).inspect());\r\n        }\r\n        return matrix_rows.join('\\n');\r\n    }\r\n\r\n    setElements (els)\r\n    {\r\n        var i, j, elements = els.elements || els;\r\n        if (elements[0] && typeof(elements[0][0]) !== 'undefined')\r\n        {\r\n            i = elements.length;\r\n            this.elements = [];\r\n            while (i--)\r\n            {\r\n                j = elements[i].length;\r\n                this.elements[i] = [];\r\n                while (j--)\r\n                {\r\n                    this.elements[i][j] = elements[i][j];\r\n                }\r\n            }\r\n            return this;\r\n        }\r\n        var n = elements.length;\r\n        this.elements = [];\r\n        for (i = 0; i < n; i++)\r\n        {\r\n            this.elements.push([elements[i]]);\r\n        }\r\n        return this;\r\n    }\r\n\r\n    //From glUtils.js\r\n    flatten ()\r\n    {\r\n        var result = [];\r\n        if (this.elements.length == 0)\r\n        {\r\n            return [];\r\n        }\r\n\r\n\r\n        for (var j = 0; j < this.elements[0].length; j++)\r\n        {\r\n            for (var i = 0; i < this.elements.length; i++)\r\n            {\r\n                result.push(this.elements[i][j]);\r\n            }\r\n        }\r\n        return result;\r\n    }\r\n\r\n    //From glUtils.js\r\n    ensure4x4 ()\r\n    {\r\n        if (this.elements.length == 4 && this.elements[0].length == 4)\r\n        {\r\n            return this;\r\n        }\r\n\r\n        if (this.elements.length > 4 || this.elements[0].length > 4)\r\n        {\r\n            return null;\r\n        }\r\n\r\n        for (var i = 0; i < this.elements.length; i++)\r\n        {\r\n            for (var j = this.elements[i].length; j < 4; j++)\r\n            {\r\n                if (i == j)\r\n                {\r\n                    this.elements[i].push(1);\r\n                }\r\n                else\r\n                {\r\n                    this.elements[i].push(0);\r\n                }\r\n            }\r\n        }\r\n\r\n        for (var i = this.elements.length; i < 4; i++)\r\n        {\r\n            if (i == 0)\r\n            {\r\n                this.elements.push([1, 0, 0, 0]);\r\n            }\r\n            else if (i == 1)\r\n            {\r\n                this.elements.push([0, 1, 0, 0]);\r\n            }\r\n            else if (i == 2)\r\n            {\r\n                this.elements.push([0, 0, 1, 0]);\r\n            }\r\n            else if (i == 3)\r\n            {\r\n                this.elements.push([0, 0, 0, 1]);\r\n            }\r\n        }\r\n\r\n        return this;\r\n    }\r\n\r\n    //From glUtils.js\r\n    make3x3 ()\r\n    {\r\n        if (this.elements.length != 4 || this.elements[0].length != 4)\r\n        {\r\n            return null;\r\n        }\r\n\r\n        return new Matrix([[this.elements[0][0], this.elements[0][1], this.elements[0][2]],\r\n                              [this.elements[1][0], this.elements[1][1], this.elements[1][2]],\r\n                              [this.elements[2][0], this.elements[2][1], this.elements[2][2]]]);\r\n    };\r\n}\r\n\r\nMatrix.I = function(n)\r\n{\r\n    var els = [], i = n, j;\r\n    while (i--)\r\n    {\r\n        j = n;\r\n        els[i] = [];\r\n        while (j--)\r\n        {\r\n            els[i][j] = (i === j) ? 1 : 0;\r\n        }\r\n    }\r\n    return new Matrix(els);\r\n};\r\n\r\nMatrix.Diagonal = function(elements)\r\n{\r\n    var i = elements.length;\r\n    var M = Matrix.I(i);\r\n    while (i--)\r\n    {\r\n        M.elements[i][i] = elements[i];\r\n    }\r\n    return M;\r\n};\r\n\r\nMatrix.Rotation = function(theta, a)\r\n{\r\n    if (!a)\r\n    {\r\n        return new Matrix([\r\n            [Math.cos(theta),  -Math.sin(theta)],\r\n            [Math.sin(theta),   Math.cos(theta)]\r\n        ]);\r\n    }\r\n    var axis = a.dup();\r\n    if (axis.elements.length !== 3)\r\n    {\r\n        return null;\r\n    }\r\n    var mod = axis.modulus();\r\n    var x = axis.elements[0]/mod, y = axis.elements[1]/mod, z = axis.elements[2]/mod;\r\n    var s = Math.sin(theta), c = Math.cos(theta), t = 1 - c;\r\n    // Formula derived here: http://www.gamedev.net/reference/articles/article1199.asp\r\n    // That proof rotates the co-ordinate system so theta becomes -theta and sin\r\n    // becomes -sin here.\r\n    return new Matrix([\r\n        [ t*x*x + c, t*x*y - s*z, t*x*z + s*y ],\r\n        [ t*x*y + s*z, t*y*y + c, t*y*z - s*x ],\r\n        [ t*x*z - s*y, t*y*z + s*x, t*z*z + c ]\r\n    ]);\r\n};\r\n\r\nMatrix.RotationX = function(t)\r\n{\r\n    var c = Math.cos(t), s = Math.sin(t);\r\n    return new Matrix([\r\n        [  1,  0,  0 ],\r\n        [  0,  c, -s ],\r\n        [  0,  s,  c ]\r\n    ]);\r\n};\r\nMatrix.RotationY = function(t)\r\n{\r\n    var c = Math.cos(t), s = Math.sin(t);\r\n    return new Matrix([\r\n        [  c,  0,  s ],\r\n        [  0,  1,  0 ],\r\n        [ -s,  0,  c ]\r\n    ]);\r\n};\r\nMatrix.RotationZ = function(t)\r\n{\r\n    var c = Math.cos(t), s = Math.sin(t);\r\n    return new Matrix([\r\n        [  c, -s,  0 ],\r\n        [  s,  c,  0 ],\r\n        [  0,  0,  1 ]\r\n    ]);\r\n};\r\n\r\nMatrix.Random = function(n, m)\r\n{\r\n    return Matrix.Zero(n, m).map(function()\r\n        {\r\n            return Math.random();\r\n        });\r\n};\r\n\r\n//From glUtils.js\r\nMatrix.Translation = function (v)\r\n{\r\n    if (v.elements.length == 2)\r\n    {\r\n        var r = Matrix.I(3);\r\n        r.elements[2][0] = v.elements[0];\r\n        r.elements[2][1] = v.elements[1];\r\n        return r;\r\n    }\r\n\r\n    if (v.elements.length == 3)\r\n    {\r\n        var r = Matrix.I(4);\r\n        r.elements[0][3] = v.elements[0];\r\n        r.elements[1][3] = v.elements[1];\r\n        r.elements[2][3] = v.elements[2];\r\n        return r;\r\n    }\r\n\r\n    throw \"Invalid length for Translation\";\r\n};\r\n\r\nMatrix.Zero = function(n, m)\r\n{\r\n    var els = [], i = n, j;\r\n    while (i--)\r\n    {\r\n        j = m;\r\n        els[i] = [];\r\n        while (j--)\r\n        {\r\n            els[i][j] = 0;\r\n        }\r\n    }\r\n    return new Matrix(els);\r\n};\r\n\r\nMatrix.prototype.toUpperTriangular = Matrix.prototype.toRightTriangular;\r\nMatrix.prototype.det = Matrix.prototype.determinant;\r\nMatrix.prototype.tr = Matrix.prototype.trace;\r\nMatrix.prototype.rk = Matrix.prototype.rank;\r\nMatrix.prototype.inv = Matrix.prototype.inverse;\r\nMatrix.prototype.x = Matrix.prototype.multiply;","\"use strict\";\r\n\r\nimport { Matrix } from \"./Matrix\";\r\nimport { PRECISION } from \"./PRECISION\";\r\n\r\nexport class Vector\r\n{\r\n    constructor (elements)\r\n    {\r\n        this.setElements(elements);\r\n    }\r\n\r\n    e (i)\r\n    {\r\n        return (i < 1 || i > this.elements.length) ? null : this.elements[i-1];\r\n    }\r\n\r\n    dimensions ()\r\n    {\r\n        return this.elements.length;\r\n    }\r\n\r\n    modulus ()\r\n    {\r\n        return Math.sqrt(this.dot(this));\r\n    }\r\n\r\n    eql (vector)\r\n    {\r\n        var n = this.elements.length;\r\n        var V = vector.elements || vector;\r\n        if (n !== V.length)\r\n        {\r\n            return false;\r\n        }\r\n        while (n--)\r\n        {\r\n            if (Math.abs(this.elements[n] - V[n]) > PRECISION)\r\n            {\r\n                return false;\r\n            }\r\n        }\r\n        return true;\r\n    }\r\n\r\n    dup () {\r\n        return new Vector(this.elements);\r\n    }\r\n\r\n    map (fn, context)\r\n    {\r\n        var elements = [];\r\n        this.each(function(x, i)\r\n            {\r\n                elements.push(fn.call(context, x, i));\r\n            });\r\n        return new Vector(elements);\r\n    }\r\n\r\n    forEach (fn, context)\r\n    {\r\n        var n = this.elements.length;\r\n        for (var i = 0; i < n; i++)\r\n        {\r\n            fn.call(context, this.elements[i], i+1);\r\n        }\r\n    }\r\n\r\n    toUnitVector ()\r\n    {\r\n        var r = this.modulus();\r\n        if (r === 0)\r\n        {\r\n            return this.dup();\r\n        }\r\n        return this.map(function(x)\r\n            {\r\n                return x/r;\r\n            });\r\n    }\r\n\r\n    angleFrom (vector)\r\n    {\r\n        var V = vector.elements || vector;\r\n        var n = this.elements.length, k = n, i;\r\n        if (n !== V.length)\r\n        {\r\n            return null;\r\n        }\r\n        var dot = 0, mod1 = 0, mod2 = 0;\r\n        // Work things out in parallel to save time\r\n        this.each(function(x, i)\r\n            {\r\n                dot += x * V[i-1];\r\n                mod1 += x * x;\r\n                mod2 += V[i-1] * V[i-1];\r\n            });\r\n        mod1 = Math.sqrt(mod1); mod2 = Math.sqrt(mod2);\r\n        if (mod1*mod2 === 0)\r\n        {\r\n            return null;\r\n        }\r\n        var theta = dot / (mod1*mod2);\r\n        if (theta < -1)\r\n        {\r\n            theta = -1;\r\n        }\r\n        if (theta > 1)\r\n        {\r\n            theta = 1;\r\n        }\r\n        return Math.acos(theta);\r\n    }\r\n\r\n    isParallelTo (vector)\r\n    {\r\n        var angle = this.angleFrom(vector);\r\n        return (angle === null) ? null : (angle <= PRECISION);\r\n    }\r\n\r\n    isAntiparallelTo (vector)\r\n    {\r\n        var angle = this.angleFrom(vector);\r\n        return (angle === null) ? null : (Math.abs(angle - Math.PI) <= PRECISION);\r\n    }\r\n\r\n    isPerpendicularTo (vector)\r\n    {\r\n        var dot = this.dot(vector);\r\n        return (dot === null) ? null : (Math.abs(dot) <= PRECISION);\r\n    }\r\n\r\n    add (vector)\r\n    {\r\n        var V = vector.elements || vector;\r\n        if (this.elements.length !== V.length)\r\n        {\r\n            return null;\r\n        }\r\n        return this.map(function(x, i) { return x + V[i-1]; });\r\n    }\r\n\r\n    subtract (vector)\r\n    {\r\n        var V = vector.elements || vector;\r\n        if (this.elements.length !== V.length)\r\n        {\r\n            return null;\r\n        }\r\n        return this.map(function(x, i)\r\n            {\r\n                return x - V[i-1];\r\n            });\r\n    }\r\n\r\n    multiply (k)\r\n    {\r\n        return this.map(function(x)\r\n            {\r\n                return x*k;\r\n            });\r\n    }\r\n\r\n    dot (vector)\r\n    {\r\n        var V = vector.elements || vector;\r\n        var i, product = 0, n = this.elements.length;\r\n        if (n !== V.length)\r\n        {\r\n            return null;\r\n        }\r\n        while (n--)\r\n        {\r\n            product += this.elements[n] * V[n];\r\n        }\r\n        return product;\r\n    }\r\n\r\n    cross (vector)\r\n    {\r\n        var B = vector.elements || vector;\r\n        if (this.elements.length !== 3 || B.length !== 3)\r\n        {\r\n            return null;\r\n        }\r\n        var A = this.elements;\r\n        return new Vector([\r\n            (A[1] * B[2]) - (A[2] * B[1]),\r\n            (A[2] * B[0]) - (A[0] * B[2]),\r\n            (A[0] * B[1]) - (A[1] * B[0])\r\n        ]);\r\n    }\r\n\r\n    max ()\r\n    {\r\n        var m = 0, i = this.elements.length;\r\n        while (i--)\r\n        {\r\n            if (Math.abs(this.elements[i]) > Math.abs(m))\r\n            {\r\n                m = this.elements[i];\r\n            }\r\n        }\r\n        return m;\r\n    }\r\n\r\n    indexOf (x)\r\n    {\r\n        var index = null, n = this.elements.length;\r\n        for (var i = 0; i < n; i++)\r\n        {\r\n            if (index === null && this.elements[i] === x)\r\n            {\r\n                index = i + 1;\r\n            }\r\n        }\r\n        return index;\r\n    }\r\n\r\n    toDiagonalMatrix ()\r\n    {\r\n        return Matrix.Diagonal(this.elements);\r\n    }\r\n\r\n    round ()\r\n    {\r\n        return this.map(function(x)\r\n            {\r\n                return Math.round(x);\r\n            });\r\n    }\r\n\r\n    snapTo (x)\r\n    {\r\n        return this.map(function(y)\r\n            {\r\n                return (Math.abs(y - x) <= PRECISION) ? x : y;\r\n            });\r\n    }\r\n\r\n    distanceFrom (obj)\r\n    {\r\n        if (obj.anchor || (obj.start && obj.end))\r\n        {\r\n            return obj.distanceFrom(this);\r\n        }\r\n        var V = obj.elements || obj;\r\n        if (V.length !== this.elements.length)\r\n        {\r\n            return null;\r\n        }\r\n        var sum = 0, part;\r\n        this.each(function(x, i)\r\n            {\r\n                part = x - V[i-1];\r\n                sum += part * part;\r\n            });\r\n        return Math.sqrt(sum);\r\n    }\r\n\r\n    liesOn (line)\r\n    {\r\n        return line.contains(this);\r\n    }\r\n\r\n    liesIn (plane)\r\n    {\r\n        return plane.contains(this);\r\n    }\r\n\r\n    rotate (t, obj)\r\n    {\r\n        var V, R = null, x, y, z;\r\n        if (t.determinant)\r\n        {\r\n            R = t.elements;\r\n        }\r\n        switch (this.elements.length)\r\n        {\r\n            case 2:\r\n            {\r\n                V = obj.elements || obj;\r\n                if (V.length !== 2)\r\n                {\r\n                    return null;\r\n                }\r\n                if (!R)\r\n                {\r\n                    R = Matrix.Rotation(t).elements;\r\n                }\r\n                x = this.elements[0] - V[0];\r\n                y = this.elements[1] - V[1];\r\n                return new Vector([\r\n                    V[0] + R[0][0] * x + R[0][1] * y,\r\n                    V[1] + R[1][0] * x + R[1][1] * y\r\n                ]);\r\n                break;\r\n            }\r\n            case 3:\r\n            {\r\n                if (!obj.direction)\r\n                {\r\n                    return null;\r\n                }\r\n                var C = obj.pointClosestTo(this).elements;\r\n                if (!R)\r\n                {\r\n                    R = Matrix.Rotation(t, obj.direction).elements;\r\n                }\r\n                x = this.elements[0] - C[0];\r\n                y = this.elements[1] - C[1];\r\n                z = this.elements[2] - C[2];\r\n                return new Vector([\r\n                    C[0] + R[0][0] * x + R[0][1] * y + R[0][2] * z,\r\n                    C[1] + R[1][0] * x + R[1][1] * y + R[1][2] * z,\r\n                    C[2] + R[2][0] * x + R[2][1] * y + R[2][2] * z\r\n                ]);\r\n                break;\r\n            }\r\n            default:\r\n            {\r\n                return null;\r\n            }\r\n        }\r\n    }\r\n\r\n    reflectionIn (obj)\r\n    {\r\n        if (obj.anchor)\r\n        {\r\n            // obj is a plane or line\r\n            var P = this.elements.slice();\r\n            var C = obj.pointClosestTo(P).elements;\r\n            return new Vector([C[0] + (C[0] - P[0]), C[1] + (C[1] - P[1]), C[2] + (C[2] - (P[2] || 0))]);\r\n        }\r\n        else\r\n        {\r\n            // obj is a point\r\n            var Q = obj.elements || obj;\r\n            if (this.elements.length !== Q.length)\r\n            {\r\n                return null;\r\n            }\r\n            return this.map(function(x, i) { return Q[i-1] + (Q[i-1] - x); });\r\n        }\r\n    }\r\n\r\n    to3D ()\r\n    {\r\n        var V = this.dup();\r\n        switch (V.elements.length)\r\n        {\r\n            case 3:\r\n            {\r\n                break;\r\n            }\r\n            case 2:\r\n            {\r\n                V.elements.push(0);\r\n                break;\r\n            }\r\n            default:\r\n            {\r\n                return null;\r\n            }\r\n        }\r\n        return V;\r\n    }\r\n\r\n    inspect ()\r\n    {\r\n        return '[' + this.elements.join(', ') + ']';\r\n    }\r\n\r\n    setElements (els)\r\n    {\r\n        this.elements = (els.elements || els).slice();\r\n        return this;\r\n    }\r\n\r\n    //From glUtils.js\r\n    flatten ()\r\n    {\r\n        return this.elements;\r\n    }\r\n}\r\n\r\nVector.Random = function(n)\r\n{\r\n    var elements = [];\r\n    while (n--)\r\n    {\r\n        elements.push(Math.random());\r\n    }\r\n    return new Vector(elements);\r\n};\r\n\r\nVector.Zero = function(n)\r\n{\r\n    var elements = [];\r\n    while (n--)\r\n    {\r\n        elements.push(0);\r\n    }\r\n    return new Vector(elements);\r\n};\r\n\r\nVector.prototype.x = Vector.prototype.multiply;\r\nVector.prototype.each = Vector.prototype.forEach;\r\n\r\nVector.i = new Vector([1,0,0]);\r\nVector.j = new Vector([0,1,0]);\r\nVector.k = new Vector([0,0,1]);","import { Vector } from 'sylvester-es6/src/Vector';\r\n\r\nconst computeCentroids = (config, position, row) => {\r\n  const centroids = [];\r\n\r\n  const p = Object.keys(config.dimensions);\r\n  const cols = p.length;\r\n  const a = 0.5; // center between axes\r\n  for (let i = 0; i < cols; ++i) {\r\n    // centroids on 'real' axes\r\n    const x = position(p[i]);\r\n    const y = config.dimensions[p[i]].yscale(row[p[i]]);\r\n    centroids.push(new Vector([x, y]));\r\n\r\n    // centroids on 'virtual' axes\r\n    if (i < cols - 1) {\r\n      const cx = x + a * (position(p[i + 1]) - x);\r\n      let cy = y + a * (config.dimensions[p[i + 1]].yscale(row[p[i + 1]]) - y);\r\n      if (config.bundleDimension !== null) {\r\n        const leftCentroid = config.clusterCentroids\r\n          .get(\r\n            config.dimensions[config.bundleDimension].yscale(\r\n              row[config.bundleDimension]\r\n            )\r\n          )\r\n          .get(p[i]);\r\n        const rightCentroid = config.clusterCentroids\r\n          .get(\r\n            config.dimensions[config.bundleDimension].yscale(\r\n              row[config.bundleDimension]\r\n            )\r\n          )\r\n          .get(p[i + 1]);\r\n        let centroid = 0.5 * (leftCentroid + rightCentroid);\r\n        cy = centroid + (1 - config.bundlingStrength) * (cy - centroid);\r\n      }\r\n      centroids.push(new Vector([cx, cy]));\r\n    }\r\n  }\r\n\r\n  return centroids;\r\n};\r\n\r\nexport default computeCentroids;\r\n","import { Vector } from 'sylvester-es6/src/Vector';\r\n\r\nconst computeControlPoints = (smoothness, centroids) => {\r\n  const cols = centroids.length;\r\n  const a = smoothness;\r\n  const cps = [];\r\n\r\n  cps.push(centroids[0]);\r\n  cps.push(\r\n    new Vector([\r\n      centroids[0].e(1) + a * 2 * (centroids[1].e(1) - centroids[0].e(1)),\r\n      centroids[0].e(2),\r\n    ])\r\n  );\r\n  for (let col = 1; col < cols - 1; ++col) {\r\n    let mid = centroids[col];\r\n    let left = centroids[col - 1];\r\n    let right = centroids[col + 1];\r\n\r\n    let diff = left.subtract(right);\r\n    cps.push(mid.add(diff.x(a)));\r\n    cps.push(mid);\r\n    cps.push(mid.subtract(diff.x(a)));\r\n  }\r\n\r\n  cps.push(\r\n    new Vector([\r\n      centroids[cols - 1].e(1) +\r\n        a * 2 * (centroids[cols - 2].e(1) - centroids[cols - 1].e(1)),\r\n      centroids[cols - 1].e(2),\r\n    ])\r\n  );\r\n  cps.push(centroids[cols - 1]);\r\n\r\n  return cps;\r\n};\r\n\r\nexport default computeControlPoints;\r\n","// draw single cubic bezier curve\r\nimport computeCentroids from './computeCentroids';\r\nimport computeControlPoints from './computeControlPoints';\r\nimport h from './height';\r\n\r\nconst singleCurve = (config, position, d, ctx) => {\r\n  const centroids = computeCentroids(config, position, d);\r\n  const cps = computeControlPoints(config.smoothness, centroids);\r\n\r\n  ctx.moveTo(cps[0].e(1), cps[0].e(2));\r\n\r\n  for (let i = 1; i < cps.length; i += 3) {\r\n    if (config.showControlPoints) {\r\n      for (let j = 0; j < 3; j++) {\r\n        ctx.fillRect(cps[i + j].e(1), cps[i + j].e(2), 2, 2);\r\n      }\r\n    }\r\n    ctx.bezierCurveTo(\r\n      cps[i].e(1),\r\n      cps[i].e(2),\r\n      cps[i + 1].e(1),\r\n      cps[i + 1].e(2),\r\n      cps[i + 2].e(1),\r\n      cps[i + 2].e(2)\r\n    );\r\n  }\r\n};\r\n\r\n// returns the y-position just beyond the separating null value line\r\nconst getNullPosition = config => {\r\n  if (config.nullValueSeparator === 'bottom') {\r\n    return h(config) + 1;\r\n  } else if (config.nullValueSeparator === 'top') {\r\n    return 1;\r\n  } else {\r\n    console.log(\r\n      \"A value is NULL, but nullValueSeparator is not set; set it to 'bottom' or 'top'.\"\r\n    );\r\n  }\r\n  return h(config) + 1;\r\n};\r\n\r\nconst singlePath = (config, position, d, ctx) => {\r\n  Object.keys(config.dimensions)\r\n    .map(p => [\r\n      position(p),\r\n      d[p] === undefined\r\n        ? getNullPosition(config)\r\n        : config.dimensions[p].yscale(d[p]),\r\n    ])\r\n    .sort((a, b) => a[0] - b[0])\r\n    .forEach((p, i) => {\r\n      i === 0 ? ctx.moveTo(p[0], p[1]) : ctx.lineTo(p[0], p[1]);\r\n    });\r\n};\r\n\r\n// draw single polyline\r\nconst colorPath = (config, position, d, ctx) => {\r\n  ctx.beginPath();\r\n  if (\r\n    (config.bundleDimension !== null && config.bundlingStrength > 0) ||\r\n    config.smoothness > 0\r\n  ) {\r\n    singleCurve(config, position, d, ctx);\r\n  } else {\r\n    singlePath(config, position, d, ctx);\r\n  }\r\n  ctx.stroke();\r\n};\r\n\r\nexport default colorPath;\r\n","const _functor = v => (typeof v === 'function' ? v : () => v);\r\n\r\nexport default _functor;\r\n","import colorPath from '../util/colorPath';\r\nimport functor from '../util/functor';\r\n\r\nconst pathMark = (config, ctx, position) => (d, i) => {\r\n  ctx.marked.strokeStyle = functor(config.color)(d, i);\r\n  return colorPath(config, position, d, ctx.marked);\r\n};\r\n\r\nconst renderMarkedDefault = (config, pc, ctx, position) => () => {\r\n  pc.clear('marked');\r\n\r\n  if (config.marked.length) {\r\n    config.marked.forEach(pathMark(config, ctx, position));\r\n  }\r\n};\r\n\r\nconst renderMarkedQueue = (config, markedQueue) => () => {\r\n  if (config.marked) {\r\n    markedQueue(config.marked);\r\n  } else {\r\n    markedQueue([]); // This is needed to clear the currently marked items\r\n  }\r\n};\r\n\r\nconst renderMarked = (config, pc, events) =>\r\n  function() {\r\n    if (!Object.keys(config.dimensions).length) pc.detectDimensions();\r\n\r\n    pc.renderMarked[config.mode]();\r\n    events.call('render', this);\r\n    return this;\r\n  };\r\n\r\nexport { pathMark, renderMarked, renderMarkedDefault, renderMarkedQueue };\r\n","import isBrushed from '../util/isBrushed';\r\nimport colorPath from '../util/colorPath';\r\nimport functor from '../util/functor';\r\n\r\nconst pathBrushed = (config, ctx, position) => (d, i) => {\r\n  if (config.brushedColor !== null) {\r\n    ctx.brushed.strokeStyle = functor(config.brushedColor)(d, i);\r\n  } else {\r\n    ctx.brushed.strokeStyle = functor(config.color)(d, i);\r\n  }\r\n  return colorPath(config, position, d, ctx.brushed);\r\n};\r\n\r\nconst renderBrushedDefault = (config, ctx, position, pc, brushGroup) => () => {\r\n  pc.clear('brushed');\r\n\r\n  if (isBrushed(config, brushGroup) && config.brushed !== false) {\r\n    config.brushed.forEach(pathBrushed(config, ctx, position));\r\n  }\r\n};\r\n\r\nconst renderBrushedQueue = (config, brushGroup, brushedQueue) => () => {\r\n  if (isBrushed(config, brushGroup)) {\r\n    brushedQueue(config.brushed);\r\n  } else {\r\n    brushedQueue([]); // This is needed to clear the currently brushed items\r\n  }\r\n};\r\n\r\nconst renderBrushed = (config, pc, events) =>\r\n  function() {\r\n    if (!Object.keys(config.dimensions).length) pc.detectDimensions();\r\n\r\n    pc.renderBrushed[config.mode]();\r\n    events.call('render', this);\r\n    return this;\r\n  };\r\n\r\nexport { pathBrushed, renderBrushed, renderBrushedDefault, renderBrushedQueue };\r\n","import { select } from 'd3-selection';\r\n\r\nconst brushReset = (config, pc) =>\r\n  function(dimension) {\r\n    const brushesToKeep = [];\r\n    for (let j = 0; j < config.brushes.length; j++) {\r\n      if (config.brushes[j].data !== dimension) {\r\n        brushesToKeep.push(config.brushes[j]);\r\n      }\r\n    }\r\n\r\n    config.brushes = brushesToKeep;\r\n    config.brushed = false;\r\n\r\n    if (pc.g() !== undefined) {\r\n      const nodes = pc\r\n        .g()\r\n        .selectAll('.brush')\r\n        .nodes();\r\n      for (let i = 0; i < nodes.length; i++) {\r\n        if (nodes[i].__data__ === dimension) {\r\n          // remove all dummy brushes for this axis or the real brush\r\n          select(select(nodes[i]).nodes()[0].parentNode)\r\n            .selectAll('.dummy')\r\n            .remove();\r\n          config.dimensions[dimension].brush.move(select(nodes[i], null));\r\n        }\r\n      }\r\n    }\r\n\r\n    return this;\r\n  };\r\n\r\nexport default brushReset;\r\n","// a better \"typeof\" from this post: http://stackoverflow.com/questions/7390426/better-way-to-get-type-of-a-javascript-variable\r\nconst toType = v => {\r\n  return {}.toString\r\n    .call(v)\r\n    .match(/\\s([a-zA-Z]+)/)[1]\r\n    .toLowerCase();\r\n};\r\n\r\nexport default toType;\r\n","// this descriptive text should live with other introspective methods\r\nconst toString = config => () =>\r\n  'Parallel Coordinates: ' +\r\n  Object.keys(config.dimensions).length +\r\n  ' dimensions (' +\r\n  Object.keys(config.data[0]).length +\r\n  ' total) , ' +\r\n  config.data.length +\r\n  ' rows';\r\n\r\nexport default toString;\r\n","// pairs of adjacent dimensions\r\nconst adjacentPairs = arr => {\r\n  let ret = [];\r\n  for (let i = 0; i < arr.length - 1; i++) {\r\n    ret.push([arr[i], arr[i + 1]]);\r\n  }\r\n  return ret;\r\n};\r\n\r\nexport default adjacentPairs;\r\n","import { selectAll } from 'd3-selection';\r\n\r\nimport colorPath from '../util/colorPath';\r\nimport functor from '../util/functor';\r\n\r\nconst pathHighlight = (config, ctx, position) => (d, i) => {\r\n  ctx.highlight.strokeStyle = functor(config.color)(d, i);\r\n  return colorPath(config, position, d, ctx.highlight);\r\n};\r\n\r\n// highlight an array of data\r\nconst highlight = (config, pc, canvas, events, ctx, position) =>\r\n  function(data = null) {\r\n    if (data === null) {\r\n      return config.highlighted;\r\n    }\r\n\r\n    config.highlighted = data;\r\n    pc.clear('highlight');\r\n    selectAll([canvas.foreground, canvas.brushed]).classed('faded', true);\r\n    data.forEach(pathHighlight(config, ctx, position));\r\n    events.call('highlight', this, data);\r\n    return this;\r\n  };\r\n\r\nexport default highlight;\r\n","import { selectAll } from 'd3-selection';\r\n\r\n// clear highlighting\r\nconst unhighlight = (config, pc, canvas) =>\r\n  function() {\r\n    config.highlighted = [];\r\n    pc.clear('highlight');\r\n    selectAll([canvas.foreground, canvas.brushed]).classed('faded', false);\r\n    return this;\r\n  };\r\n\r\nexport default unhighlight;\r\n","import { selectAll } from 'd3-selection';\r\n\r\nimport { pathMark } from './renderMarked';\r\n\r\n// mark an array of data\r\nconst mark = (config, pc, canvas, events, ctx, position) =>\r\n  function(data = null) {\r\n    if (data === null) {\r\n      return config.marked;\r\n    }\r\n\r\n    // add array to already marked data\r\n    config.marked = config.marked.concat(data);\r\n    selectAll([canvas.foreground, canvas.brushed]).classed('dimmed', true);\r\n    data.forEach(pathMark(config, ctx, position));\r\n    events.call('mark', this, data);\r\n    return this;\r\n  };\r\n\r\nexport default mark;\r\n","import { selectAll } from 'd3-selection';\r\n\r\n// clear marked data arrays\r\nconst unmark = (config, pc, canvas) =>\r\n  function() {\r\n    config.marked = [];\r\n    pc.clear('marked');\r\n    selectAll([canvas.foreground, canvas.brushed]).classed('dimmed', false);\r\n    return this;\r\n  };\r\n\r\nexport default unmark;\r\n","const removeAxes = pc =>\r\n  function() {\r\n    pc._g.remove();\r\n\r\n    delete pc._g;\r\n    return this;\r\n  };\r\n\r\nexport default removeAxes;\r\n","/**\r\n * Renders the polylines.\r\n * If no dimensions have been specified, it will attempt to detect quantitative\r\n * dimensions based on the first data entry. If scales haven't been set, it will\r\n * autoscale based on the extent for each dimension.\r\n *\r\n * @param config\r\n * @param pc\r\n * @param events\r\n * @returns {Function}\r\n */\r\nconst render = (config, pc, events) =>\r\n  function() {\r\n    // try to autodetect dimensions and create scales\r\n    if (!Object.keys(config.dimensions).length) {\r\n      pc.detectDimensions();\r\n    }\r\n    pc.autoscale();\r\n\r\n    pc.render[config.mode]();\r\n\r\n    events.call('render', this);\r\n    return this;\r\n  };\r\n\r\nexport default render;\r\n","import colorPath from '../util/colorPath';\r\nimport functor from '../util/functor';\r\n\r\nconst pathForeground = (config, ctx, position) => (d, i) => {\r\n  ctx.foreground.strokeStyle = functor(config.color)(d, i);\r\n  return colorPath(config, position, d, ctx.foreground);\r\n};\r\n\r\nconst renderDefault = (config, pc, ctx, position) => () => {\r\n  pc.clear('foreground');\r\n  pc.clear('highlight');\r\n\r\n  pc.renderBrushed.default();\r\n  pc.renderMarked.default();\r\n\r\n  config.data.forEach(pathForeground(config, ctx, position));\r\n};\r\n\r\nconst renderDefaultQueue = (config, pc, foregroundQueue) => () => {\r\n  pc.renderBrushed.queue();\r\n  pc.renderMarked.queue();\r\n  foregroundQueue(config.data);\r\n};\r\n\r\nexport default renderDefault;\r\n\r\nexport { pathForeground, renderDefaultQueue };\r\n","import toType from './toType';\r\n\r\n// try to coerce to number before returning type\r\nconst toTypeCoerceNumbers = v =>\r\n  parseFloat(v) == v && v !== null ? 'number' : toType(v);\r\n\r\nexport default toTypeCoerceNumbers;\r\n","import toTypeCoerceNumbers from './toTypeCoerceNumbers';\r\n\r\n// attempt to determine types of each dimension based on first row of data\r\nconst detectDimensionTypes = data =>\r\n  Object.keys(data[0]).reduce((acc, cur) => {\r\n    const key = isNaN(Number(cur)) ? cur : parseInt(cur);\r\n    acc[key] = toTypeCoerceNumbers(data[0][cur]);\r\n\r\n    return acc;\r\n  }, {});\r\n\r\nexport default detectDimensionTypes;\r\n","import { ascending } from 'd3-array';\r\n\r\nconst getOrderedDimensionKeys = config => () =>\r\n  Object.keys(config.dimensions).sort((x, y) =>\r\n    ascending(config.dimensions[x].index, config.dimensions[y].index)\r\n  );\r\n\r\nexport default getOrderedDimensionKeys;\r\n","const interactive = flags =>\r\n  function() {\r\n    flags.interactive = true;\r\n    return this;\r\n  };\r\n\r\nexport default interactive;\r\n","const shadows = (flags, pc) =>\r\n  function() {\r\n    flags.shadows = true;\r\n    pc.alphaOnBrushed(0.1);\r\n    pc.render();\r\n    return this;\r\n  };\r\n\r\nexport default shadows;\r\n","import { select } from 'd3-selection';\r\n\r\n/**\r\n * Setup a new parallel coordinates chart.\r\n *\r\n * @param config\r\n * @param canvas\r\n * @param ctx\r\n * @returns {pc} a parcoords closure\r\n */\r\nconst init = (config, canvas, ctx) => {\r\n  /**\r\n   * Create the chart within a container. The selector can also be a d3 selection.\r\n   *\r\n   * @param selection a d3 selection\r\n   * @returns {pc} instance for chained api\r\n   */\r\n  const pc = function(selection) {\r\n    selection = pc.selection = select(selection);\r\n\r\n    config.width = selection.node().clientWidth;\r\n    config.height = selection.node().clientHeight;\r\n    // canvas data layers\r\n    ['dots', 'foreground', 'brushed', 'marked', 'highlight'].forEach(layer => {\r\n      canvas[layer] = selection\r\n        .append('canvas')\r\n        .attr('class', layer)\r\n        .node();\r\n      ctx[layer] = canvas[layer].getContext('2d');\r\n    });\r\n\r\n    // svg tick and brush layers\r\n    pc.svg = selection\r\n      .append('svg')\r\n      .attr('width', config.width)\r\n      .attr('height', config.height)\r\n      .style('font', '14px sans-serif')\r\n      .style('position', 'absolute')\r\n\r\n      .append('svg:g')\r\n      .attr(\r\n        'transform',\r\n        'translate(' + config.margin.left + ',' + config.margin.top + ')'\r\n      );\r\n    // for chained api\r\n    return pc;\r\n  };\r\n\r\n  // for partial-application style programming\r\n  return pc;\r\n};\r\n\r\nexport default init;\r\n","const flip = config =>\r\n  function(d) {\r\n    //__.dimensions[d].yscale.domain().reverse();                               // does not work\r\n    config.dimensions[d].yscale.domain(\r\n      config.dimensions[d].yscale.domain().reverse()\r\n    ); // works\r\n\r\n    return this;\r\n  };\r\n\r\nexport default flip;\r\n","const detectDimensions = pc =>\r\n  function() {\r\n    pc.dimensions(pc.applyDimensionDefaults());\r\n    return this;\r\n  };\r\n\r\nexport default detectDimensions;\r\n","const scale = (config, pc) =>\r\n  function(d, domain) {\r\n    config.dimensions[d].yscale.domain(domain);\r\n    pc.render.default();\r\n    pc.updateAxes();\r\n\r\n    return this;\r\n  };\r\n\r\nexport default scale;\r\n","const DefaultConfig = {\r\n  data: [],\r\n  highlighted: [],\r\n  marked: [],\r\n  dimensions: {},\r\n  dimensionTitleRotation: 0,\r\n  brushes: [],\r\n  brushed: false,\r\n  brushedColor: null,\r\n  alphaOnBrushed: 0.0,\r\n  lineWidth: 1.4,\r\n  highlightedLineWidth: 3,\r\n  mode: 'default',\r\n  markedLineWidth: 3,\r\n  markedShadowColor: '#ffffff',\r\n  markedShadowBlur: 10,\r\n  rate: 20,\r\n  width: 600,\r\n  height: 300,\r\n  margin: { top: 24, right: 20, bottom: 12, left: 20 },\r\n  nullValueSeparator: 'undefined', // set to \"top\" or \"bottom\"\r\n  nullValueSeparatorPadding: { top: 8, right: 0, bottom: 8, left: 0 },\r\n  color: '#069',\r\n  composite: 'source-over',\r\n  alpha: 0.7,\r\n  bundlingStrength: 0.5,\r\n  bundleDimension: null,\r\n  smoothness: 0.0,\r\n  showControlPoints: false,\r\n  hideAxis: [],\r\n  flipAxes: [],\r\n  animationTime: 1100, // How long it takes to flip the axis when you double click\r\n  rotateLabels: false,\r\n};\r\n\r\nexport default DefaultConfig;\r\n","import { entries, keys } from 'd3-collection';\r\nimport { axisLeft } from 'd3-axis';\r\nimport { dispatch } from 'd3-dispatch';\r\nimport { scalePoint } from 'd3-scale';\r\n\r\nimport DefaultConfig from './defaultConfig';\r\n\r\nconst initState = userConfig => {\r\n  const config = Object.assign({}, DefaultConfig, userConfig);\r\n\r\n  if (userConfig && userConfig.dimensionTitles) {\r\n    console.warn(\r\n      'dimensionTitles passed in userConfig is deprecated. Add title to dimension object.'\r\n    );\r\n    entries(userConfig.dimensionTitles).forEach(d => {\r\n      if (config.dimensions[d.key]) {\r\n        config.dimensions[d.key].title = config.dimensions[d.key].title\r\n          ? config.dimensions[d.key].title\r\n          : d.value;\r\n      } else {\r\n        config.dimensions[d.key] = {\r\n          title: d.value,\r\n        };\r\n      }\r\n    });\r\n  }\r\n\r\n  const eventTypes = [\r\n    'render',\r\n    'resize',\r\n    'highlight',\r\n    'mark',\r\n    'brush',\r\n    'brushend',\r\n    'brushstart',\r\n    'axesreorder',\r\n  ].concat(keys(config));\r\n\r\n  const events = dispatch.apply(this, eventTypes),\r\n    flags = {\r\n      brushable: false,\r\n      reorderable: false,\r\n      axes: false,\r\n      interactive: false,\r\n      debug: false,\r\n    },\r\n    xscale = scalePoint(),\r\n    dragging = {},\r\n    axis = axisLeft().ticks(5),\r\n    ctx = {},\r\n    canvas = {};\r\n\r\n  const brush = {\r\n    modes: {\r\n      None: {\r\n        install: function(pc) {}, // Nothing to be done.\r\n        uninstall: function(pc) {}, // Nothing to be done.\r\n        selected: function() {\r\n          return [];\r\n        }, // Nothing to return\r\n        brushState: function() {\r\n          return {};\r\n        },\r\n      },\r\n    },\r\n    mode: 'None',\r\n    predicate: 'AND',\r\n    currentMode: function() {\r\n      return this.modes[this.mode];\r\n    },\r\n  };\r\n\r\n  return {\r\n    config,\r\n    events,\r\n    eventTypes,\r\n    flags,\r\n    xscale,\r\n    dragging,\r\n    axis,\r\n    ctx,\r\n    canvas,\r\n    brush,\r\n  };\r\n};\r\n\r\nexport default initState;\r\n","const computeClusterCentroids = (config, d) => {\r\n  const clusterCentroids = new Map();\r\n  const clusterCounts = new Map();\r\n  // determine clusterCounts\r\n  config.data.forEach(function(row) {\r\n    let scaled = config.dimensions[d].yscale(row[d]);\r\n    if (!clusterCounts.has(scaled)) {\r\n      clusterCounts.set(scaled, 0);\r\n    }\r\n    let count = clusterCounts.get(scaled);\r\n    clusterCounts.set(scaled, count + 1);\r\n  });\r\n\r\n  config.data.forEach(function(row) {\r\n    Object.keys(config.dimensions).map(p => {\r\n      let scaled = config.dimensions[d].yscale(row[d]);\r\n      if (!clusterCentroids.has(scaled)) {\r\n        const _map = new Map();\r\n        clusterCentroids.set(scaled, _map);\r\n      }\r\n      if (!clusterCentroids.get(scaled).has(p)) {\r\n        clusterCentroids.get(scaled).set(p, 0);\r\n      }\r\n      let value = clusterCentroids.get(scaled).get(p);\r\n      value += config.dimensions[p].yscale(row[p]) / clusterCounts.get(scaled);\r\n      clusterCentroids.get(scaled).set(p, value);\r\n    });\r\n  });\r\n\r\n  return clusterCentroids;\r\n};\r\n\r\nexport default computeClusterCentroids;\r\n","// side effects for setters\r\nimport { dispatch } from 'd3-dispatch';\r\nimport computeClusterCentroids from '../util/computeClusterCentroids';\r\nimport flipAxisAndUpdatePCP from '../util/flipAxisAndUpdatePCP';\r\n\r\nconst without = (arr, items) => {\r\n  items.forEach(el => {\r\n    delete arr[el];\r\n  });\r\n  return arr;\r\n};\r\n\r\nconst sideEffects = (\r\n  config,\r\n  ctx,\r\n  pc,\r\n  xscale,\r\n  axis,\r\n  flags,\r\n  brushedQueue,\r\n  markedQueue,\r\n  foregroundQueue\r\n) =>\r\n  dispatch\r\n    .apply(this, Object.keys(config))\r\n    .on('composite', d => {\r\n      ctx.foreground.globalCompositeOperation = d.value;\r\n      ctx.brushed.globalCompositeOperation = d.value;\r\n    })\r\n    .on('alpha', d => {\r\n      ctx.foreground.globalAlpha = d.value;\r\n      ctx.brushed.globalAlpha = d.value;\r\n    })\r\n    .on('brushedColor', d => {\r\n      ctx.brushed.strokeStyle = d.value;\r\n    })\r\n    .on('width', d => pc.resize())\r\n    .on('height', d => pc.resize())\r\n    .on('margin', d => pc.resize())\r\n    .on('rate', d => {\r\n      brushedQueue.rate(d.value);\r\n      markedQueue.rate(d.value);\r\n      foregroundQueue.rate(d.value);\r\n    })\r\n    .on('dimensions', d => {\r\n      config.dimensions = pc.applyDimensionDefaults(Object.keys(d.value));\r\n      xscale.domain(pc.getOrderedDimensionKeys());\r\n      pc.sortDimensions();\r\n      if (flags.interactive) {\r\n        pc.render().updateAxes();\r\n      }\r\n    })\r\n    .on('bundleDimension', d => {\r\n      if (!Object.keys(config.dimensions).length) pc.detectDimensions();\r\n      pc.autoscale();\r\n      if (typeof d.value === 'number') {\r\n        if (d.value < Object.keys(config.dimensions).length) {\r\n          config.bundleDimension = config.dimensions[d.value];\r\n        } else if (d.value < config.hideAxis.length) {\r\n          config.bundleDimension = config.hideAxis[d.value];\r\n        }\r\n      } else {\r\n        config.bundleDimension = d.value;\r\n      }\r\n\r\n      config.clusterCentroids = computeClusterCentroids(\r\n        config,\r\n        config.bundleDimension\r\n      );\r\n      if (flags.interactive) {\r\n        pc.render();\r\n      }\r\n    })\r\n    .on('hideAxis', d => {\r\n      pc.brushReset();\r\n      pc.dimensions(pc.applyDimensionDefaults());\r\n      pc.dimensions(without(config.dimensions, d.value));\r\n      pc.render();\r\n    })\r\n    .on('flipAxes', d => {\r\n      if (d.value && d.value.length) {\r\n        d.value.forEach(function(dimension) {\r\n          flipAxisAndUpdatePCP(config, pc, axis)(dimension);\r\n        });\r\n        pc.updateAxes(0);\r\n      }\r\n    });\r\n\r\nexport default sideEffects;\r\n","const getset = (obj, state, events, side_effects) => {\r\n  Object.keys(state).forEach(function(key) {\r\n    obj[key] = function(x) {\r\n      if (!arguments.length) {\r\n        return state[key];\r\n      }\r\n      if (\r\n        key === 'dimensions' &&\r\n        Object.prototype.toString.call(x) === '[object Array]'\r\n      ) {\r\n        console.warn('pc.dimensions([]) is deprecated, use pc.dimensions({})');\r\n        x = obj.applyDimensionDefaults(x);\r\n      }\r\n      let old = state[key];\r\n      state[key] = x;\r\n      side_effects.call(key, obj, { value: x, previous: old });\r\n      events.call(key, obj, { value: x, previous: old });\r\n      return obj;\r\n    };\r\n  });\r\n};\r\n\r\nexport default getset;\r\n","// side effects for setters\r\nimport sideEffects from './state/sideEffects';\r\nimport getset from './util/getset';\r\n\r\nconst d3_rebind = (target, source, method) =>\r\n  function() {\r\n    const value = method.apply(source, arguments);\r\n    return value === source ? target : value;\r\n  };\r\n\r\nconst _rebind = (target, source, method) => {\r\n  target[method] = d3_rebind(target, source, source[method]);\r\n  return target;\r\n};\r\n\r\nconst bindEvents = (\r\n  __,\r\n  ctx,\r\n  pc,\r\n  xscale,\r\n  flags,\r\n  brushedQueue,\r\n  markedQueue,\r\n  foregroundQueue,\r\n  events,\r\n  axis\r\n) => {\r\n  const side_effects = sideEffects(\r\n    __,\r\n    ctx,\r\n    pc,\r\n    xscale,\r\n    axis,\r\n    flags,\r\n    brushedQueue,\r\n    markedQueue,\r\n    foregroundQueue\r\n  );\r\n\r\n  // create getter/setters\r\n  getset(pc, __, events, side_effects);\r\n\r\n  // expose events\r\n  // getter/setter with event firing\r\n  _rebind(pc, events, 'on');\r\n\r\n  _rebind(\r\n    pc,\r\n    axis,\r\n    'ticks',\r\n    'orient',\r\n    'tickValues',\r\n    'tickSubdivide',\r\n    'tickSize',\r\n    'tickPadding',\r\n    'tickFormat'\r\n  );\r\n};\r\n\r\nexport default bindEvents;\r\n","// misc\r\nimport renderQueue from './util/renderQueue';\r\nimport w from './util/width';\r\n\r\n// brush\r\nimport install1DAxes from './brush/1d';\r\nimport install1DAxesMulti from './brush/1d-multi';\r\nimport install2DStrums from './brush/strums';\r\nimport installAngularBrush from './brush/angular';\r\n\r\n// api\r\nimport intersection from './api/intersection';\r\nimport mergeParcoords from './api/mergeParcoords';\r\nimport selected from './api/selected';\r\nimport brushMode from './api/brushMode';\r\nimport updateAxes from './api/updateAxes';\r\nimport autoscale from './api/autoscale';\r\nimport brushable from './api/brushable';\r\nimport commonScale from './api/commonScale';\r\nimport computeRealCentroids from './api/computeRealCentroids';\r\nimport applyDimensionDefaults from './api/applyDimensionDefaults';\r\nimport createAxes from './api/createAxes';\r\nimport axisDots from './api/axisDots';\r\nimport applyAxisConfig from './api/applyAxisConfig';\r\nimport reorderable from './api/reorderable';\r\nimport resize from './api/resize';\r\nimport reorder from './api/reorder';\r\nimport sortDimensions from './api/sortDimensions';\r\nimport sortDimensionsByRowData from './api/sortDimensionsByRowData';\r\nimport clear from './api/clear';\r\nimport {\r\n  pathMark,\r\n  renderMarked,\r\n  renderMarkedDefault,\r\n  renderMarkedQueue,\r\n} from './api/renderMarked';\r\nimport {\r\n  pathBrushed,\r\n  renderBrushed,\r\n  renderBrushedDefault,\r\n  renderBrushedQueue,\r\n} from './api/renderBrushed';\r\nimport brushReset from './api/brushReset';\r\nimport toType from './api/toType';\r\nimport toString from './api/toString';\r\nimport adjacentPairs from './api/adjacentPairs';\r\nimport highlight from './api/highlight';\r\nimport unhighlight from './api/unhighlight';\r\nimport mark from './api/mark';\r\nimport unmark from './api/unmark';\r\nimport removeAxes from './api/removeAxes';\r\nimport render from './api/render';\r\nimport renderDefault, {\r\n  pathForeground,\r\n  renderDefaultQueue,\r\n} from './api/renderDefault';\r\nimport toTypeCoerceNumbers from './api/toTypeCoerceNumbers';\r\nimport detectDimensionTypes from './api/detectDimensionTypes';\r\nimport getOrderedDimensionKeys from './api/getOrderedDimensionKeys';\r\nimport interactive from './api/interactive';\r\nimport shadows from './api/shadows';\r\nimport init from './api/init';\r\nimport flip from './api/flip';\r\nimport detectDimensions from './api/detectDimensions';\r\nimport scale from './api/scale';\r\n\r\nimport { version } from '../package.json';\r\nimport initState from './state';\r\nimport bindEvents from './bindEvents';\r\n\r\n//css\r\nimport './parallel-coordinates.css';\r\n\r\nconst ParCoords = userConfig => {\r\n  const state = initState(userConfig);\r\n  const {\r\n    config,\r\n    events,\r\n    flags,\r\n    xscale,\r\n    dragging,\r\n    axis,\r\n    ctx,\r\n    canvas,\r\n    brush,\r\n  } = state;\r\n\r\n  const pc = init(config, canvas, ctx);\r\n\r\n  const position = d => {\r\n    if (xscale.range().length === 0) {\r\n      xscale.range([0, w(config)], 1);\r\n    }\r\n    return dragging[d] == null ? xscale(d) : dragging[d];\r\n  };\r\n\r\n  const brushedQueue = renderQueue(pathBrushed(config, ctx, position))\r\n    .rate(50)\r\n    .clear(() => pc.clear('brushed'));\r\n\r\n  const markedQueue = renderQueue(pathMark(config, ctx, position))\r\n    .rate(50)\r\n    .clear(() => pc.clear('marked'));\r\n\r\n  const foregroundQueue = renderQueue(pathForeground(config, ctx, position))\r\n    .rate(50)\r\n    .clear(function() {\r\n      pc.clear('foreground');\r\n      pc.clear('highlight');\r\n    });\r\n\r\n  bindEvents(\r\n    config,\r\n    ctx,\r\n    pc,\r\n    xscale,\r\n    flags,\r\n    brushedQueue,\r\n    markedQueue,\r\n    foregroundQueue,\r\n    events,\r\n    axis\r\n  );\r\n\r\n  // expose the state of the chart\r\n  pc.state = config;\r\n  pc.flags = flags;\r\n\r\n  pc.autoscale = autoscale(config, pc, xscale, ctx);\r\n  pc.scale = scale(config, pc);\r\n  pc.flip = flip(config);\r\n  pc.commonScale = commonScale(config, pc);\r\n  pc.detectDimensions = detectDimensions(pc);\r\n  // attempt to determine types of each dimension based on first row of data\r\n  pc.detectDimensionTypes = detectDimensionTypes;\r\n  pc.applyDimensionDefaults = applyDimensionDefaults(config, pc);\r\n  pc.getOrderedDimensionKeys = getOrderedDimensionKeys(config);\r\n\r\n  //Renders the polylines.\r\n  pc.render = render(config, pc, events);\r\n  pc.renderBrushed = renderBrushed(config, pc, events);\r\n  pc.renderMarked = renderMarked(config, pc, events);\r\n  pc.render.default = renderDefault(config, pc, ctx, position);\r\n  pc.render.queue = renderDefaultQueue(config, pc, foregroundQueue);\r\n  pc.renderBrushed.default = renderBrushedDefault(\r\n    config,\r\n    ctx,\r\n    position,\r\n    pc,\r\n    brush\r\n  );\r\n  pc.renderBrushed.queue = renderBrushedQueue(config, brush, brushedQueue);\r\n  pc.renderMarked.default = renderMarkedDefault(config, pc, ctx, position);\r\n  pc.renderMarked.queue = renderMarkedQueue(config, markedQueue);\r\n\r\n  pc.compute_real_centroids = computeRealCentroids(config, position);\r\n  pc.shadows = shadows(flags, pc);\r\n  pc.axisDots = axisDots(config, pc, position);\r\n  pc.clear = clear(config, pc, ctx, brush);\r\n  pc.createAxes = createAxes(config, pc, xscale, flags, axis);\r\n  pc.removeAxes = removeAxes(pc);\r\n  pc.updateAxes = updateAxes(config, pc, position, axis, flags);\r\n  pc.applyAxisConfig = applyAxisConfig;\r\n  pc.brushable = brushable(config, pc, flags);\r\n  pc.brushReset = brushReset(config, pc);\r\n  pc.selected = selected(config, pc);\r\n  pc.reorderable = reorderable(config, pc, xscale, position, dragging, flags);\r\n\r\n  // Reorder dimensions, such that the highest value (visually) is on the left and\r\n  // the lowest on the right. Visual values are determined by the data values in\r\n  // the given row.\r\n  pc.reorder = reorder(config, pc, xscale);\r\n  pc.sortDimensionsByRowData = sortDimensionsByRowData(config);\r\n  pc.sortDimensions = sortDimensions(config, position);\r\n\r\n  // pairs of adjacent dimensions\r\n  pc.adjacent_pairs = adjacentPairs;\r\n  pc.interactive = interactive(flags);\r\n\r\n  // expose internal state\r\n  pc.xscale = xscale;\r\n  pc.ctx = ctx;\r\n  pc.canvas = canvas;\r\n  pc.g = () => pc._g;\r\n\r\n  // rescale for height, width and margins\r\n  // TODO currently assumes chart is brushable, and destroys old brushes\r\n  pc.resize = resize(config, pc, flags, events);\r\n\r\n  // highlight an array of data\r\n  pc.highlight = highlight(config, pc, canvas, events, ctx, position);\r\n  // clear highlighting\r\n  pc.unhighlight = unhighlight(config, pc, canvas);\r\n\r\n  // mark an array of data\r\n  pc.mark = mark(config, pc, canvas, events, ctx, position);\r\n  // clear marked data\r\n  pc.unmark = unmark(config, pc, canvas);\r\n\r\n  // calculate 2d intersection of line a->b with line c->d\r\n  // points are objects with x and y properties\r\n  pc.intersection = intersection;\r\n\r\n  // Merges the canvases and SVG elements into one canvas element which is then passed into the callback\r\n  // (so you can choose to save it to disk, etc.)\r\n  pc.mergeParcoords = mergeParcoords(pc);\r\n  pc.brushModes = () => Object.getOwnPropertyNames(brush.modes);\r\n  pc.brushMode = brushMode(brush, config, pc);\r\n\r\n  // install brushes\r\n  install1DAxes(brush, config, pc, events);\r\n  install2DStrums(brush, config, pc, events, xscale);\r\n  installAngularBrush(brush, config, pc, events, xscale);\r\n  install1DAxesMulti(brush, config, pc, events);\r\n\r\n  pc.version = version;\r\n  // this descriptive text should live with other introspective methods\r\n  pc.toString = toString(config);\r\n  pc.toType = toType;\r\n  // try to coerce to number before returning type\r\n  pc.toTypeCoerceNumbers = toTypeCoerceNumbers;\r\n\r\n  return pc;\r\n};\r\n\r\nexport default ParCoords;\r\n"],"names":["renderQueue","func","_queue","_rate","_invalidate","_clear","rq","data","render","valid","invalidate","doFrame","chunk","splice","map","requestAnimationFrame","slice","add","concat","rate","value","arguments","length","remaining","clear","w","config","width","margin","right","left","invertCategorical","selection","scale","domain","range","found","forEach","d","i","push","invertByScale","invert","brushExtents","state","pc","extents","type","brushes","brushNodes","Object","keys","dimensions","reduce","acc","cur","brush","undefined","brushSelection","raw","yScale","yscale","scaled","extent","brushSelections","g","selectAll","each","select","call","move","dim","yExtent","reverse","renderBrushed","brushReset","dimension","brushed","event","selected","brushGroup","is_brushed","p","actives","filter","_brushRange","within","date","bandwidth","number","string","predicate","every","some","Error","brushPredicate","brushUpdated","events","args","newSelection","brushFor","axis","_selector","hasOwnProperty","brushRangeMax","_brush","brushY","convertBrushArguments","args_array","Array","prototype","node","on","sourceEvent","stopPropagation","install","createAxes","append","attr","style","uninstall","remove","install1DAxes","modes","brushState","drawBrushes","selector","id","enter","insert","indexOf","b","brushObject","exit","pos","axisBrushes","document","getElementById","hideAxis","includes","dimExt","e","newBrush","lastBrushID","lastBrush","toString","hiddenAxes","yExtents","_bs","j","ext","f","k","axisBrush","_this","install1DMultiAxes","strumRect","containmentTest","strum","p1","minX","p2","m1","b1","m2","b2","x","y","y1","y2","Math","min","max","crossesStrum","strums","test","d1","dims","d2","point","ids","getOwnPropertyNames","isNaN","crossTest","removeStrum","active","svg","onDragEnd","drawStrum","activePoint","_svg","points","_line","circles","_drag","drag","ev","maxX","minY","maxY","onDrag","top","h","height","bottom","dimensionsForPoint","xscale","getOrderedDimensionKeys","onDragStart","mouse","consecutive","first","second","install2DStrums","hypothenuse","a","sqrt","signedAngle","angle","PI","startAngle","arc","endAngle","tmp","arcs","c","asin","outerRadius","p3","_path","d3Arc","innerRadius","sAngle","uAngle","installAngularBrush","intersection","mergeParcoords","devicePixelRatio","window","mergedCanvas","createElement","foregroundCanvas","canvas","foreground","canvasMarginLeft","Number","marginLeft","replace","textTopAdjust","canvasMarginTop","marginTop","clientWidth","clientHeight","context","getContext","fillStyle","fillRect","key","drawImage","DOMURL","URL","webkitURL","serializer","XMLSerializer","svgNodeCopy","cloneNode","setAttribute","getAttribute","svgStr","serializeToString","src","btoa","img","Image","onload","callback","ranges","nodes","__data__","values","ranger","flipAxes","unshift","ii","dimRange","dimDomain","category","categoryIndex","categoryRangeValue","multiBrushData","idx","filtered","z","String","toUpperCase","currentMode","brushMode","mode","brushModes","dimensionLabels","title","flipAxisAndUpdatePCP","flip","transition","duration","animationTime","rotateLabels","delta","deltaY","dimensionTitleRotation","preventDefault","updateAxes","position","flags","g_data","axisElement","applyAxisConfig","text","brushable","reorderable","getRange","nullValueSeparator","nullValueSeparatorPadding","autoscale","ctx","defaultScales","_extent","getTime","scalePoint","tempDate","val","scaleTime","scaleLinear","counts","sort","tempArr","pop","categoricalRange","addBy","scaleOrdinal","padding","strokeStyle","color","lineWidth","globalCompositeOperation","composite","globalAlpha","alpha","brushedColor","highlight","highlightedLineWidth","marked","markedLineWidth","shadowColor","markedShadowColor","shadowBlur","markedShadowBlur","ctrlKey","html","outerHTML","dat","parentNode","commonScale","global","t","detectDimensions","scales","bundleDimension","computeRealCentroids","row","isValid","applyDimensionDefaults","types","detectDimensionTypes","orient","ticks","innerTickSize","outerTickSize","tickPadding","index","removeAxes","_g","axes","axisDots","r","_r","dots","pow","entries","beginPath","stroke","fill","axisCfg","axisLeft","axisRight","axisTop","axisBottom","tickValues","tickSizeInner","tickSizeOuter","tickFormat","dragging","__origin__","dx","sortDimensions","renderMarked","resize","reorder","firstDim","sortDimensionsByRowData","rowdata","reordered","highlighted","unhighlight","unmark","mark","copy","assign","positionSortedKeys","pixelDifference","localeCompare","isBrushed","object","layer","clearRect","alphaOnBrushed","PRECISION","Matrix","elements","setElements","Vector","col","n","cols","rows","matrix","M","nj","abs","fn","els","isSameSizeAs","returnVector","modulus","canMultiplyFromLeft","sum","ni","m","isSquare","dup","np","multiplier","toRightTriangular","det","determinant","tr","rank","T","isSingular","augment","I","divisor","inverse_elements","new_element","round","matrix_rows","inspect","join","result","Diagonal","Rotation","theta","cos","sin","mod","s","RotationX","RotationY","RotationZ","Random","Zero","random","Translation","v","toUpperTriangular","trace","rk","inv","inverse","multiply","dot","vector","V","mod1","mod2","acos","angleFrom","product","B","A","obj","anchor","start","end","distanceFrom","part","line","contains","plane","R","direction","C","pointClosestTo","P","Q","computeCentroids","centroids","cx","cy","leftCentroid","clusterCentroids","get","rightCentroid","centroid","bundlingStrength","computeControlPoints","smoothness","cps","mid","diff","subtract","singleCurve","moveTo","showControlPoints","bezierCurveTo","getNullPosition","console","log","singlePath","lineTo","colorPath","_functor","pathMark","functor","renderMarkedDefault","renderMarkedQueue","markedQueue","pathBrushed","renderBrushedDefault","renderBrushedQueue","brushedQueue","brushesToKeep","toType","match","toLowerCase","adjacentPairs","ret","arr","pathHighlight","classed","pathForeground","renderDefault","default","renderDefaultQueue","foregroundQueue","queue","toTypeCoerceNumbers","parseFloat","parseInt","ascending","interactive","shadows","init","DefaultConfig","initState","userConfig","dimensionTitles","warn","eventTypes","dispatch","apply","debug","None","computeClusterCentroids","Map","clusterCounts","has","set","count","_map","without","items","el","sideEffects","getset","side_effects","old","previous","d3_rebind","target","source","method","_rebind","bindEvents","__","ParCoords","compute_real_centroids","adjacent_pairs","install1DAxesMulti","version"],"mappings":";;;;;;EAEA,IAAMA,cAAc,SAAdA,WAAc,CAASC,IAAT,EAAe;EACjC,MAAIC,SAAS,EAAb;EAAA;EACEC,UAAQ,IADV;EAAA;EAEEC,gBAAc,uBAAW,EAF3B;EAAA;EAGEC,WAAS,kBAAW,EAHtB,CADiC;;EAMjC,MAAIC,KAAK,SAALA,EAAK,CAASC,IAAT,EAAe;EACtB,QAAIA,IAAJ,EAAUD,GAAGC,IAAH,CAAQA,IAAR;EACVH;EACAC;EACAC,OAAGE,MAAH;EACD,GALD;;EAOAF,KAAGE,MAAH,GAAY,YAAW;EACrB,QAAIC,QAAQ,IAAZ;EACAL,kBAAcE,GAAGI,UAAH,GAAgB,YAAW;EACvCD,cAAQ,KAAR;EACD,KAFD;;EAIA,aAASE,OAAT,GAAmB;EACjB,UAAI,CAACF,KAAL,EAAY,OAAO,IAAP;EACZ,UAAIG,QAAQV,OAAOW,MAAP,CAAc,CAAd,EAAiBV,KAAjB,CAAZ;EACAS,YAAME,GAAN,CAAUb,IAAV;EACAc,4BAAsBJ,OAAtB;EACD;;EAEDA;EACD,GAdD;;EAgBAL,KAAGC,IAAH,GAAU,UAASA,IAAT,EAAe;EACvBH;EACAF,aAASK,KAAKS,KAAL,CAAW,CAAX,CAAT,CAFuB;EAGvB,WAAOV,EAAP;EACD,GAJD;;EAMAA,KAAGW,GAAH,GAAS,UAASV,IAAT,EAAe;EACtBL,aAASA,OAAOgB,MAAP,CAAcX,IAAd,CAAT;EACD,GAFD;;EAIAD,KAAGa,IAAH,GAAU,UAASC,KAAT,EAAgB;EACxB,QAAI,CAACC,UAAUC,MAAf,EAAuB,OAAOnB,KAAP;EACvBA,YAAQiB,KAAR;EACA,WAAOd,EAAP;EACD,GAJD;;EAMAA,KAAGiB,SAAH,GAAe,YAAW;EACxB,WAAOrB,OAAOoB,MAAd;EACD,GAFD;;EAIA;EACAhB,KAAGkB,KAAH,GAAW,UAASvB,IAAT,EAAe;EACxB,QAAI,CAACoB,UAAUC,MAAf,EAAuB;EACrBjB;EACA,aAAOC,EAAP;EACD;EACDD,aAASJ,IAAT;EACA,WAAOK,EAAP;EACD,GAPD;;EASAA,KAAGI,UAAH,GAAgBN,WAAhB;;EAEA,SAAOE,EAAP;EACD,CA9DD;;ECFA,IAAMmB,IAAI,SAAJA,CAAI;EAAA,SAAUC,OAAOC,KAAP,GAAeD,OAAOE,MAAP,CAAcC,KAA7B,GAAqCH,OAAOE,MAAP,CAAcE,IAA7D;EAAA,CAAV;;ECAA,IAAMC,oBAAoB,SAApBA,iBAAoB,CAACC,SAAD,EAAYC,KAAZ,EAAsB;EAC9C,MAAID,UAAUV,MAAV,KAAqB,CAAzB,EAA4B;EAC1B,WAAO,EAAP;EACD;EACD,MAAMY,SAASD,MAAMC,MAAN,EAAf;EACA,MAAMC,QAAQF,MAAME,KAAN,EAAd;EACA,MAAMC,QAAQ,EAAd;EACAD,QAAME,OAAN,CAAc,UAACC,CAAD,EAAIC,CAAJ,EAAU;EACtB,QAAID,KAAKN,UAAU,CAAV,CAAL,IAAqBM,KAAKN,UAAU,CAAV,CAA9B,EAA4C;EAC1CI,YAAMI,IAAN,CAAWN,OAAOK,CAAP,CAAX;EACD;EACF,GAJD;EAKA,SAAOH,KAAP;EACD,CAbD;;EAeA,IAAMK,gBAAgB,SAAhBA,aAAgB,CAACT,SAAD,EAAYC,KAAZ,EAAsB;EAC1C,MAAIA,UAAU,IAAd,EAAoB,OAAO,EAAP;EACpB,SAAO,OAAOA,MAAMS,MAAb,KAAwB,WAAxB,GACHX,kBAAkBC,SAAlB,EAA6BC,KAA7B,CADG,GAEHD,UAAUlB,GAAV,CAAc;EAAA,WAAKmB,MAAMS,MAAN,CAAaJ,CAAb,CAAL;EAAA,GAAd,CAFJ;EAGD,CALD;;ECVA,IAAMK,eAAe,SAAfA,YAAe,CAACC,KAAD,EAAQlB,MAAR,EAAgBmB,EAAhB;EAAA,WAAuB,UAACC,OAAD,EAA8B;EAAA,YAApBC,IAAoB,uEAAb,QAAa;EAAA,YAC9DC,OAD8D,GACtCJ,KADsC,CAC9DI,OAD8D;EAAA,YACrDC,UADqD,GACtCL,KADsC,CACrDK,UADqD;;;EAGtE,YAAI,OAAOH,OAAP,KAAmB,WAAvB,EAAoC;EAChC,mBAAOI,OAAOC,IAAP,CAAYzB,OAAO0B,UAAnB,EAA+BC,MAA/B,CAAsC,UAACC,GAAD,EAAMC,GAAN,EAAc;EACvD,oBAAMC,QAAQR,QAAQO,GAAR,CAAd;EACA;EACA,oBAAIC,UAAUC,SAAV,IAAuBC,uBAAeT,WAAWM,GAAX,CAAf,MAAoC,IAA/D,EAAqE;EACjE,wBAAMI,MAAMD,uBAAeT,WAAWM,GAAX,CAAf,CAAZ;EACA,wBAAMK,SAASlC,OAAO0B,UAAP,CAAkBG,GAAlB,EAAuBM,MAAtC;EACA,wBAAMC,SAASrB,cAAckB,GAAd,EAAmBC,MAAnB,CAAf;;EAEAN,wBAAIC,GAAJ,IAAW;EACPQ,gCAAQP,MAAMO,MAAN,EADD;EAEP/B,mCAAW;EACP2B,oCADO;EAEPG;EAFO;EAFJ,qBAAX;EAOH;;EAED,uBAAOR,GAAP;EACH,aAlBM,EAkBJ,EAlBI,CAAP;EAmBH,SApBD,MAoBO;EACH;EACA,gBAAMU,kBAAkB,EAAxB;EACAnB,eAAGoB,CAAH,GACKC,SADL,CACe,QADf,EAEKC,IAFL,CAEU,UAAS7B,CAAT,EAAY;EACd0B,gCAAgB1B,CAAhB,IAAqB8B,mBAAO,IAAP,CAArB;EACH,aAJL;;EAMA;EACAlB,mBAAOC,IAAP,CAAYzB,OAAO0B,UAAnB,EAA+Bf,OAA/B,CAAuC,aAAK;EACxC,oBAAIS,QAAQR,CAAR,MAAemB,SAAnB,EAA8B;EAC1B;EACH;;EAED,oBAAMD,QAAQR,QAAQV,CAAR,CAAd;EACA,oBAAIkB,UAAUC,SAAd,EAAyB;;EAErB,wBAAIV,SAAS,KAAb,EAAoB;EAChBiB,wCAAgB1B,CAAhB,EAAmB+B,IAAnB,CAAwBb,KAAxB,EAA+Ba,IAA/B,CAAoCb,MAAMc,IAA1C,EAAgDxB,QAAQR,CAAR,CAAhD;EACH,qBAFD,MAEO;EACH,4BAAMiC,MAAM7C,OAAO0B,UAAP,CAAkBd,CAAlB,CAAZ;EACA,4BAAMkC,UAAU1B,QAAQR,CAAR,EAAWxB,GAAX,CAAeyD,IAAIV,MAAnB,CAAhB;;EAEA;EACA;EACA;EACA;EACA;EACA;;EAEA;EACA;EACA;EACAG,wCAAgB1B,CAAhB,EAAmB+B,IAAnB,CAAwBb,KAAxB,EAA+Ba,IAA/B,CAAoCb,MAAMc,IAA1C,EAAgDE,QAAQC,OAAR,EAAhD;;EAEA;EACA;EACH;EAEJ;EACJ,aA/BD;;EAiCA;EACA5B,eAAG6B,aAAH;;EAEA,mBAAO7B,EAAP;EACH;EACJ,KAvEoB;EAAA,CAArB;;;;ECHA,IAAM8B,aAAa,SAAbA,UAAa,CAAC/B,KAAD,EAAQlB,MAAR,EAAgBmB,EAAhB;EAAA,SAAuB,qBAAa;EAAA,QAC7CG,OAD6C,GACjCJ,KADiC,CAC7CI,OAD6C;;;EAGrD,QAAI4B,cAAcnB,SAAlB,EAA6B;EAC3B/B,aAAOmD,OAAP,GAAiB,KAAjB;EACA,UAAIhC,GAAGoB,CAAH,OAAWR,SAAX,IAAwBZ,GAAGoB,CAAH,OAAW,IAAvC,EAA6C;EAC3CpB,WAAGoB,CAAH,GACGC,SADH,CACa,QADb,EAEGC,IAFH,CAEQ,UAAS7B,CAAT,EAAY;EAChB,cAAIU,QAAQV,CAAR,MAAemB,SAAnB,EAA8B;EAC5BW,+BAAO,IAAP,EAAaC,IAAb,CAAkBrB,QAAQV,CAAR,EAAWgC,IAA7B,EAAmC,IAAnC;EACD;EACF,SANH;EAOAzB,WAAG6B,aAAH;EACD;EACF,KAZD,MAYO;EACLhD,aAAOmD,OAAP,GAAiB,KAAjB;EACA,UAAIhC,GAAGoB,CAAH,OAAWR,SAAX,IAAwBZ,GAAGoB,CAAH,OAAW,IAAvC,EAA6C;EAC3CpB,WAAGoB,CAAH,GACGC,SADH,CACa,QADb,EAEGC,IAFH,CAEQ,UAAS7B,CAAT,EAAY;EAChB,cAAIA,MAAMsC,SAAV,EAAqB;EACrBR,6BAAO,IAAP,EAAaC,IAAb,CAAkBrB,QAAQV,CAAR,EAAWgC,IAA7B,EAAmC,IAAnC;EACA,cAAI,OAAOtB,QAAQV,CAAR,EAAWS,IAAlB,KAA2B,UAA/B,EAA2C;EACzCC,oBAAQV,CAAR,EAAWwC,KAAX,CAAiBV,mBAAO,IAAP,CAAjB;EACD;EACF,SARH;EASAvB,WAAG6B,aAAH;EACD;EACF;EACD,WAAO,KAAP;EACD,GA/BkB;EAAA,CAAnB;;ECDA;;EAEA;EACA,IAAMK,WAAW,SAAXA,QAAW,CAACnC,KAAD,EAAQlB,MAAR,EAAgBsD,UAAhB;EAAA,SAA+B,YAAM;EAAA,QAC5C/B,UAD4C,GAC7BL,KAD6B,CAC5CK,UAD4C;;EAEpD,QAAMgC,aAAa,SAAbA,UAAa;EAAA,aACjBhC,WAAWiC,CAAX,KAAiBxB,uBAAeT,WAAWiC,CAAX,CAAf,MAAkC,IADlC;EAAA,KAAnB;;EAGA,QAAMC,UAAUjC,OAAOC,IAAP,CAAYzB,OAAO0B,UAAnB,EAA+BgC,MAA/B,CAAsCH,UAAtC,CAAhB;EACA,QAAMnC,UAAUqC,QAAQrE,GAAR,CAAY,aAAK;EAC/B,UAAMuE,cAAc3B,uBAAeT,WAAWiC,CAAX,CAAf,CAApB;;EAEA,UAAI,OAAOxD,OAAO0B,UAAP,CAAkB8B,CAAlB,EAAqBrB,MAArB,CAA4BnB,MAAnC,KAA8C,UAAlD,EAA8D;EAC5D,eAAO,CACLhB,OAAO0B,UAAP,CAAkB8B,CAAlB,EAAqBrB,MAArB,CAA4BnB,MAA5B,CAAmC2C,YAAY,CAAZ,CAAnC,CADK,EAEL3D,OAAO0B,UAAP,CAAkB8B,CAAlB,EAAqBrB,MAArB,CAA4BnB,MAA5B,CAAmC2C,YAAY,CAAZ,CAAnC,CAFK,CAAP;EAID,OALD,MAKO;EACL,eAAOA,WAAP;EACD;EACF,KAXe,CAAhB;EAYA;EACA;EACA;EACA;;EAEA;EACA,QAAIF,QAAQ7D,MAAR,KAAmB,CAAvB,EAA0B,OAAOI,OAAOnB,IAAd;;EAE1B;EACA,QAAM+E,SAAS;EACbC,YAAM,cAACjD,CAAD,EAAI4C,CAAJ,EAAON,SAAP,EAAqB;EACzB,YAAI,OAAOlD,OAAO0B,UAAP,CAAkB8B,CAAlB,EAAqBrB,MAArB,CAA4B2B,SAAnC,KAAiD,UAArD,EAAiE;EAC/D;EACA,iBACE1C,QAAQ8B,SAAR,EAAmB,CAAnB,KAAyBlD,OAAO0B,UAAP,CAAkB8B,CAAlB,EAAqBrB,MAArB,CAA4BvB,EAAE4C,CAAF,CAA5B,CAAzB,IACAxD,OAAO0B,UAAP,CAAkB8B,CAAlB,EAAqBrB,MAArB,CAA4BvB,EAAE4C,CAAF,CAA5B,KAAqCpC,QAAQ8B,SAAR,EAAmB,CAAnB,CAFvC;EAID,SAND,MAMO;EACL,iBAAO9B,QAAQ8B,SAAR,EAAmB,CAAnB,KAAyBtC,EAAE4C,CAAF,CAAzB,IAAiC5C,EAAE4C,CAAF,KAAQpC,QAAQ8B,SAAR,EAAmB,CAAnB,CAAhD;EACD;EACF,OAXY;EAYba,cAAQ,gBAACnD,CAAD,EAAI4C,CAAJ,EAAON,SAAP,EAAqB;EAC3B,YAAI,OAAOlD,OAAO0B,UAAP,CAAkB8B,CAAlB,EAAqBrB,MAArB,CAA4B2B,SAAnC,KAAiD,UAArD,EAAiE;EAC/D;EACA,iBACE1C,QAAQ8B,SAAR,EAAmB,CAAnB,KAAyBlD,OAAO0B,UAAP,CAAkB8B,CAAlB,EAAqBrB,MAArB,CAA4BvB,EAAE4C,CAAF,CAA5B,CAAzB,IACAxD,OAAO0B,UAAP,CAAkB8B,CAAlB,EAAqBrB,MAArB,CAA4BvB,EAAE4C,CAAF,CAA5B,KAAqCpC,QAAQ8B,SAAR,EAAmB,CAAnB,CAFvC;EAID,SAND,MAMO;EACL,iBAAO9B,QAAQ8B,SAAR,EAAmB,CAAnB,KAAyBtC,EAAE4C,CAAF,CAAzB,IAAiC5C,EAAE4C,CAAF,KAAQpC,QAAQ8B,SAAR,EAAmB,CAAnB,CAAhD;EACD;EACF,OAtBY;EAuBbc,cAAQ,gBAACpD,CAAD,EAAI4C,CAAJ,EAAON,SAAP,EAAqB;EAC3B,eACE9B,QAAQ8B,SAAR,EAAmB,CAAnB,KAAyBlD,OAAO0B,UAAP,CAAkB8B,CAAlB,EAAqBrB,MAArB,CAA4BvB,EAAE4C,CAAF,CAA5B,CAAzB,IACAxD,OAAO0B,UAAP,CAAkB8B,CAAlB,EAAqBrB,MAArB,CAA4BvB,EAAE4C,CAAF,CAA5B,KAAqCpC,QAAQ8B,SAAR,EAAmB,CAAnB,CAFvC;EAID;EA5BY,KAAf;;EA+BA,WAAOlD,OAAOnB,IAAP,CAAY6E,MAAZ,CAAmB,aAAK;EAC7B,cAAQJ,WAAWW,SAAnB;EACE,aAAK,KAAL;EACE,iBAAOR,QAAQS,KAAR,CAAc,UAASV,CAAT,EAAYN,SAAZ,EAAuB;EAC1C,mBAAOU,OAAO5D,OAAO0B,UAAP,CAAkB8B,CAAlB,EAAqBnC,IAA5B,EAAkCT,CAAlC,EAAqC4C,CAArC,EAAwCN,SAAxC,CAAP;EACD,WAFM,CAAP;EAGF,aAAK,IAAL;EACE,iBAAOO,QAAQU,IAAR,CAAa,UAASX,CAAT,EAAYN,SAAZ,EAAuB;EACzC,mBAAOU,OAAO5D,OAAO0B,UAAP,CAAkB8B,CAAlB,EAAqBnC,IAA5B,EAAkCT,CAAlC,EAAqC4C,CAArC,EAAwCN,SAAxC,CAAP;EACD,WAFM,CAAP;EAGF;EACE,gBAAM,IAAIkB,KAAJ,CAAU,6BAA6BpE,OAAOqE,cAA9C,CAAN;EAVJ;EAYD,KAbM,CAAP;EAcD,GAxEgB;EAAA,CAAjB;;ECCA,IAAMC,eAAe,SAAfA,YAAe,CAACtE,MAAD,EAASmB,EAAT,EAAaoD,MAAb,EAAqBC,IAArB;EAAA,SAA8B,wBAAgB;EACjExE,WAAOmD,OAAP,GAAiBsB,YAAjB;EACAF,WAAO5B,IAAP,CAAY,OAAZ,EAAqBxB,EAArB,EAAyBnB,OAAOmD,OAAhC,EAAyCqB,IAAzC;EACArD,OAAG6B,aAAH;EACD,GAJoB;EAAA,CAArB;;EAMA,IAAM0B,WAAW,SAAXA,QAAW,CAACxD,KAAD,EAAQlB,MAAR,EAAgBmB,EAAhB,EAAoBoD,MAApB,EAA4BjB,UAA5B;EAAA,SAA2C,UAC1DqB,IAD0D,EAE1DC,SAF0D,EAGvD;EACH;EACA,QAAI,CAAC5E,OAAO0B,UAAP,CAAkBmD,cAAlB,CAAiCF,IAAjC,CAAL,EAA6C;EAC3C,aAAO,YAAM,EAAb;EACD;;EAED,QAAMG,gBACJ9E,OAAO0B,UAAP,CAAkBiD,IAAlB,EAAwBtD,IAAxB,KAAiC,QAAjC,GACIrB,OAAO0B,UAAP,CAAkBiD,IAAlB,EAAwBxC,MAAxB,CAA+B1B,KAA/B,GACET,OAAO0B,UAAP,CAAkBiD,IAAlB,EAAwBxC,MAAxB,CAA+B1B,KAA/B,GAAuCb,MAAvC,GAAgD,CADlD,CADJ,GAIII,OAAO0B,UAAP,CAAkBiD,IAAlB,EAAwBxC,MAAxB,CAA+B1B,KAA/B,GAAuC,CAAvC,CALN;;EAOA,QAAMsE,SAASC,eAAOJ,SAAP,EAAkBvC,MAAlB,CAAyB,CAAC,CAAC,CAAC,EAAF,EAAM,CAAN,CAAD,EAAW,CAAC,EAAD,EAAKyC,aAAL,CAAX,CAAzB,CAAf;;EAEA,QAAMG,wBAAwB,SAAxBA,qBAAwB,OAAQ;EACpC,UAAMC,aAAaC,MAAMC,SAAN,CAAgB9F,KAAhB,CAAsBqD,IAAtB,CAA2B6B,IAA3B,CAAnB;EACA,UAAMG,OAAOO,WAAW,CAAX,CAAb;;EAEA,UAAMjD,MAAMD,uBAAekD,WAAW,CAAX,EAAc,CAAd,CAAf,KAAoC,EAAhD;;EAEA;EACA,UAAI/C,SAAS,IAAb;EACA,UAAInC,OAAO0B,UAAP,CAAkBmD,cAAlB,CAAiCF,IAAjC,CAAJ,EAA4C;EAC1CxC,iBAASnC,OAAO0B,UAAP,CAAkBiD,IAAlB,EAAwBxC,MAAjC;EACD;;EAED;EACA,UAAMC,SAASrB,cAAckB,GAAd,EAAmBE,MAAnB,CAAf;;EAEA,aAAO;EACLwC,cAAMO,WAAW,CAAX,CADD;EAELG,cAAMH,WAAW,CAAX,EAAc,CAAd,CAFD;EAGL5E,mBAAW;EACT2B,kBADS;EAETG;EAFS;EAHN,OAAP;EAQD,KAvBD;;EAyBA2C,WACGO,EADH,CACM,OADN,EACe,YAAW;EACtB,UAAIlC,kBAAMmC,WAAN,KAAsB,IAA1B,EAAgC;EAC9BhB,eAAO5B,IAAP,CACE,YADF,EAEExB,EAFF,EAGEnB,OAAOmD,OAHT,EAIE8B,sBAAsBtF,SAAtB,CAJF;EAMA,YAAI,OAAOyD,kBAAMmC,WAAN,CAAkBC,eAAzB,KAA6C,UAAjD,EAA6D;EAC3DpC,4BAAMmC,WAAN,CAAkBC,eAAlB;EACD;EACF;EACF,KAbH,EAcGF,EAdH,CAcM,OAdN,EAce,YAAW;EACtBhB,mBACEtE,MADF,EAEEmB,EAFF,EAGEoD,MAHF,EAIEU,sBAAsBtF,SAAtB,CAJF,EAKE0D,SAASnC,KAAT,EAAgBlB,MAAhB,EAAwBsD,UAAxB,GALF;EAMD,KArBH,EAsBGgC,EAtBH,CAsBM,KAtBN,EAsBa,YAAW;EACpBhB,mBAAatE,MAAb,EAAqBmB,EAArB,EAAyBoD,MAAzB,EAAiClB,SAASnC,KAAT,EAAgBlB,MAAhB,EAAwBsD,UAAxB,GAAjC;EACAiB,aAAO5B,IAAP,CACE,UADF,EAEExB,EAFF,EAGEnB,OAAOmD,OAHT,EAIE8B,sBAAsBtF,SAAtB,CAJF;EAMD,KA9BH;;EAgCAuB,UAAMI,OAAN,CAAcqD,IAAd,IAAsBI,MAAtB;EACA7D,UAAMK,UAAN,CAAiBoD,IAAjB,IAAyBC,UAAUS,IAAV,EAAzB;;EAEA,WAAON,MAAP;EACD,GA/EgB;EAAA,CAAjB;;ECNA,IAAMU,UAAU,SAAVA,OAAU,CAACvE,KAAD,EAAQlB,MAAR,EAAgBmB,EAAhB,EAAoBoD,MAApB,EAA4BjB,UAA5B;EAAA,SAA2C,YAAM;EAC/D,QAAI,CAACnC,GAAGoB,CAAH,EAAL,EAAa;EACXpB,SAAGuE,UAAH;EACD;;EAED;EACA,QAAM5D,QAAQX,GACXoB,CADW,GAEXoD,MAFW,CAEJ,OAFI,EAGXC,IAHW,CAGN,OAHM,EAGG,OAHH,EAIXnD,IAJW,CAIN,UAAS7B,CAAT,EAAY;EAChB8B,yBAAO,IAAP,EAAaC,IAAb,CACE+B,SAASxD,KAAT,EAAgBlB,MAAhB,EAAwBmB,EAAxB,EAA4BoD,MAA5B,EAAoCjB,UAApC,EAAgD1C,CAAhD,EAAmD8B,mBAAO,IAAP,CAAnD,CADF;EAGD,KARW,CAAd;EASAZ,UACGU,SADH,CACa,MADb,EAEGqD,KAFH,CAES,YAFT,EAEuB,IAFvB,EAGGD,IAHH,CAGQ,GAHR,EAGa,CAAC,EAHd,EAIGA,IAJH,CAIQ,OAJR,EAIiB,EAJjB;;EAMA9D,UAAMU,SAAN,CAAgB,iBAAhB,EAAmCqD,KAAnC,CAAyC,MAAzC,EAAiD,aAAjD;;EAEA/D,UACGU,SADH,CACa,aADb,EAEGqD,KAFH,CAES,MAFT,EAEiB,wBAFjB,EAGGA,KAHH,CAGS,QAHT,EAGmB,iBAHnB;;EAKA/D,UAAMU,SAAN,CAAgB,cAAhB,EAAgCqD,KAAhC,CAAsC,MAAtC,EAA8C,iBAA9C;;EAEA1E,OAAGF,YAAH,GAAkBA,aAAaC,KAAb,EAAoBlB,MAApB,EAA4BmB,EAA5B,CAAlB;EACAA,OAAG8B,UAAH,GAAgBA,WAAW/B,KAAX,EAAkBlB,MAAlB,EAA0BmB,EAA1B,CAAhB;EACA,WAAOA,EAAP;EACD,GAjCe;EAAA,CAAhB;;ECLA,IAAM2E,YAAY,SAAZA,SAAY,CAAC5E,KAAD,EAAQC,EAAR;EAAA,SAAe,YAAM;EACrC,QAAIA,GAAGoB,CAAH,OAAWR,SAAX,IAAwBZ,GAAGoB,CAAH,OAAW,IAAvC,EACEpB,GAAGoB,CAAH,GACGC,SADH,CACa,QADb,EAEGuD,MAFH;;EAIF7E,UAAMI,OAAN,GAAgB,EAAhB;EACA,WAAOH,GAAGF,YAAV;EACA,WAAOE,GAAG8B,UAAV;EACD,GATiB;EAAA,CAAlB;;ECKA,IAAM+C,gBAAgB,SAAhBA,aAAgB,CAAC1C,UAAD,EAAatD,MAAb,EAAqBmB,EAArB,EAAyBoD,MAAzB,EAAoC;EACxD,MAAMrD,QAAQ;EACZI,aAAS,EADG;EAEZC,gBAAY;EAFA,GAAd;;EAKA+B,aAAW2C,KAAX,CAAiB,SAAjB,IAA8B;EAC5BR,aAASA,QAAQvE,KAAR,EAAelB,MAAf,EAAuBmB,EAAvB,EAA2BoD,MAA3B,EAAmCjB,UAAnC,CADmB;EAE5BwC,eAAWA,UAAU5E,KAAV,EAAiBC,EAAjB,CAFiB;EAG5BkC,cAAUA,SAASnC,KAAT,EAAgBlB,MAAhB,EAAwBsD,UAAxB,CAHkB;EAI5B4C,gBAAYjF,aAAaC,KAAb,EAAoBlB,MAApB,EAA4BmB,EAA5B;EAJgB,GAA9B;EAMD,CAZD;;ECHA,IAAMgF,cAAc,SAAdA,WAAc,CAAC7E,OAAD,EAAUtB,MAAV,EAAkBmB,EAAlB,EAAsBwD,IAAtB,EAA4ByB,QAA5B,EAAyC;EAC3D,MAAMpE,iBAAiBoE,SAAS5D,SAAT,CAAmB,QAAnB,EAA6B3D,IAA7B,CAAkCyC,OAAlC,EAA2C;EAAA,WAAKV,EAAEyF,EAAP;EAAA,GAA3C,CAAvB;;EAEArE,iBACGsE,KADH,GAEGC,MAFH,CAEU,GAFV,EAEe,QAFf,EAGGX,IAHH,CAGQ,OAHR,EAGiB,OAHjB,EAIGA,IAJH,CAIQ,WAJR,EAIqBjB,IAJrB,EAKGiB,IALH,CAMI,IANJ,EAOI;EAAA,WAAK,WAAWpE,OAAOC,IAAP,CAAYzB,OAAO0B,UAAnB,EAA+B8E,OAA/B,CAAuC7B,IAAvC,CAAX,GAA0D,GAA1D,GAAgE8B,EAAEJ,EAAvE;EAAA,GAPJ,EASG5D,IATH,CASQ,UAASiE,WAAT,EAAsB;EAC1BA,gBAAY5E,KAAZ,CAAkBY,mBAAO,IAAP,CAAlB;EACD,GAXH;;EAaAV,iBAAeS,IAAf,CAAoB,UAASiE,WAAT,EAAsB;EACxChE,uBAAO,IAAP,EACGkD,IADH,CACQ,OADR,EACiB,OADjB,EAEGpD,SAFH,CAEa,UAFb,EAGGqD,KAHH,CAGS,gBAHT,EAG2B,YAAW;EAClC,UAAM/D,QAAQ4E,YAAY5E,KAA1B;EACA,UAAI4E,YAAYL,EAAZ,KAAmB/E,QAAQ1B,MAAR,GAAiB,CAApC,IAAyCkC,UAAUC,SAAvD,EAAkE;EAChE,eAAO,KAAP;EACD,OAFD,MAEO;EACL,eAAO,MAAP;EACD;EACF,KAVH;EAWD,GAZD;;EAcAC,iBAAe2E,IAAf,GAAsBZ,MAAtB;EACD,CA/BD;;ECAA;EACA,IAAM1C,aAAW,SAAXA,QAAW,CAACnC,KAAD,EAAQlB,MAAR,EAAgBmB,EAAhB,EAAoBoD,MAApB,EAA4BjB,UAA5B,EAA2C;EAAA,MAClDhC,OADkD,GACtCJ,KADsC,CAClDI,OADkD;;;EAG1D,MAAMiC,aAAa,SAAbA,UAAa,CAACC,CAAD,EAAIoD,GAAJ,EAAY;EAC7B,QAAMC,cAAcvF,QAAQkC,CAAR,CAApB;;EAEA,SAAK,IAAI3C,IAAI,CAAb,EAAgBA,IAAIgG,YAAYjH,MAAhC,EAAwCiB,GAAxC,EAA6C;EAC3C,UAAMiB,QAAQgF,SAASC,cAAT,CAAwB,WAAWH,GAAX,GAAiB,GAAjB,GAAuB/F,CAA/C,CAAd;;EAEA,UAAIiB,SAASE,uBAAeF,KAAf,MAA0B,IAAvC,EAA6C;EAC3C,eAAO,IAAP;EACD;EACF;;EAED,WAAO,KAAP;EACD,GAZD;;EAcA,MAAM2B,UAAUjC,OAAOC,IAAP,CAAYzB,OAAO0B,UAAnB,EAA+BgC,MAA/B,CAAsCH,UAAtC,CAAhB;EACA,MAAMnC,UAAUqC,QAAQrE,GAAR,CAAY,aAAK;EAC/B,QAAMyH,cAAcvF,QAAQkC,CAAR,CAApB;;EAEA,WAAOqD,YACJnD,MADI,CACG;EAAA,aAAK,CAACvC,GAAG6F,QAAH,GAAcC,QAAd,CAAuBrG,CAAvB,CAAN;EAAA,KADH,EAEJxB,GAFI,CAEA,UAACwB,CAAD,EAAIC,CAAJ;EAAA,aACHmB,uBACE8E,SAASC,cAAT,CACE,WAAWvF,OAAOC,IAAP,CAAYzB,OAAO0B,UAAnB,EAA+B8E,OAA/B,CAAuChD,CAAvC,CAAX,GAAuD,GAAvD,GAA6D3C,CAD/D,CADF,CADG;EAAA,KAFA,EASJzB,GATI,CASA,UAACwB,CAAD,EAAIC,CAAJ,EAAU;EACb,UAAID,MAAM,IAAN,IAAcA,MAAMmB,SAAxB,EAAmC;EACjC,eAAO,IAAP;EACD,OAFD,MAEO,IAAI,OAAO/B,OAAO0B,UAAP,CAAkB8B,CAAlB,EAAqBrB,MAArB,CAA4BnB,MAAnC,KAA8C,UAAlD,EAA8D;EACnE,eAAO,CACLhB,OAAO0B,UAAP,CAAkB8B,CAAlB,EAAqBrB,MAArB,CAA4BnB,MAA5B,CAAmCJ,EAAE,CAAF,CAAnC,CADK,EAELZ,OAAO0B,UAAP,CAAkB8B,CAAlB,EAAqBrB,MAArB,CAA4BnB,MAA5B,CAAmCJ,EAAE,CAAF,CAAnC,CAFK,CAAP;EAID,OALM,MAKA;EACL,eAAOA,CAAP;EACD;EACF,KApBI,CAAP;EAqBD,GAxBe,CAAhB;;EA0BA;EACA;EACA;EACA;;EAEA;EACA,MAAI6C,QAAQ7D,MAAR,KAAmB,CAAvB,EAA0B,OAAOI,OAAOnB,IAAd;;EAE1B;EACA,MAAM+E,SAAS;EACbC,UAAM,cAACjD,CAAD,EAAI4C,CAAJ,EAAO3C,CAAP,EAAa;EACjB,UAAMqG,SAAS9F,QAAQP,CAAR,CAAf;;EAEA,UAAI,OAAOb,OAAO0B,UAAP,CAAkB8B,CAAlB,EAAqBrB,MAArB,CAA4B2B,SAAnC,KAAiD,UAArD,EAAiE;EAC/D;EAD+D;EAAA;EAAA;;EAAA;EAE/D,+BAAgBoD,MAAhB,8HAAwB;EAAA,gBAAbC,CAAa;;EACtB,gBAAIA,MAAM,IAAN,IAAcA,MAAMpF,SAAxB,EAAmC;EACjC;EACD;;EAED,gBACEoF,EAAE,CAAF,KAAQnH,OAAO0B,UAAP,CAAkB8B,CAAlB,EAAqBrB,MAArB,CAA4BvB,EAAE4C,CAAF,CAA5B,CAAR,IACAxD,OAAO0B,UAAP,CAAkB8B,CAAlB,EAAqBrB,MAArB,CAA4BvB,EAAE4C,CAAF,CAA5B,KAAqC2D,EAAE,CAAF,CAFvC,EAGE;EACA,qBAAO,IAAP;EACD;EACF;EAb8D;EAAA;EAAA;EAAA;EAAA;EAAA;EAAA;EAAA;EAAA;EAAA;EAAA;EAAA;EAAA;EAAA;;EAe/D,eAAO,KAAP;EACD,OAhBD,MAgBO;EAAA;EAAA;EAAA;;EAAA;EACL,gCAAgBD,MAAhB,mIAAwB;EAAA,gBAAbC,EAAa;;EACtB,gBAAIA,OAAM,IAAN,IAAcA,OAAMpF,SAAxB,EAAmC;EACjC;EACD;;EAED,gBAAIoF,GAAE,CAAF,KAAQvG,EAAE4C,CAAF,CAAR,IAAgB5C,EAAE4C,CAAF,KAAQ2D,GAAE,CAAF,CAA5B,EAAkC;EAChC,qBAAO,IAAP;EACD;EACF;EATI;EAAA;EAAA;EAAA;EAAA;EAAA;EAAA;EAAA;EAAA;EAAA;EAAA;EAAA;EAAA;EAAA;;EAWL,eAAO,KAAP;EACD;EACF,KAjCY;EAkCbpD,YAAQ,gBAACnD,CAAD,EAAI4C,CAAJ,EAAO3C,CAAP,EAAa;EACnB,UAAMqG,SAAS9F,QAAQP,CAAR,CAAf;;EAEA,UAAI,OAAOb,OAAO0B,UAAP,CAAkB8B,CAAlB,EAAqBrB,MAArB,CAA4B2B,SAAnC,KAAiD,UAArD,EAAiE;EAC/D;EAD+D;EAAA;EAAA;;EAAA;EAE/D,gCAAgBoD,MAAhB,mIAAwB;EAAA,gBAAbC,CAAa;;EACtB,gBAAIA,MAAM,IAAN,IAAcA,MAAMpF,SAAxB,EAAmC;EACjC;EACD;;EAED,gBACEoF,EAAE,CAAF,KAAQnH,OAAO0B,UAAP,CAAkB8B,CAAlB,EAAqBrB,MAArB,CAA4BvB,EAAE4C,CAAF,CAA5B,CAAR,IACAxD,OAAO0B,UAAP,CAAkB8B,CAAlB,EAAqBrB,MAArB,CAA4BvB,EAAE4C,CAAF,CAA5B,KAAqC2D,EAAE,CAAF,CAFvC,EAGE;EACA,qBAAO,IAAP;EACD;EACF;EAb8D;EAAA;EAAA;EAAA;EAAA;EAAA;EAAA;EAAA;EAAA;EAAA;EAAA;EAAA;EAAA;EAAA;;EAe/D,eAAO,KAAP;EACD,OAhBD,MAgBO;EAAA;EAAA;EAAA;;EAAA;EACL,gCAAgBD,MAAhB,mIAAwB;EAAA,gBAAbC,GAAa;;EACtB,gBAAIA,QAAM,IAAN,IAAcA,QAAMpF,SAAxB,EAAmC;EACjC;EACD;;EAED,gBAAIoF,IAAE,CAAF,KAAQvG,EAAE4C,CAAF,CAAR,IAAgB5C,EAAE4C,CAAF,KAAQ2D,IAAE,CAAF,CAA5B,EAAkC;EAChC,qBAAO,IAAP;EACD;EACF;EATI;EAAA;EAAA;EAAA;EAAA;EAAA;EAAA;EAAA;EAAA;EAAA;EAAA;EAAA;EAAA;EAAA;;EAWL,eAAO,KAAP;EACD;EACF,KAlEY;EAmEbnD,YAAQ,gBAACpD,CAAD,EAAI4C,CAAJ,EAAO3C,CAAP,EAAa;EACnB,UAAMqG,SAAS9F,QAAQP,CAAR,CAAf;;EADmB;EAAA;EAAA;;EAAA;EAGnB,8BAAgBqG,MAAhB,mIAAwB;EAAA,cAAbC,CAAa;;EACtB,cAAIA,MAAM,IAAN,IAAcA,MAAMpF,SAAxB,EAAmC;EACjC;EACD;;EAED,cACEoF,EAAE,CAAF,KAAQnH,OAAO0B,UAAP,CAAkB8B,CAAlB,EAAqBrB,MAArB,CAA4BvB,EAAE4C,CAAF,CAA5B,CAAR,IACAxD,OAAO0B,UAAP,CAAkB8B,CAAlB,EAAqBrB,MAArB,CAA4BvB,EAAE4C,CAAF,CAA5B,KAAqC2D,EAAE,CAAF,CAFvC,EAGE;EACA,mBAAO,IAAP;EACD;EACF;EAdkB;EAAA;EAAA;EAAA;EAAA;EAAA;EAAA;EAAA;EAAA;EAAA;EAAA;EAAA;EAAA;EAAA;;EAgBnB,aAAO,KAAP;EACD;EApFY,GAAf;;EAuFA,SAAOnH,OAAOnB,IAAP,CAAY6E,MAAZ,CAAmB,aAAK;EAC7B,YAAQJ,WAAWW,SAAnB;EACE,WAAK,KAAL;EACE,eAAOR,QAAQS,KAAR,CAAc,UAACV,CAAD,EAAI3C,CAAJ;EAAA,iBACnB+C,OAAO5D,OAAO0B,UAAP,CAAkB8B,CAAlB,EAAqBnC,IAA5B,EAAkCT,CAAlC,EAAqC4C,CAArC,EAAwC3C,CAAxC,CADmB;EAAA,SAAd,CAAP;EAGF,WAAK,IAAL;EACE,eAAO4C,QAAQU,IAAR,CAAa,UAACX,CAAD,EAAI3C,CAAJ;EAAA,iBAClB+C,OAAO5D,OAAO0B,UAAP,CAAkB8B,CAAlB,EAAqBnC,IAA5B,EAAkCT,CAAlC,EAAqC4C,CAArC,EAAwC3C,CAAxC,CADkB;EAAA,SAAb,CAAP;EAGF;EACE,cAAM,IAAIuD,KAAJ,CAAU,6BAA6BpE,OAAOqE,cAA9C,CAAN;EAVJ;EAYD,GAbM,CAAP;EAcD,CA1JD;;ECEA,IAAMC,iBAAe,SAAfA,YAAe,CAACtE,MAAD,EAASmB,EAAT,EAAaoD,MAAb;EAAA,SAAwB,wBAAgB;EAC3DvE,WAAOmD,OAAP,GAAiBsB,YAAjB;EACAF,WAAO5B,IAAP,CAAY,OAAZ,EAAqBxB,EAArB,EAAyBnB,OAAOmD,OAAhC;EACAhC,OAAG6B,aAAH;EACD,GAJoB;EAAA,CAArB;;EAMA,IAAMoE,WAAW,SAAXA,QAAW,CAAClG,KAAD,EAAQlB,MAAR,EAAgBmB,EAAhB,EAAoBoD,MAApB,EAA4BjB,UAA5B;EAAA,SAA2C,UAC1DqB,IAD0D,EAE1DC,SAF0D,EAGvD;EAAA,QACKtD,OADL,GAC6BJ,KAD7B,CACKI,OADL;EAAA,QACcC,UADd,GAC6BL,KAD7B,CACcK,UADd;;;EAGH,QAAMuD,gBACJ9E,OAAO0B,UAAP,CAAkBiD,IAAlB,EAAwBtD,IAAxB,KAAiC,QAAjC,GACIrB,OAAO0B,UAAP,CAAkBiD,IAAlB,EAAwBxC,MAAxB,CAA+B1B,KAA/B,GACET,OAAO0B,UAAP,CAAkBiD,IAAlB,EAAwBxC,MAAxB,CAA+B1B,KAA/B,GAAuCb,MAAvC,GAAgD,CADlD,CADJ,GAIII,OAAO0B,UAAP,CAAkBiD,IAAlB,EAAwBxC,MAAxB,CAA+B1B,KAA/B,GAAuC,CAAvC,CALN;;EAOA,QAAMqB,QAAQkD,iBAAS3C,MAAT,CAAgB,CAAC,CAAC,CAAC,EAAF,EAAM,CAAN,CAAD,EAAW,CAAC,EAAD,EAAKyC,aAAL,CAAX,CAAhB,CAAd;EACA,QAAMuB,KAAK/E,QAAQqD,IAAR,IAAgBrD,QAAQqD,IAAR,EAAc/E,MAA9B,GAAuC,CAAlD;EACA,QAAMyF,OACJ,WAAW7D,OAAOC,IAAP,CAAYzB,OAAO0B,UAAnB,EAA+B8E,OAA/B,CAAuC7B,IAAvC,CAAX,GAA0D,GAA1D,GAAgE0B,EADlE;;EAGA,QAAI/E,QAAQqD,IAAR,CAAJ,EAAmB;EACjBrD,cAAQqD,IAAR,EAAc7D,IAAd,CAAmB;EACjBuF,cADiB;EAEjBvE,oBAFiB;EAGjBuD;EAHiB,OAAnB;EAKD,KAND,MAMO;EACL/D,cAAQqD,IAAR,IAAgB,CAAC,EAAE0B,MAAF,EAAMvE,YAAN,EAAauD,UAAb,EAAD,CAAhB;EACD;;EAED,QAAI9D,WAAWoD,IAAX,CAAJ,EAAsB;EACpBpD,iBAAWoD,IAAX,EAAiB7D,IAAjB,CAAsB,EAAEuF,MAAF,EAAMhB,UAAN,EAAtB;EACD,KAFD,MAEO;EACL9D,iBAAWoD,IAAX,IAAmB,CAAC,EAAE0B,MAAF,EAAMhB,UAAN,EAAD,CAAnB;EACD;;EAEDvD,UACGwD,EADH,CACM,OADN,EACe,YAAW;EACtB,UAAIlC,kBAAMmC,WAAN,KAAsB,IAA1B,EAAgC;EAC9BhB,eAAO5B,IAAP,CAAY,YAAZ,EAA0BxB,EAA1B,EAA8BnB,OAAOmD,OAArC;EACA,YAAI,OAAOC,kBAAMmC,WAAN,CAAkBC,eAAzB,KAA6C,UAAjD,EAA6D;EAC3DpC,4BAAMmC,WAAN,CAAkBC,eAAlB;EACD;EACF;EACF,KARH,EASGF,EATH,CASM,OATN,EASe,UAAS6B,CAAT,EAAY;EACvB;EACA7C,qBACEtE,MADF,EAEEmB,EAFF,EAGEoD,MAHF,EAIElB,WAASnC,KAAT,EAAgBlB,MAAhB,EAAwBmB,EAAxB,EAA4BoD,MAA5B,EAAoCjB,UAApC,CAJF;EAKD,KAhBH,EAiBGgC,EAjBH,CAiBM,KAjBN,EAiBa,YAAW;EACpB;EACA,UAAM+B,cAAc/F,QAAQqD,IAAR,EAAcrD,QAAQqD,IAAR,EAAc/E,MAAd,GAAuB,CAArC,EAAwCyG,EAA5D;EACA,UAAMiB,YAAYR,SAASC,cAAT,CAChB,WACEvF,OAAOC,IAAP,CAAYzB,OAAO0B,UAAnB,EAA+B8E,OAA/B,CAAuC7B,IAAvC,CADF,GAEE,GAFF,GAGE0C,WAJc,CAAlB;EAMA,UAAM/G,YAAY0B,uBAAesF,SAAf,CAAlB;;EAEA,UACEhH,cAAcyB,SAAd,IACAzB,cAAc,IADd,IAEAA,UAAU,CAAV,MAAiBA,UAAU,CAAV,CAHnB,EAIE;EACA8G,iBAASlG,KAAT,EAAgBlB,MAAhB,EAAwBmB,EAAxB,EAA4BoD,MAA5B,EAAoCjB,UAApC,EAAgDqB,IAAhD,EAAsDC,SAAtD;;EAEAuB,oBAAY7E,QAAQqD,IAAR,CAAZ,EAA2B3E,MAA3B,EAAmCmB,EAAnC,EAAuCwD,IAAvC,EAA6CC,SAA7C;;EAEAN,uBAAatE,MAAb,EAAqBmB,EAArB,EAAyBoD,MAAzB,EACElB,WAASnC,KAAT,EAAgBlB,MAAhB,EAAwBmB,EAAxB,EAA4BoD,MAA5B,EAAoCjB,UAApC,CADF;EAGD,OAZD,MAYO;EACL,YACEF,kBAAMmC,WAAN,IACAnC,kBAAMmC,WAAN,CAAkBgC,QAAlB,OAAiC,qBADjC,IAEAnE,kBAAM9C,SAAN,KAAoB,IAHtB,EAIE;EACAa,aAAG8B,UAAH,CAAc0B,IAAd;EACD;EACF;;EAEDJ,aAAO5B,IAAP,CAAY,UAAZ,EAAwBxB,EAAxB,EAA4BnB,OAAOmD,OAAnC;EACD,KAnDH;;EAqDA,WAAOrB,KAAP;EACD,GAxFgB;EAAA,CAAjB;;ECLA;;;;;;;;;EASA,IAAMb,iBAAe,SAAfA,YAAe,CAACC,KAAD,EAAQlB,MAAR,EAAgBmB,EAAhB,EAAoBoD,MAApB,EAA4BjB,UAA5B;EAAA,SAA2C,mBAAW;EAAA,QACjEhC,OADiE,GACrDJ,KADqD,CACjEI,OADiE;;EAEzE,QAAMkG,aAAarG,GAAG6F,QAAH,EAAnB;;EAEA,QAAI,OAAO5F,OAAP,KAAmB,WAAvB,EAAoC;EAClC,aAAOI,OAAOC,IAAP,CAAYzB,OAAO0B,UAAnB,EACJgC,MADI,CACG;EAAA,eAAK,CAAC8D,WAAWP,QAAX,CAAoBrG,CAApB,CAAN;EAAA,OADH,EAEJe,MAFI,CAEG,UAACC,GAAD,EAAMC,GAAN,EAAW+E,GAAX,EAAmB;EACzB,YAAMC,cAAcvF,QAAQO,GAAR,CAApB;;EAEA,YAAIgF,gBAAgB9E,SAAhB,IAA6B8E,gBAAgB,IAAjD,EAAuD;EACrDjF,cAAIC,GAAJ,IAAW,EAAX;EACD,SAFD,MAEO;EACLD,cAAIC,GAAJ,IAAWgF,YAAYlF,MAAZ,CAAmB,UAACf,CAAD,EAAI4C,CAAJ,EAAO3C,CAAP,EAAa;EACzC,gBAAMoB,MAAMD,uBACV8E,SAASC,cAAT,CAAwB,WAAWH,GAAX,GAAiB,GAAjB,GAAuB/F,CAA/C,CADU,CAAZ;;EAIA,gBAAIoB,GAAJ,EAAS;EACP,kBAAMC,SAASlC,OAAO0B,UAAP,CAAkBG,GAAlB,EAAuBM,MAAtC;EACA,kBAAMC,SAASrB,cAAckB,GAAd,EAAmBC,MAAnB,CAAf;;EAEAtB,gBAAEE,IAAF,CAAO;EACLuB,wBAAQmB,EAAE1B,KAAF,CAAQO,MAAR,EADH;EAEL/B,2BAAW;EACT2B,0BADS;EAETG;EAFS;EAFN,eAAP;EAOD;EACD,mBAAOxB,CAAP;EACD,WAlBU,EAkBR,EAlBQ,CAAX;EAmBD;;EAED,eAAOgB,GAAP;EACD,OA9BI,EA8BF,EA9BE,CAAP;EA+BD,KAhCD,MAgCO;EACL;EACA;EACAJ,aAAOC,IAAP,CAAYzB,OAAO0B,UAAnB,EAA+Bf,OAA/B,CAAuC,UAACC,CAAD,EAAIgG,GAAJ,EAAY;EACjD,YAAIxF,QAAQR,CAAR,MAAemB,SAAf,IAA4BX,QAAQR,CAAR,MAAe,IAA/C,EAAqD;EACnD;EACD;;EAED,YAAMiC,MAAM7C,OAAO0B,UAAP,CAAkBd,CAAlB,CAAZ;;EAEA,YAAM6G,WAAWrG,QAAQR,CAAR,EAAWxB,GAAX,CAAe;EAAA,iBAAK+H,EAAE/H,GAAF,CAAMyD,IAAIV,MAAV,CAAL;EAAA,SAAf,CAAjB;;EAEA,YAAMuF,MAAMD,SAASrI,GAAT,CAAa,UAAC+H,CAAD,EAAIQ,CAAJ,EAAU;EACjC,cAAM5C,SAASqC,SAASlG,KAAT,EAAgBlB,MAAhB,EAAwBmB,EAAxB,EAA4BoD,MAA5B,EAAoCjB,UAApC,EACb1C,CADa,EAEb8B,mBAAO,kBAAkBkE,GAAzB,CAFa,CAAf;EAIA;EACA;EACA7B,iBAAO1C,MAAP,CAAc,CAAC,CAAC,CAAC,EAAF,EAAM8E,EAAE,CAAF,CAAN,CAAD,EAAc,CAAC,EAAD,EAAKA,EAAE,CAAF,CAAL,CAAd,CAAd;;EAEA,iBAAO;EACLd,gBAAIsB,CADC;EAEL7F,mBAAOiD,MAFF;EAGL6C,iBAAKT;EAHA,WAAP;EAKD,SAdW,CAAZ;;EAgBA7F,gBAAQV,CAAR,IAAa8G,GAAb;;EAEAvB,oBAAYuB,GAAZ,EAAiB1H,MAAjB,EAAyBmB,EAAzB,EAA6BP,CAA7B,EAAgC8B,mBAAO,kBAAkBkE,GAAzB,CAAhC;;EAEA;EACA;EACA;EACAc,YAAI/G,OAAJ,CAAY,UAACkH,CAAD,EAAIC,CAAJ,EAAU;EACpBpF,6BAAO,YAAYkE,GAAZ,GAAkB,GAAlB,GAAwBkB,CAA/B,EACGnF,IADH,CACQkF,EAAE/F,KADV,EAEGa,IAFH,CAEQkF,EAAE/F,KAAF,CAAQc,IAFhB,EAEsBiF,EAAED,GAAF,CAAM7E,OAAN,EAFtB;EAGD,SAJD;EAKD,OArCD;;EAuCA;EACA5B,SAAG6B,aAAH;;EAEA,aAAO7B,EAAP;EACD;EACF,GAnFoB;EAAA,CAArB;;;;ECZA,IAAM8B,eAAa,SAAbA,UAAa,CAAC/B,KAAD,EAAQlB,MAAR,EAAgBmB,EAAhB;EAAA,SAAuB,qBAAa;EAAA,QAC7CG,OAD6C,GACjCJ,KADiC,CAC7CI,OAD6C;;;EAGrD,QAAI4B,cAAcnB,SAAlB,EAA6B;EAC3B,UAAIZ,GAAGoB,CAAH,OAAWR,SAAX,IAAwBZ,GAAGoB,CAAH,OAAW,IAAvC,EAA6C;EAC3Cf,eAAOC,IAAP,CAAYzB,OAAO0B,UAAnB,EAA+Bf,OAA/B,CAAuC,UAACC,CAAD,EAAIgG,GAAJ,EAAY;EACjD,cAAMmB,YAAYzG,QAAQV,CAAR,CAAlB;;EAEA;EACA,cAAImH,SAAJ,EAAe;EACbA,sBAAUpH,OAAV,CAAkB,UAACwG,CAAD,EAAItG,CAAJ,EAAU;EAC1B,kBAAMiB,QAAQgF,SAASC,cAAT,CAAwB,WAAWH,GAAX,GAAiB,GAAjB,GAAuB/F,CAA/C,CAAd;EACA,kBAAIiB,SAASE,uBAAeF,KAAf,MAA0B,IAAvC,EAA6C;EAC3CX,mBAAGoB,CAAH,GACGG,MADH,CACU,YAAYkE,GAAZ,GAAkB,GAAlB,GAAwB/F,CADlC,EAEG8B,IAFH,CAEQwE,EAAErF,KAAF,CAAQc,IAFhB,EAEsB,IAFtB;EAGD;EACF,aAPD;EAQD;EACF,SAdD;;EAgBAzB,WAAG6B,aAAH;EACD;EACF,KApBD,MAoBO;EACL,UAAI7B,GAAGoB,CAAH,OAAWR,SAAX,IAAwBZ,GAAGoB,CAAH,OAAW,IAAvC,EAA6C;EAC3C,YAAMwF,YAAYzG,QAAQ4B,SAAR,CAAlB;EACA,YAAM0D,MAAMpF,OAAOC,IAAP,CAAYzB,OAAO0B,UAAnB,EAA+B8E,OAA/B,CAAuCtD,SAAvC,CAAZ;;EAEA,YAAI6E,SAAJ,EAAe;EACbA,oBAAUpH,OAAV,CAAkB,UAACwG,CAAD,EAAItG,CAAJ,EAAU;EAC1B,gBAAMiB,QAAQgF,SAASC,cAAT,CAAwB,WAAWH,GAAX,GAAiB,GAAjB,GAAuB/F,CAA/C,CAAd;EACA,gBAAImB,uBAAeF,KAAf,MAA0B,IAA9B,EAAoC;EAClCX,iBAAGoB,CAAH,GACGG,MADH,CACU,YAAYkE,GAAZ,GAAkB,GAAlB,GAAwB/F,CADlC,EAEG8B,IAFH,CAEQwE,EAAErF,KAAF,CAAQc,IAFhB,EAEsB,IAFtB;;EAIA,kBAAI,OAAOuE,EAAE/D,KAAT,KAAmB,UAAvB,EAAmC;EACjC+D,kBAAE/D,KAAF,CAAQV,mBAAO,YAAYkE,GAAZ,GAAkB,GAAlB,GAAwB/F,CAA/B,CAAR;EACD;EACF;EACF,WAXD;EAYD;;EAEDM,WAAG6B,aAAH;EACD;EACF;EACD,WAAOgF,OAAP;EACD,GA/CkB;EAAA,CAAnB;;ECAA,IAAMtD,aAAW,SAAXA,QAAW,CAACxD,KAAD,EAAQlB,MAAR,EAAgBmB,EAAhB,EAAoBoD,MAApB,EAA4BjB,UAA5B;EAAA,SAA2C,UAC1DqB,IAD0D,EAE1DC,SAF0D,EAGvD;EAAA,QACKtD,OADL,GACiBJ,KADjB,CACKI,OADL;;EAEH8F,aAASlG,KAAT,EAAgBlB,MAAhB,EAAwBmB,EAAxB,EAA4BoD,MAA5B,EAAoCjB,UAApC,EAAgDqB,IAAhD,EAAsDC,SAAtD;EACAuB,gBAAY7E,QAAQqD,IAAR,CAAZ,EAA2B3E,MAA3B,EAAmCmB,EAAnC,EAAuCwD,IAAvC,EAA6CC,SAA7C;EACD,GAPgB;EAAA,CAAjB;;ECEA,IAAMa,YAAU,SAAVA,OAAU,CAACvE,KAAD,EAAQlB,MAAR,EAAgBmB,EAAhB,EAAoBoD,MAApB,EAA4BjB,UAA5B;EAAA,SAA2C,YAAM;EAC/D,QAAI,CAACnC,GAAGoB,CAAH,EAAL,EAAa;EACXpB,SAAGuE,UAAH;EACD;;EAED,QAAM8B,aAAarG,GAAG6F,QAAH,EAAnB;;EAEA7F,OAAGoB,CAAH,GACGoD,MADH,CACU,OADV,EAEGC,IAFH,CAEQ,IAFR,EAEc,UAAChF,CAAD,EAAIC,CAAJ;EAAA,aAAU,iBAAiBA,CAA3B;EAAA,KAFd,EAGG+E,IAHH,CAGQ,OAHR,EAGiB,aAHjB,EAIGA,IAJH,CAIQ,WAJR,EAIqB;EAAA,aAAKhF,CAAL;EAAA,KAJrB,EAKG6B,IALH,CAKQ,UAAS7B,CAAT,EAAY;EAChB,UAAI,CAAC4G,WAAWP,QAAX,CAAoBrG,CAApB,CAAL,EAA6B;EAC3B8D,mBAASxD,KAAT,EAAgBlB,MAAhB,EAAwBmB,EAAxB,EAA4BoD,MAA5B,EAAoCjB,UAApC,EAAgD1C,CAAhD,EAAmD8B,mBAAO,IAAP,CAAnD;EACD;EACF,KATH;;EAWAvB,OAAGF,YAAH,GAAkBA,eAAaC,KAAb,EAAoBlB,MAApB,EAA4BmB,EAA5B,EAAgCoD,MAAhC,EAAwCjB,UAAxC,CAAlB;EACAnC,OAAG8B,UAAH,GAAgBA,aAAW/B,KAAX,EAAkBlB,MAAlB,EAA0BmB,EAA1B,CAAhB;EACA,WAAOA,EAAP;EACD,GArBe;EAAA,CAAhB;;ECLA,IAAM2E,cAAY,SAAZA,SAAY,CAAC5E,KAAD,EAAQC,EAAR;EAAA,SAAe,YAAM;EACrC,QAAIA,GAAGoB,CAAH,OAAWR,SAAX,IAAwBZ,GAAGoB,CAAH,OAAW,IAAvC,EACEpB,GAAGoB,CAAH,GACGC,SADH,CACa,cADb,EAEGuD,MAFH;;EAIF7E,UAAMI,OAAN,GAAgB,EAAhB;EACA,WAAOH,GAAGF,YAAV;EACA,WAAOE,GAAG8B,UAAV;EACD,GATiB;EAAA,CAAlB;;ECKA,IAAMgF,qBAAqB,SAArBA,kBAAqB,CAAC3E,UAAD,EAAatD,MAAb,EAAqBmB,EAArB,EAAyBoD,MAAzB,EAAoC;EAC7D,MAAMrD,QAAQ;EACZI,aAAS,EADG;EAEZC,gBAAY;EAFA,GAAd;;EAKA+B,aAAW2C,KAAX,CAAiB,eAAjB,IAAoC;EAClCR,aAASA,UAAQvE,KAAR,EAAelB,MAAf,EAAuBmB,EAAvB,EAA2BoD,MAA3B,EAAmCjB,UAAnC,CADyB;EAElCwC,eAAWA,YAAU5E,KAAV,EAAiBC,EAAjB,CAFuB;EAGlCkC,cAAUA,WAASnC,KAAT,EAAgBlB,MAAhB,EAAwBsD,UAAxB,CAHwB;EAIlC4C,gBAAYjF,eAAaC,KAAb,EAAoBlB,MAApB,EAA4BmB,EAA5B;EAJsB,GAApC;EAMD,CAZD;;ECLA,IAAM2E,cAAY,SAAZA,SAAY,CAAC5E,KAAD,EAAQC,EAAR;EAAA,SAAe,YAAM;EACrCA,OAAGb,SAAH,CACGoC,MADH,CACU,KADV,EAEGA,MAFH,CAEU,UAFV,EAGGqD,MAHH;EAIA5E,OAAGb,SAAH,CACGoC,MADH,CACU,KADV,EAEGA,MAFH,CAEU,mBAFV,EAGGqD,MAHH;EAIA5E,OAAGmE,EAAH,CAAM,oBAAN,EAA4BvD,SAA5B;EACA,WAAOZ,GAAG8B,UAAV;;EAEA/B,UAAMgH,SAAN,GAAkBnG,SAAlB;EACD,GAbiB;EAAA,CAAlB;;ECAA;EACA,IAAMoG,kBAAkB,SAAlBA,eAAkB,CAACC,KAAD,EAAQnI,KAAR;EAAA,SAAkB,aAAK;EAC7C,QAAMoI,KAAK,CAACD,MAAMC,EAAN,CAAS,CAAT,IAAcD,MAAME,IAArB,EAA2BF,MAAMC,EAAN,CAAS,CAAT,IAAcD,MAAME,IAA/C,CAAX;EAAA,QACEC,KAAK,CAACH,MAAMG,EAAN,CAAS,CAAT,IAAcH,MAAME,IAArB,EAA2BF,MAAMG,EAAN,CAAS,CAAT,IAAcH,MAAME,IAA/C,CADP;EAAA,QAEEE,KAAK,IAAIvI,QAAQoI,GAAG,CAAH,CAFnB;EAAA,QAGEI,KAAKJ,GAAG,CAAH,KAAS,IAAIG,EAAb,CAHP;EAAA,QAIEE,KAAK,IAAIzI,QAAQsI,GAAG,CAAH,CAJnB;EAAA,QAKEI,KAAKJ,GAAG,CAAH,KAAS,IAAIG,EAAb,CALP;;EAOA,QAAME,IAAIpF,EAAE,CAAF,CAAV;EAAA,QACEqF,IAAIrF,EAAE,CAAF,CADN;EAAA,QAEEsF,KAAKN,KAAKI,CAAL,GAASH,EAFhB;EAAA,QAGEM,KAAKL,KAAKE,CAAL,GAASD,EAHhB;;EAKA,WAAOE,IAAIG,KAAKC,GAAL,CAASH,EAAT,EAAaC,EAAb,CAAJ,IAAwBF,IAAIG,KAAKE,GAAL,CAASJ,EAAT,EAAaC,EAAb,CAAnC;EACD,GAduB;EAAA,CAAxB;;EAgBA,IAAMI,eAAe,SAAfA,YAAe,CAACjI,KAAD,EAAQlB,MAAR;EAAA,SAAmB,UAACY,CAAD,EAAIyF,EAAJ,EAAW;EACjD,QAAI+B,QAAQlH,MAAMkI,MAAN,CAAa/C,EAAb,CAAZ;EAAA,QACEgD,OAAOlB,gBAAgBC,KAAhB,EAAuBlH,MAAMkI,MAAN,CAAanJ,KAAb,CAAmBoG,EAAnB,CAAvB,CADT;EAAA,QAEEiD,KAAKlB,MAAMmB,IAAN,CAAWnJ,IAFlB;EAAA,QAGEoJ,KAAKpB,MAAMmB,IAAN,CAAWpJ,KAHlB;EAAA,QAIE2I,KAAK9I,OAAO0B,UAAP,CAAkB4H,EAAlB,EAAsBnH,MAJ7B;EAAA,QAKE4G,KAAK/I,OAAO0B,UAAP,CAAkB8H,EAAlB,EAAsBrH,MAL7B;EAAA,QAMEsH,QAAQ,CAACX,GAAGlI,EAAE0I,EAAF,CAAH,IAAYlB,MAAME,IAAnB,EAAyBS,GAAGnI,EAAE4I,EAAF,CAAH,IAAYpB,MAAME,IAA3C,CANV;EAOA,WAAOe,KAAKI,KAAL,CAAP;EACD,GAToB;EAAA,CAArB;;EAWA,IAAMpG,aAAW,SAAXA,QAAW,CAACC,UAAD,EAAapC,KAAb,EAAoBlB,MAApB,EAA+B;EAC9C;EACA,MAAM0J,MAAMlI,OAAOmI,mBAAP,CAA2BzI,MAAMkI,MAAjC,EAAyC1F,MAAzC,CAAgD;EAAA,WAAK,CAACkG,MAAMhJ,CAAN,CAAN;EAAA,GAAhD,CAAZ;EAAA,MACEuC,UAAUnD,OAAOnB,IADnB;;EAGA,MAAI6K,IAAI9J,MAAJ,KAAe,CAAnB,EAAsB;EACpB,WAAOuD,OAAP;EACD;;EAED,MAAM0G,YAAYV,aAAajI,KAAb,EAAoBlB,MAApB,CAAlB;;EAEA,SAAOmD,QAAQO,MAAR,CAAe,aAAK;EACzB,YAAQJ,WAAWW,SAAnB;EACE,WAAK,KAAL;EACE,eAAOyF,IAAIxF,KAAJ,CAAU;EAAA,iBAAM2F,UAAUjJ,CAAV,EAAayF,EAAb,CAAN;EAAA,SAAV,CAAP;EACF,WAAK,IAAL;EACE,eAAOqD,IAAIvF,IAAJ,CAAS;EAAA,iBAAM0F,UAAUjJ,CAAV,EAAayF,EAAb,CAAN;EAAA,SAAT,CAAP;EACF;EACE,cAAM,IAAIjC,KAAJ,CAAU,6BAA6BpE,OAAOqE,cAA9C,CAAN;EANJ;EAQD,GATM,CAAP;EAUD,CArBD;;EC5BA,IAAMyF,cAAc,SAAdA,WAAc,CAAC5I,KAAD,EAAQC,EAAR,EAAe;EACjC,MAAMiH,QAAQlH,MAAMkI,MAAN,CAAalI,MAAMkI,MAAN,CAAaW,MAA1B,CAAd;EAAA,MACEC,MAAM7I,GAAGb,SAAH,CAAaoC,MAAb,CAAoB,KAApB,EAA2BA,MAA3B,CAAkC,UAAlC,CADR;;EAGA,SAAOxB,MAAMkI,MAAN,CAAalI,MAAMkI,MAAN,CAAaW,MAA1B,CAAP;EACAC,MAAIxH,SAAJ,CAAc,gBAAgB4F,MAAMmB,IAAN,CAAW1I,CAAzC,EAA4CkF,MAA5C;EACAiE,MAAIxH,SAAJ,CAAc,kBAAkB4F,MAAMmB,IAAN,CAAW1I,CAA3C,EAA8CkF,MAA9C;EACD,CAPD;;ECGA,IAAMkE,YAAY,SAAZA,SAAY,CAAC3G,UAAD,EAAapC,KAAb,EAAoBlB,MAApB,EAA4BmB,EAA5B,EAAgCoD,MAAhC;EAAA,SAA2C,YAAM;EACjE,QAAM6D,QAAQlH,MAAMkI,MAAN,CAAalI,MAAMkI,MAAN,CAAaW,MAA1B,CAAd;;EAEA;EACA;EACA,QAAI3B,SAASA,MAAMC,EAAN,CAAS,CAAT,MAAgBD,MAAMG,EAAN,CAAS,CAAT,CAAzB,IAAwCH,MAAMC,EAAN,CAAS,CAAT,MAAgBD,MAAMG,EAAN,CAAS,CAAT,CAA5D,EAAyE;EACvEuB,kBAAY5I,KAAZ,EAAmBC,EAAnB;EACD;;EAED,QAAMgC,UAAUE,WAASC,UAAT,EAAqBpC,KAArB,EAA4BlB,MAA5B,CAAhB;EACAkB,UAAMkI,MAAN,CAAaW,MAAb,GAAsBhI,SAAtB;EACA/B,WAAOmD,OAAP,GAAiBA,OAAjB;EACAhC,OAAG6B,aAAH;EACAuB,WAAO5B,IAAP,CAAY,UAAZ,EAAwBxB,EAAxB,EAA4BnB,OAAOmD,OAAnC;EACD,GAdiB;EAAA,CAAlB;;ECCA,IAAM+G,YAAY,SAAZA,SAAY,CAChB5G,UADgB,EAEhBpC,KAFgB,EAGhBlB,MAHgB,EAIhBmB,EAJgB,EAKhBoD,MALgB,EAMhB6D,KANgB,EAOhB+B,WAPgB,EAQb;EACH,MAAIC,OAAOjJ,GAAGb,SAAH,CAAaoC,MAAb,CAAoB,KAApB,EAA2BA,MAA3B,CAAkC,UAAlC,CAAX;EAAA,MACE2D,KAAK+B,MAAMmB,IAAN,CAAW1I,CADlB;EAAA,MAEEwJ,SAAS,CAACjC,MAAMC,EAAP,EAAWD,MAAMG,EAAjB,CAFX;EAAA,MAGE+B,QAAQF,KAAK5H,SAAL,CAAe,gBAAgB6D,EAA/B,EAAmCxH,IAAnC,CAAwC,CAACuJ,KAAD,CAAxC,CAHV;EAAA,MAIEmC,UAAUH,KAAK5H,SAAL,CAAe,kBAAkB6D,EAAjC,EAAqCxH,IAArC,CAA0CwL,MAA1C,CAJZ;EAAA,MAKEG,QAAQC,aALV;;EAOAH,QACGhE,KADH,GAEGX,MAFH,CAEU,MAFV,EAGGC,IAHH,CAGQ,IAHR,EAGc,WAAWS,EAHzB,EAIGT,IAJH,CAIQ,OAJR,EAIiB,OAJjB;;EAMA0E,QACG1E,IADH,CACQ,IADR,EACc;EAAA,WAAKhF,EAAEyH,EAAF,CAAK,CAAL,CAAL;EAAA,GADd,EAEGzC,IAFH,CAEQ,IAFR,EAEc;EAAA,WAAKhF,EAAEyH,EAAF,CAAK,CAAL,CAAL;EAAA,GAFd,EAGGzC,IAHH,CAGQ,IAHR,EAGc;EAAA,WAAKhF,EAAE2H,EAAF,CAAK,CAAL,CAAL;EAAA,GAHd,EAIG3C,IAJH,CAIQ,IAJR,EAIc;EAAA,WAAKhF,EAAE2H,EAAF,CAAK,CAAL,CAAL;EAAA,GAJd,EAKG3C,IALH,CAKQ,QALR,EAKkB,OALlB,EAMGA,IANH,CAMQ,cANR,EAMwB,CANxB;;EAQA4E,QACGlF,EADH,CACM,MADN,EACc,UAAS1E,CAAT,EAAYC,CAAZ,EAAe;EACzB,QAAM6J,KAAKtH,iBAAX;EACAvC,QAAIA,IAAI,CAAR;EACAuH,UAAM,MAAMvH,CAAZ,EAAe,CAAf,IAAoBmI,KAAKC,GAAL,CAASD,KAAKE,GAAL,CAASd,MAAME,IAAN,GAAa,CAAtB,EAAyBoC,GAAG9B,CAA5B,CAAT,EAAyCR,MAAMuC,IAA/C,CAApB;EACAvC,UAAM,MAAMvH,CAAZ,EAAe,CAAf,IAAoBmI,KAAKC,GAAL,CAASD,KAAKE,GAAL,CAASd,MAAMwC,IAAf,EAAqBF,GAAG7B,CAAxB,CAAT,EAAqCT,MAAMyC,IAA3C,CAApB;EACAX,cAAU5G,UAAV,EAAsBpC,KAAtB,EAA6BlB,MAA7B,EAAqCmB,EAArC,EAAyCoD,MAAzC,EAAiD6D,KAAjD,EAAwDvH,IAAI,CAA5D;EACD,GAPH,EAQGyE,EARH,CAQM,KARN,EAQa2E,UAAU3G,UAAV,EAAsBpC,KAAtB,EAA6BlB,MAA7B,EAAqCmB,EAArC,EAAyCoD,MAAzC,CARb;;EAUAgG,UACGjE,KADH,GAEGX,MAFH,CAEU,QAFV,EAGGC,IAHH,CAGQ,IAHR,EAGc,WAAWS,EAHzB,EAIGT,IAJH,CAIQ,OAJR,EAIiB,OAJjB;;EAMA2E,UACG3E,IADH,CACQ,IADR,EACc;EAAA,WAAKhF,EAAE,CAAF,CAAL;EAAA,GADd,EAEGgF,IAFH,CAEQ,IAFR,EAEc;EAAA,WAAKhF,EAAE,CAAF,CAAL;EAAA,GAFd,EAGGgF,IAHH,CAGQ,GAHR,EAGa,CAHb,EAIGC,KAJH,CAKI,SALJ,EAMI,UAACjF,CAAD,EAAIC,CAAJ;EAAA,WAAWsJ,gBAAgBpI,SAAhB,IAA6BlB,MAAMsJ,WAAnC,GAAiD,GAAjD,GAAuD,CAAlE;EAAA,GANJ,EAQG7E,EARH,CAQM,WARN,EAQmB,YAAW;EAC1B5C,uBAAO,IAAP,EAAamD,KAAb,CAAmB,SAAnB,EAA8B,GAA9B;EACD,GAVH,EAWGP,EAXH,CAWM,UAXN,EAWkB,YAAW;EACzB5C,uBAAO,IAAP,EAAamD,KAAb,CAAmB,SAAnB,EAA8B,CAA9B;EACD,GAbH,EAcGlD,IAdH,CAcQ6H,KAdR;EAeD,CA7DD;;EA+DA,IAAMM,SAAS,SAATA,MAAS,CAACxH,UAAD,EAAapC,KAAb,EAAoBlB,MAApB,EAA4BmB,EAA5B,EAAgCoD,MAAhC;EAAA,SAA2C,YAAM;EAC9D,QAAMmG,KAAKtH,iBAAX;EAAA,QACEgF,QAAQlH,MAAMkI,MAAN,CAAalI,MAAMkI,MAAN,CAAaW,MAA1B,CADV;;EAGA;EACA3B,UAAMG,EAAN,CAAS,CAAT,IAAcS,KAAKC,GAAL,CACZD,KAAKE,GAAL,CAASd,MAAME,IAAN,GAAa,CAAtB,EAAyBoC,GAAG9B,CAAH,GAAO5I,OAAOE,MAAP,CAAcE,IAA9C,CADY,EAEZgI,MAAMuC,IAFM,CAAd;EAIAvC,UAAMG,EAAN,CAAS,CAAT,IAAcS,KAAKC,GAAL,CACZD,KAAKE,GAAL,CAASd,MAAMwC,IAAf,EAAqBF,GAAG7B,CAAH,GAAO7I,OAAOE,MAAP,CAAc6K,GAA1C,CADY,EAEZ3C,MAAMyC,IAFM,CAAd;;EAKAX,cAAU5G,UAAV,EAAsBpC,KAAtB,EAA6BlB,MAA7B,EAAqCmB,EAArC,EAAyCoD,MAAzC,EAAiD6D,KAAjD,EAAwD,CAAxD;EACD,GAfc;EAAA,CAAf;;ECnEA,IAAM4C,IAAI,SAAJA,CAAI;EAAA,SAAUhL,OAAOiL,MAAP,GAAgBjL,OAAOE,MAAP,CAAc6K,GAA9B,GAAoC/K,OAAOE,MAAP,CAAcgL,MAA5D;EAAA,CAAV;;ECAA,IAAMC,qBAAqB,SAArBA,kBAAqB,CAACnL,MAAD,EAASmB,EAAT,EAAaiK,MAAb,EAAqB5H,CAArB,EAA2B;EACpD,MAAM+F,OAAO,EAAE1I,GAAG,CAAC,CAAN,EAAST,MAAM2B,SAAf,EAA0B5B,OAAO4B,SAAjC,EAAb;EACAP,SAAOC,IAAP,CAAYzB,OAAO0B,UAAnB,EAA+ByC,IAA/B,CAAoC,UAACtB,GAAD,EAAMhC,CAAN,EAAY;EAC9C,QAAIuK,OAAOvI,GAAP,IAAcW,EAAE,CAAF,CAAlB,EAAwB;EACtB+F,WAAK1I,CAAL,GAASA,CAAT;EACA0I,WAAKnJ,IAAL,GAAYyC,GAAZ;EACA0G,WAAKpJ,KAAL,GAAaqB,OAAOC,IAAP,CAAYzB,OAAO0B,UAAnB,EACXP,GAAGkK,uBAAH,GAA6B7E,OAA7B,CAAqC3D,GAArC,IAA4C,CADjC,CAAb;EAGA,aAAO,KAAP;EACD;EACD,WAAO,IAAP;EACD,GAVD;;EAYA,MAAI0G,KAAKnJ,IAAL,KAAc2B,SAAlB,EAA6B;EAC3B;EACAwH,SAAK1I,CAAL,GAAS,CAAT;EACA0I,SAAKnJ,IAAL,GAAYe,GAAGkK,uBAAH,GAA6B,CAA7B,CAAZ;EACA9B,SAAKpJ,KAAL,GAAagB,GAAGkK,uBAAH,GAA6B,CAA7B,CAAb;EACD,GALD,MAKO,IAAI9B,KAAKpJ,KAAL,KAAe4B,SAAnB,EAA8B;EACnC;EACAwH,SAAK1I,CAAL,GAASW,OAAOC,IAAP,CAAYzB,OAAO0B,UAAnB,EAA+B9B,MAA/B,GAAwC,CAAjD;EACA2J,SAAKpJ,KAAL,GAAaoJ,KAAKnJ,IAAlB;EACAmJ,SAAKnJ,IAAL,GAAYe,GAAGkK,uBAAH,GACV7J,OAAOC,IAAP,CAAYzB,OAAO0B,UAAnB,EAA+B9B,MAA/B,GAAwC,CAD9B,CAAZ;EAGD;;EAED,SAAO2J,IAAP;EACD,CA7BD;;ECIA;EACA;EACA;EACA;EACA,IAAM+B,cAAc,SAAdA,WAAc,CAACpK,KAAD,EAAQlB,MAAR,EAAgBmB,EAAhB,EAAoBiK,MAApB;EAAA,SAA+B,YAAM;EACvD,QAAI5H,IAAI+H,kBAAMrK,MAAMgH,SAAN,CAAgB7C,IAAhB,EAAN,CAAR;;EAEA7B,MAAE,CAAF,IAAOA,EAAE,CAAF,IAAOxD,OAAOE,MAAP,CAAcE,IAA5B;EACAoD,MAAE,CAAF,IAAOA,EAAE,CAAF,IAAOxD,OAAOE,MAAP,CAAc6K,GAA5B;;EAEA,QAAMxB,OAAO4B,mBAAmBnL,MAAnB,EAA2BmB,EAA3B,EAA+BiK,MAA/B,EAAuC5H,CAAvC,CAAb;EACA,QAAM4E,QAAQ;EACZC,UAAI7E,CADQ;EAEZ+F,YAAMA,IAFM;EAGZjB,YAAM8C,OAAO7B,KAAKnJ,IAAZ,CAHM;EAIZuK,YAAMS,OAAO7B,KAAKpJ,KAAZ,CAJM;EAKZyK,YAAM,CALM;EAMZC,YAAMG,EAAEhL,MAAF;EANM,KAAd;;EASA;EACAoI,UAAMC,EAAN,CAAS,CAAT,IAAcW,KAAKC,GAAL,CAASD,KAAKE,GAAL,CAASd,MAAME,IAAf,EAAqB9E,EAAE,CAAF,CAArB,CAAT,EAAqC4E,MAAMuC,IAA3C,CAAd;EACAvC,UAAMG,EAAN,GAAWH,MAAMC,EAAN,CAAS/I,KAAT,EAAX;;EAEA4B,UAAMkI,MAAN,CAAaG,KAAK1I,CAAlB,IAAuBuH,KAAvB;EACAlH,UAAMkI,MAAN,CAAaW,MAAb,GAAsBR,KAAK1I,CAA3B;EACD,GAtBmB;EAAA,CAApB;;ECLA,IAAMoC,eAAa,SAAbA,UAAa,CAACK,UAAD,EAAapC,KAAb,EAAoBlB,MAApB,EAA4BmB,EAA5B,EAAgCoD,MAAhC;EAAA,SAA2C,YAAM;EAClE,QAAMmF,MAAMlI,OAAOmI,mBAAP,CAA2BzI,MAAMkI,MAAjC,EAAyC1F,MAAzC,CAAgD;EAAA,aAAK,CAACkG,MAAMhJ,CAAN,CAAN;EAAA,KAAhD,CAAZ;;EAEA8I,QAAI/I,OAAJ,CAAY,aAAK;EACfO,YAAMkI,MAAN,CAAaW,MAAb,GAAsBnJ,CAAtB;EACAkJ,kBAAY5I,KAAZ,EAAmBC,EAAnB;EACD,KAHD;EAIA8I,cAAU3G,UAAV,EAAsBpC,KAAtB,EAA6BlB,MAA7B,EAAqCmB,EAArC,EAAyCoD,MAAzC;EACD,GARkB;EAAA,CAAnB;;ECHA;EACA,IAAMiH,cAAc,SAAdA,WAAc;EAAA,SAAc,UAACC,KAAD,EAAQC,MAAR,EAAmB;EACnD,QAAMjK,OAAOD,OAAOC,IAAP,CAAYC,UAAZ,CAAb;;EAEA,WAAOD,KAAK0C,IAAL,CACL,UAACvD,CAAD,EAAIC,CAAJ;EAAA,aACED,MAAM6K,KAAN,GAAc5K,IAAIA,CAAJ,GAAQY,KAAK7B,MAAb,IAAuB8B,WAAWb,IAAI,CAAf,MAAsB6K,MAA3D,GAAoE,KADtE;EAAA,KADK,CAAP;EAID,GAPmB;EAAA,CAApB;;ECSA,IAAMjG,YAAU,SAAVA,OAAU,CAACnC,UAAD,EAAapC,KAAb,EAAoBlB,MAApB,EAA4BmB,EAA5B,EAAgCoD,MAAhC,EAAwC6G,MAAxC;EAAA,SAAmD,YAAM;EACvE,QAAIjK,GAAGoB,CAAH,OAAWR,SAAX,IAAwBZ,GAAGoB,CAAH,OAAW,IAAvC,EAA6C;EAC3CpB,SAAGuE,UAAH;EACD;;EAED,QAAM8E,QAAQC,aAAd;;EAEA;EACA;EACAvJ,UAAMkI,MAAN,CAAaW,MAAb,GAAsBhI,SAAtB;EACA;EACA;EACA;EACA;EACAb,UAAMkI,MAAN,CAAanJ,KAAb,GAAqB;EAAA,aACnBiB,MAAMkI,MAAN,CAAa/C,EAAb,MAAqBtE,SAArB,GACIA,SADJ,GAEIb,MAAMkI,MAAN,CAAa/C,EAAb,EAAiBsE,IAAjB,GAAwBzJ,MAAMkI,MAAN,CAAa/C,EAAb,EAAiBiC,IAH1B;EAAA,KAArB;;EAKAnH,OAAGmE,EAAH,CAAM,oBAAN,EAA4B,YAAM;EAChC,UAAMoE,MAAMlI,OAAOmI,mBAAP,CAA2BzI,MAAMkI,MAAjC,EAAyC1F,MAAzC,CAAgD;EAAA,eAAK,CAACkG,MAAMhJ,CAAN,CAAN;EAAA,OAAhD,CAAZ;;EAEA,UAAI8I,IAAI9J,MAAJ,GAAa,CAAjB,EAAoB;EAClB;EACA8J,YAAI/I,OAAJ,CAAY,aAAK;EACf,cAAM4I,OAAOrI,MAAMkI,MAAN,CAAaxI,CAAb,EAAgB2I,IAA7B;EACArI,gBAAMkI,MAAN,CAAaW,MAAb,GAAsBnJ,CAAtB;EACA;EACA;EACA,cAAI,CAAC4K,YAAYxL,OAAO0B,UAAnB,EAA+B6H,KAAKnJ,IAApC,EAA0CmJ,KAAKpJ,KAA/C,CAAL,EAA4D;EAC1D2J,wBAAY5I,KAAZ,EAAmBC,EAAnB;EACD;EACF,SARD;EASA8I,kBAAU3G,UAAV,EAAsBpC,KAAtB,EAA6BlB,MAA7B,EAAqCmB,EAArC,EAAyCoD,MAAzC;EACD;EACF,KAhBD;;EAkBA;EACApD,OAAGb,SAAH,CACGoC,MADH,CACU,KADV,EAEGiD,MAFH,CAEU,GAFV,EAGGC,IAHH,CAGQ,IAHR,EAGc,QAHd,EAIGA,IAJH,CAKI,WALJ,EAMI,eAAe5F,OAAOE,MAAP,CAAcE,IAA7B,GAAoC,GAApC,GAA0CJ,OAAOE,MAAP,CAAc6K,GAAxD,GAA8D,GANlE;;EASA;EACA5J,OAAG8B,UAAH,GAAgBA,aAAWK,UAAX,EAAuBpC,KAAvB,EAA8BlB,MAA9B,EAAsCmB,EAAtC,EAA0CoD,MAA1C,CAAhB;;EAEAiG,UACGlF,EADH,CACM,OADN,EACegG,YAAYpK,KAAZ,EAAmBlB,MAAnB,EAA2BmB,EAA3B,EAA+BiK,MAA/B,CADf,EAEG9F,EAFH,CAEM,MAFN,EAEcwF,OAAOxH,UAAP,EAAmBpC,KAAnB,EAA0BlB,MAA1B,EAAkCmB,EAAlC,EAAsCoD,MAAtC,CAFd,EAGGe,EAHH,CAGM,KAHN,EAGa2E,UAAU3G,UAAV,EAAsBpC,KAAtB,EAA6BlB,MAA7B,EAAqCmB,EAArC,EAAyCoD,MAAzC,CAHb;;EAKA;EACA;EACA;EACArD,UAAMgH,SAAN,GAAkB/G,GAAGb,SAAH,CACfoC,MADe,CACR,KADQ,EAEf6D,MAFe,CAER,MAFQ,EAEA,UAFA,EAGfX,IAHe,CAGV,IAHU,EAGJ,cAHI,EAIfA,IAJe,CAIV,GAJU,EAIL5F,OAAOE,MAAP,CAAcE,IAJT,EAKfwF,IALe,CAKV,GALU,EAKL5F,OAAOE,MAAP,CAAc6K,GALT,EAMfnF,IANe,CAMV,OANU,EAMD7F,EAAEC,MAAF,CANC,EAOf4F,IAPe,CAOV,QAPU,EAOAoF,EAAEhL,MAAF,IAAY,CAPZ,EAQf6F,KARe,CAQT,SARS,EAQE,CARF,EASflD,IATe,CASV6H,KATU,CAAlB;EAUD,GApEe;EAAA,CAAhB;;ECNA,IAAMmB,kBAAkB,SAAlBA,eAAkB,CAACrI,UAAD,EAAatD,MAAb,EAAqBmB,EAArB,EAAyBoD,MAAzB,EAAiC6G,MAAjC,EAA4C;EAClE,MAAMlK,QAAQ;EACZkI,YAAQ,EADI;EAEZlB,eAAW;EAFC,GAAd;;EAKA5E,aAAW2C,KAAX,CAAiB,WAAjB,IAAgC;EAC9BR,aAASA,UAAQnC,UAAR,EAAoBpC,KAApB,EAA2BlB,MAA3B,EAAmCmB,EAAnC,EAAuCoD,MAAvC,EAA+C6G,MAA/C,CADqB;EAE9BtF,eAAWA,YAAU5E,KAAV,EAAiBC,EAAjB,CAFmB;EAG9BkC,cAAUA,WAASC,UAAT,EAAqBpC,KAArB,EAA4BlB,MAA5B,CAHoB;EAI9BkG,gBAAY;EAAA,aAAMhF,MAAMkI,MAAZ;EAAA;EAJkB,GAAhC;EAMD,CAZD;;ECJA,IAAMtD,cAAY,SAAZA,SAAY,CAAC5E,KAAD,EAAQC,EAAR;EAAA,SAAe,YAAM;EACrCA,OAAGb,SAAH,CACGoC,MADH,CACU,KADV,EAEGA,MAFH,CAEU,QAFV,EAGGqD,MAHH;EAIA5E,OAAGb,SAAH,CACGoC,MADH,CACU,KADV,EAEGA,MAFH,CAEU,iBAFV,EAGGqD,MAHH;EAIA5E,OAAGmE,EAAH,CAAM,kBAAN,EAA0BvD,SAA1B;;EAEA,WAAOZ,GAAG8B,UAAV;;EAEA/B,UAAMgH,SAAN,GAAkBnG,SAAlB;EACD,GAdiB;EAAA,CAAlB;;ECAA,IAAM6J,cAAc,SAAdA,WAAc,CAACC,CAAD,EAAIpF,CAAJ;EAAA,SAAUuC,KAAK8C,IAAL,CAAUD,IAAIA,CAAJ,GAAQpF,IAAIA,CAAtB,CAAV;EAAA,CAApB;;ECEA;EACA,IAAMsF,cAAc,SAAdA,WAAc;EAAA,SAClBC,QAAQhD,KAAKiD,EAAb,GAAkB,MAAMjD,KAAKiD,EAAX,GAAgBD,KAAlC,GAA0C,MAAMhD,KAAKiD,EAAX,GAAgBD,KADxC;EAAA,CAApB;;EAGA;;;;;;EAMA,IAAM7D,oBAAkB,SAAlBA,eAAkB;EAAA,SAAO,aAAK;EAClC,QAAI+D,aAAaH,YAAYI,IAAID,UAAhB,CAAjB;EACA,QAAIE,WAAWL,YAAYI,IAAIC,QAAhB,CAAf;;EAEA,QAAIF,aAAaE,QAAjB,EAA2B;EACzB,UAAMC,MAAMH,UAAZ;EACAA,mBAAaE,QAAb;EACAA,iBAAWC,GAAX;EACD;;EAED;EACA,WAAOR,KAAKK,UAAL,IAAmBL,KAAKO,QAA/B;EACD,GAZuB;EAAA,CAAxB;;EAcA,IAAMjD,iBAAe,SAAfA,YAAe,CAACjI,KAAD,EAAQlB,MAAR;EAAA,SAAmB,UAACY,CAAD,EAAIyF,EAAJ,EAAW;EACjD,QAAM8F,MAAMjL,MAAMoL,IAAN,CAAWjG,EAAX,CAAZ;EAAA,QACEgD,OAAOlB,kBAAgBgE,GAAhB,CADT;EAAA,QAEE7C,KAAK6C,IAAI5C,IAAJ,CAASnJ,IAFhB;EAAA,QAGEoJ,KAAK2C,IAAI5C,IAAJ,CAASpJ,KAHhB;EAAA,QAIE2I,KAAK9I,OAAO0B,UAAP,CAAkB4H,EAAlB,EAAsBnH,MAJ7B;EAAA,QAKE4G,KAAK/I,OAAO0B,UAAP,CAAkB8H,EAAlB,EAAsBrH,MAL7B;EAAA,QAME0J,IAAI3K,MAAMoL,IAAN,CAAWrM,KAAX,CAAiBoG,EAAjB,CANN;EAAA,QAOEI,IAAIqC,GAAGlI,EAAE0I,EAAF,CAAH,IAAYP,GAAGnI,EAAE4I,EAAF,CAAH,CAPlB;EAAA,QAQE+C,IAAIX,YAAYC,CAAZ,EAAepF,CAAf,CARN;EAAA,QASEuF,QAAQhD,KAAKwD,IAAL,CAAU/F,IAAI8F,CAAd,CATV,CADiD;EAWjD,WAAOlD,KAAK2C,KAAL,CAAP;EACD,GAZoB;EAAA,CAArB;;EAcA,IAAM3I,aAAW,SAAXA,QAAW,CAACC,UAAD,EAAapC,KAAb,EAAoBlB,MAApB,EAA+B;EAC9C,MAAM0J,MAAMlI,OAAOmI,mBAAP,CAA2BzI,MAAMoL,IAAjC,EAAuC5I,MAAvC,CAA8C;EAAA,WAAK,CAACkG,MAAMhJ,CAAN,CAAN;EAAA,GAA9C,CAAZ;EACA,MAAMuC,UAAUnD,OAAOnB,IAAvB;;EAEA,MAAI6K,IAAI9J,MAAJ,KAAe,CAAnB,EAAsB;EACpB,WAAOuD,OAAP;EACD;;EAED,MAAM0G,YAAYV,eAAajI,KAAb,EAAoBlB,MAApB,CAAlB;;EAEA,SAAOmD,QAAQO,MAAR,CAAe,aAAK;EACzB,YAAQJ,WAAWW,SAAnB;EACE,WAAK,KAAL;EACE,eAAOyF,IAAIxF,KAAJ,CAAU;EAAA,iBAAM2F,UAAUjJ,CAAV,EAAayF,EAAb,CAAN;EAAA,SAAV,CAAP;EACF,WAAK,IAAL;EACE,eAAOqD,IAAIvF,IAAJ,CAAS;EAAA,iBAAM0F,UAAUjJ,CAAV,EAAayF,EAAb,CAAN;EAAA,SAAT,CAAP;EACF;EACE,cAAM,IAAIjC,KAAJ,CAAU,6BAA6BpE,OAAOqE,cAA9C,CAAN;EANJ;EAQD,GATM,CAAP;EAUD,CApBD;;ECxCA,IAAMyF,gBAAc,SAAdA,WAAc,CAAC5I,KAAD,EAAQC,EAAR,EAAe;EACjC,MAAMgL,MAAMjL,MAAMoL,IAAN,CAAWpL,MAAMoL,IAAN,CAAWvC,MAAtB,CAAZ;EAAA,MACEC,MAAM7I,GAAGb,SAAH,CAAaoC,MAAb,CAAoB,KAApB,EAA2BA,MAA3B,CAAkC,QAAlC,CADR;;EAGA,SAAOxB,MAAMoL,IAAN,CAAWpL,MAAMoL,IAAN,CAAWvC,MAAtB,CAAP;EACA7I,QAAMoL,IAAN,CAAWvC,MAAX,GAAoBhI,SAApB;EACAiI,MAAIxH,SAAJ,CAAc,cAAc2J,IAAI5C,IAAJ,CAAS1I,CAArC,EAAwCkF,MAAxC;EACAiE,MAAIxH,SAAJ,CAAc,gBAAgB2J,IAAI5C,IAAJ,CAAS1I,CAAvC,EAA0CkF,MAA1C;EACAiE,MAAIxH,SAAJ,CAAc,cAAc2J,IAAI5C,IAAJ,CAAS1I,CAArC,EAAwCkF,MAAxC;EACD,CATD;;ECGA,IAAMkE,cAAY,SAAZA,SAAY,CAAC3G,UAAD,EAAapC,KAAb,EAAoBlB,MAApB,EAA4BmB,EAA5B,EAAgCoD,MAAhC;EAAA,SAA2C,YAAM;EACjE,QAAM4H,MAAMjL,MAAMoL,IAAN,CAAWpL,MAAMoL,IAAN,CAAWvC,MAAtB,CAAZ;;EAEA;EACA;EACA,QAAIoC,OAAOA,IAAI9D,EAAJ,CAAO,CAAP,MAAc8D,IAAI5D,EAAJ,CAAO,CAAP,CAArB,IAAkC4D,IAAI9D,EAAJ,CAAO,CAAP,MAAc8D,IAAI5D,EAAJ,CAAO,CAAP,CAApD,EAA+D;EAC7DuB,oBAAY5I,KAAZ,EAAmBC,EAAnB;EACD;;EAED,QAAIgL,GAAJ,EAAS;EACP,UAAMH,QAAQ9K,MAAMoL,IAAN,CAAWJ,UAAX,CAAsBhL,MAAMoL,IAAN,CAAWvC,MAAjC,CAAd;;EAEAoC,UAAID,UAAJ,GAAiBF,KAAjB;EACAG,UAAIC,QAAJ,GAAeJ,KAAf;EACAG,UAAIA,GAAJ,CACGM,WADH,CACevL,MAAMoL,IAAN,CAAW1M,MAAX,CAAkBsB,MAAMoL,IAAN,CAAWvC,MAA7B,CADf,EAEGmC,UAFH,CAEcF,KAFd,EAGGI,QAHH,CAGYJ,KAHZ;EAID;;EAED9K,UAAMoL,IAAN,CAAWvC,MAAX,GAAoBhI,SAApB;EACA/B,WAAOmD,OAAP,GAAiBE,WAASC,UAAT,EAAqBpC,KAArB,EAA4BlB,MAA5B,CAAjB;EACAmB,OAAG6B,aAAH;EACAuB,WAAO5B,IAAP,CAAY,UAAZ,EAAwBxB,EAAxB,EAA4BnB,OAAOmD,OAAnC;EACD,GAxBiB;EAAA,CAAlB;;ECCA,IAAM+G,cAAY,SAAZA,SAAY,CAAC5G,UAAD,EAAapC,KAAb,EAAoBlB,MAApB,EAA4BmB,EAA5B,EAAgCoD,MAAhC,EAAwC4H,GAAxC,EAA6ChC,WAA7C,EAA6D;EAC7E,MAAMH,MAAM7I,GAAGb,SAAH,CAAaoC,MAAb,CAAoB,KAApB,EAA2BA,MAA3B,CAAkC,QAAlC,CAAZ;EAAA,MACE2D,KAAK8F,IAAI5C,IAAJ,CAAS1I,CADhB;EAAA,MAEEwJ,SAAS,CAAC8B,IAAI5D,EAAL,EAAS4D,IAAIO,EAAb,CAFX;EAAA,MAGEpC,QAAQN,IACLxH,SADK,CACK,cAAc6D,EADnB,EAELxH,IAFK,CAEA,CAAC,EAAEwJ,IAAI8D,IAAI9D,EAAV,EAAcE,IAAI4D,IAAI5D,EAAtB,EAAD,EAA6B,EAAEF,IAAI8D,IAAI9D,EAAV,EAAcE,IAAI4D,IAAIO,EAAtB,EAA7B,CAFA,CAHV;EAAA,MAMEnC,UAAUP,IAAIxH,SAAJ,CAAc,gBAAgB6D,EAA9B,EAAkCxH,IAAlC,CAAuCwL,MAAvC,CANZ;EAAA,MAOEG,QAAQC,aAPV;EAAA,MAQEkC,QAAQ3C,IAAIxH,SAAJ,CAAc,cAAc6D,EAA5B,EAAgCxH,IAAhC,CAAqC,CAACsN,GAAD,CAArC,CARV;;EAUAQ,QACGrG,KADH,GAEGX,MAFH,CAEU,MAFV,EAGGC,IAHH,CAGQ,IAHR,EAGc,SAASS,EAHvB,EAIGT,IAJH,CAIQ,OAJR,EAIiB,KAJjB,EAKGC,KALH,CAKS,MALT,EAKiB,QALjB,EAMGA,KANH,CAMS,SANT,EAMoB,GANpB;;EAQA8G,QACG/G,IADH,CACQ,GADR,EACauG,IAAIA,GADjB,EAEGvG,IAFH,CAEQ,WAFR,EAEqB,eAAeuG,IAAI9D,EAAJ,CAAO,CAAP,CAAf,GAA2B,GAA3B,GAAiC8D,IAAI9D,EAAJ,CAAO,CAAP,CAAjC,GAA6C,GAFlE;;EAIAiC,QACGhE,KADH,GAEGX,MAFH,CAEU,MAFV,EAGGC,IAHH,CAGQ,IAHR,EAGc,SAASS,EAHvB,EAIGT,IAJH,CAIQ,OAJR,EAIiB,KAJjB;;EAMA0E,QACG1E,IADH,CACQ,IADR,EACc;EAAA,WAAKhF,EAAEyH,EAAF,CAAK,CAAL,CAAL;EAAA,GADd,EAEGzC,IAFH,CAEQ,IAFR,EAEc;EAAA,WAAKhF,EAAEyH,EAAF,CAAK,CAAL,CAAL;EAAA,GAFd,EAGGzC,IAHH,CAGQ,IAHR,EAGc;EAAA,WAAKhF,EAAE2H,EAAF,CAAK,CAAL,CAAL;EAAA,GAHd,EAIG3C,IAJH,CAIQ,IAJR,EAIc;EAAA,WAAKhF,EAAE2H,EAAF,CAAK,CAAL,CAAL;EAAA,GAJd,EAKG3C,IALH,CAKQ,QALR,EAKkB,OALlB,EAMGA,IANH,CAMQ,cANR,EAMwB,CANxB;;EAQA4E,QACGlF,EADH,CACM,MADN,EACc,UAAC1E,CAAD,EAAIC,CAAJ,EAAU;EACpB,QAAM6J,KAAKtH,iBAAX;EACAvC,QAAIA,IAAI,CAAR;;EAEAsL,QAAI,MAAMtL,CAAV,EAAa,CAAb,IAAkBmI,KAAKC,GAAL,CAASD,KAAKE,GAAL,CAASiD,IAAI7D,IAAJ,GAAW,CAApB,EAAuBoC,GAAG9B,CAA1B,CAAT,EAAuCuD,IAAIxB,IAA3C,CAAlB;EACAwB,QAAI,MAAMtL,CAAV,EAAa,CAAb,IAAkBmI,KAAKC,GAAL,CAASD,KAAKE,GAAL,CAASiD,IAAIvB,IAAb,EAAmBF,GAAG7B,CAAtB,CAAT,EAAmCsD,IAAItB,IAAvC,CAAlB;;EAEA,QAAMmB,QACJnL,MAAM,CAAN,GAAUK,MAAMoL,IAAN,CAAWJ,UAAX,CAAsB7F,EAAtB,CAAV,GAAsCnF,MAAMoL,IAAN,CAAWF,QAAX,CAAoB/F,EAApB,CADxC;;EAGA,QACG8F,IAAID,UAAJ,GAAiBlD,KAAKiD,EAAtB,IACCE,IAAIC,QAAJ,GAAepD,KAAKiD,EADrB,IAECD,QAAQhD,KAAKiD,EAFf,IAGCE,IAAID,UAAJ,IAAkBlD,KAAKiD,EAAvB,IACCE,IAAIC,QAAJ,IAAgBpD,KAAKiD,EADtB,IAECD,SAAShD,KAAKiD,EANlB,EAOE;EACA,UAAIpL,MAAM,CAAV,EAAa;EACXsL,YAAIC,QAAJ,GAAeJ,KAAf;EACAG,YAAIA,GAAJ,CAAQC,QAAR,CAAiBJ,KAAjB;EACD,OAHD,MAGO,IAAInL,MAAM,CAAV,EAAa;EAClBsL,YAAID,UAAJ,GAAiBF,KAAjB;EACAG,YAAIA,GAAJ,CAAQD,UAAR,CAAmBF,KAAnB;EACD;EACF;;EAED9B,cAAU5G,UAAV,EAAsBpC,KAAtB,EAA6BlB,MAA7B,EAAqCmB,EAArC,EAAyCoD,MAAzC,EAAiD4H,GAAjD,EAAsDtL,IAAI,CAA1D;EACD,GA7BH,EA8BGyE,EA9BH,CA8BM,KA9BN,EA8Ba2E,YAAU3G,UAAV,EAAsBpC,KAAtB,EAA6BlB,MAA7B,EAAqCmB,EAArC,EAAyCoD,MAAzC,CA9Bb;;EAgCAgG,UACGjE,KADH,GAEGX,MAFH,CAEU,QAFV,EAGGC,IAHH,CAGQ,IAHR,EAGc,SAASS,EAHvB,EAIGT,IAJH,CAIQ,OAJR,EAIiB,KAJjB;;EAMA2E,UACG3E,IADH,CACQ,IADR,EACc;EAAA,WAAKhF,EAAE,CAAF,CAAL;EAAA,GADd,EAEGgF,IAFH,CAEQ,IAFR,EAEc;EAAA,WAAKhF,EAAE,CAAF,CAAL;EAAA,GAFd,EAGGgF,IAHH,CAGQ,GAHR,EAGa,CAHb,EAIGC,KAJH,CAKI,SALJ,EAMI,UAACjF,CAAD,EAAIC,CAAJ;EAAA,WAAWsJ,gBAAgBpI,SAAhB,IAA6BlB,MAAMsJ,WAAnC,GAAiD,GAAjD,GAAuD,CAAlE;EAAA,GANJ,EAQG7E,EARH,CAQM,WARN,EAQmB,YAAW;EAC1B5C,uBAAO,IAAP,EAAamD,KAAb,CAAmB,SAAnB,EAA8B,GAA9B;EACD,GAVH,EAWGP,EAXH,CAWM,UAXN,EAWkB,YAAW;EACzB5C,uBAAO,IAAP,EAAamD,KAAb,CAAmB,SAAnB,EAA8B,CAA9B;EACD,GAbH,EAcGlD,IAdH,CAcQ6H,KAdR;EAeD,CA1FD;;EA4FA,IAAMM,WAAS,SAATA,MAAS,CAACxH,UAAD,EAAapC,KAAb,EAAoBlB,MAApB,EAA4BmB,EAA5B,EAAgCoD,MAAhC;EAAA,SAA2C,YAAM;EAC9D,QAAMmG,KAAKtH,iBAAX;EAAA,QACE+I,MAAMjL,MAAMoL,IAAN,CAAWpL,MAAMoL,IAAN,CAAWvC,MAAtB,CADR;;EAGA;EACAoC,QAAI5D,EAAJ,CAAO,CAAP,IAAYS,KAAKC,GAAL,CACVD,KAAKE,GAAL,CAASiD,IAAI7D,IAAJ,GAAW,CAApB,EAAuBoC,GAAG9B,CAAH,GAAO5I,OAAOE,MAAP,CAAcE,IAA5C,CADU,EAEV+L,IAAIxB,IAFM,CAAZ;EAIAwB,QAAI5D,EAAJ,CAAO,CAAP,IAAYS,KAAKC,GAAL,CAASD,KAAKE,GAAL,CAASiD,IAAIvB,IAAb,EAAmBF,GAAG7B,CAAH,GAAO7I,OAAOE,MAAP,CAAc6K,GAAxC,CAAT,EAAuDoB,IAAItB,IAA3D,CAAZ;EACAsB,QAAIO,EAAJ,GAASP,IAAI5D,EAAJ,CAAOjJ,KAAP,EAAT;EACA4K,gBAAU5G,UAAV,EAAsBpC,KAAtB,EAA6BlB,MAA7B,EAAqCmB,EAArC,EAAyCoD,MAAzC,EAAiD4H,GAAjD,EAAsD,CAAtD;EACD,GAZc;EAAA,CAAf;;EC3FA;EACA;EACA;EACA;EACA,IAAMb,gBAAc,SAAdA,WAAc,CAACpK,KAAD,EAAQlB,MAAR,EAAgBmB,EAAhB,EAAoBiK,MAApB;EAAA,SAA+B,YAAM;EACvD,QAAM5H,IAAI+H,kBAAMrK,MAAMgH,SAAN,CAAgB7C,IAAhB,EAAN,CAAV;;EAEA7B,MAAE,CAAF,IAAOA,EAAE,CAAF,IAAOxD,OAAOE,MAAP,CAAcE,IAA5B;EACAoD,MAAE,CAAF,IAAOA,EAAE,CAAF,IAAOxD,OAAOE,MAAP,CAAc6K,GAA5B;;EAEA,QAAMxB,OAAO4B,mBAAmBnL,MAAnB,EAA2BmB,EAA3B,EAA+BiK,MAA/B,EAAuC5H,CAAvC,CAAb;EACA,QAAM2I,MAAM;EACV9D,UAAI7E,CADM;EAEV+F,YAAMA,IAFI;EAGVjB,YAAM8C,OAAO7B,KAAKnJ,IAAZ,CAHI;EAIVuK,YAAMS,OAAO7B,KAAKpJ,KAAZ,CAJI;EAKVyK,YAAM,CALI;EAMVC,YAAMG,EAAEhL,MAAF,CANI;EAOVkM,kBAAYnK,SAPF;EAQVqK,gBAAUrK,SARA;EASVoK,WAAKS,cAAQC,WAAR,CAAoB,CAApB;EATK,KAAZ;;EAYA;EACAV,QAAI9D,EAAJ,CAAO,CAAP,IAAYW,KAAKC,GAAL,CAASD,KAAKE,GAAL,CAASiD,IAAI7D,IAAb,EAAmB9E,EAAE,CAAF,CAAnB,CAAT,EAAmC2I,IAAIxB,IAAvC,CAAZ;EACAwB,QAAI5D,EAAJ,GAAS4D,IAAI9D,EAAJ,CAAO/I,KAAP,EAAT;EACA6M,QAAIO,EAAJ,GAASP,IAAI9D,EAAJ,CAAO/I,KAAP,EAAT;;EAEA4B,UAAMoL,IAAN,CAAW/C,KAAK1I,CAAhB,IAAqBsL,GAArB;EACAjL,UAAMoL,IAAN,CAAWvC,MAAX,GAAoBR,KAAK1I,CAAzB;EACD,GA1BmB;EAAA,CAApB;;ECNA,IAAMoC,eAAa,SAAbA,UAAa,CAACK,UAAD,EAAapC,KAAb,EAAoBlB,MAApB,EAA4BmB,EAA5B,EAAgCoD,MAAhC;EAAA,SAA2C,YAAM;EAClE,QAAMmF,MAAMlI,OAAOmI,mBAAP,CAA2BzI,MAAMoL,IAAjC,EAAuC5I,MAAvC,CAA8C;EAAA,aAAK,CAACkG,MAAMhJ,CAAN,CAAN;EAAA,KAA9C,CAAZ;;EAEA8I,QAAI/I,OAAJ,CAAY,aAAK;EACfO,YAAMoL,IAAN,CAAWvC,MAAX,GAAoBnJ,CAApB;EACAkJ,oBAAY5I,KAAZ,EAAmBC,EAAnB;EACD,KAHD;EAIA8I,gBAAU3G,UAAV,EAAsBpC,KAAtB,EAA6BlB,MAA7B,EAAqCmB,EAArC,EAAyCoD,MAAzC;EACD,GARkB;EAAA,CAAnB;;ECSA;EACA,IAAMyH,QAAQ,SAARA,KAAQ,CAAC3D,EAAD,EAAKE,EAAL,EAAY;EACxB,MAAMsD,IAAIxD,GAAG,CAAH,IAAQE,GAAG,CAAH,CAAlB;EAAA,MACE9B,IAAI4B,GAAG,CAAH,IAAQE,GAAG,CAAH,CADd;EAAA,MAEEgE,IAAIX,YAAYC,CAAZ,EAAepF,CAAf,CAFN;;EAIA,SAAOuC,KAAKwD,IAAL,CAAU/F,IAAI8F,CAAd,CAAP;EACD,CAND;;EAQA,IAAMH,WAAW,SAAXA,QAAW;EAAA,SAAS,cAAM;EAC9B,QAAMD,MAAMjL,MAAMoL,IAAN,CAAWjG,EAAX,CAAZ;EACA,QAAI8F,QAAQpK,SAAZ,EAAuB;EACrB,aAAOA,SAAP;EACD;EACD,QAAI+K,SAASd,MAAMG,IAAI9D,EAAV,EAAc8D,IAAI5D,EAAlB,CAAb;EAAA,QACEwE,SAAS,CAACD,MAAD,GAAU9D,KAAKiD,EAAL,GAAU,CAD/B;;EAGA,QAAIE,IAAI9D,EAAJ,CAAO,CAAP,IAAY8D,IAAI5D,EAAJ,CAAO,CAAP,CAAhB,EAA2B;EACzBwE,eAAS,IAAI/D,KAAKiD,EAAT,GAAcc,MAAvB;EACD;;EAED,WAAOA,MAAP;EACD,GAbgB;EAAA,CAAjB;;EAeA,IAAMb,aAAa,SAAbA,UAAa;EAAA,SAAS,cAAM;EAChC,QAAMC,MAAMjL,MAAMoL,IAAN,CAAWjG,EAAX,CAAZ;EACA,QAAI8F,QAAQpK,SAAZ,EAAuB;EACrB,aAAOA,SAAP;EACD;;EAED,QAAI+K,SAASd,MAAMG,IAAI9D,EAAV,EAAc8D,IAAIO,EAAlB,CAAb;EAAA,QACEK,SAAS,CAACD,MAAD,GAAU9D,KAAKiD,EAAL,GAAU,CAD/B;;EAGA,QAAIE,IAAI9D,EAAJ,CAAO,CAAP,IAAY8D,IAAIO,EAAJ,CAAO,CAAP,CAAhB,EAA2B;EACzBK,eAAS,IAAI/D,KAAKiD,EAAT,GAAcc,MAAvB;EACD;;EAED,WAAOA,MAAP;EACD,GAdkB;EAAA,CAAnB;;EAgBA,IAAMnN,SAAS,SAATA,MAAS;EAAA,SAAS,cAAM;EAC5B,QAAMuM,MAAMjL,MAAMoL,IAAN,CAAWjG,EAAX,CAAZ;;EAEA,QAAI8F,QAAQpK,SAAZ,EAAuB;EACrB,aAAOA,SAAP;EACD;;EAED,QAAM8J,IAAIM,IAAI9D,EAAJ,CAAO,CAAP,IAAY8D,IAAI5D,EAAJ,CAAO,CAAP,CAAtB;EAAA,QACE9B,IAAI0F,IAAI9D,EAAJ,CAAO,CAAP,IAAY8D,IAAI5D,EAAJ,CAAO,CAAP,CADlB;;EAGA,WAAOqD,YAAYC,CAAZ,EAAepF,CAAf,CAAP;EACD,GAXc;EAAA,CAAf;;EAaA,IAAMhB,YAAU,SAAVA,OAAU,CAACnC,UAAD,EAAapC,KAAb,EAAoBlB,MAApB,EAA4BmB,EAA5B,EAAgCoD,MAAhC,EAAwC6G,MAAxC;EAAA,SAAmD,YAAM;EACvE,QAAI,CAACjK,GAAGoB,CAAH,EAAL,EAAa;EACXpB,SAAGuE,UAAH;EACD;;EAED,QAAM8E,QAAQC,aAAd;;EAEA;EACA;EACAvJ,UAAMoL,IAAN,CAAWvC,MAAX,GAAoBhI,SAApB;EACA;EACA;EACA;EACA;EACAb,UAAMoL,IAAN,CAAWrM,KAAX,GAAmB,cAAM;EACvB,UAAMkM,MAAMjL,MAAMoL,IAAN,CAAWjG,EAAX,CAAZ;EACA,aAAO8F,QAAQpK,SAAR,GAAoBA,SAApB,GAAgCoK,IAAIxB,IAAJ,GAAWwB,IAAI7D,IAAtD;EACD,KAHD;;EAKA;EACApH,UAAMoL,IAAN,CAAWF,QAAX,GAAsBA,SAASlL,KAAT,CAAtB;EACAA,UAAMoL,IAAN,CAAWJ,UAAX,GAAwBA,WAAWhL,KAAX,CAAxB;EACAA,UAAMoL,IAAN,CAAW1M,MAAX,GAAoBA,OAAOsB,KAAP,CAApB;;EAEAC,OAAGmE,EAAH,CAAM,kBAAN,EAA0B,YAAM;EAC9B,UAAMoE,MAAMlI,OAAOmI,mBAAP,CAA2B2C,IAA3B,EAAiC5I,MAAjC,CAAwC;EAAA,eAAK,CAACkG,MAAMhJ,CAAN,CAAN;EAAA,OAAxC,CAAZ;;EAEA,UAAI8I,IAAI9J,MAAJ,GAAa,CAAjB,EAAoB;EAClB;EACA8J,YAAI/I,OAAJ,CAAY,aAAK;EACf,cAAM4I,OAAO+C,KAAK1L,CAAL,EAAQ2I,IAArB;EACArI,gBAAMoL,IAAN,CAAWvC,MAAX,GAAoBnJ,CAApB;EACA;EACA;EACA,cAAI,CAAC4K,YAAYjC,IAAZ,EAAkBA,KAAKnJ,IAAvB,EAA6BmJ,KAAKpJ,KAAlC,CAAL,EAA+C;EAC7C2J,0BAAY5I,KAAZ,EAAmBC,EAAnB;EACD;EACF,SARD;EASA8I,oBAAU3G,UAAV,EAAsBpC,KAAtB,EAA6BlB,MAA7B,EAAqCmB,EAArC,EAAyCoD,MAAzC;EACD;EACF,KAhBD;;EAkBA;EACApD,OAAGb,SAAH,CACGoC,MADH,CACU,KADV,EAEGiD,MAFH,CAEU,GAFV,EAGGC,IAHH,CAGQ,IAHR,EAGc,MAHd,EAIGA,IAJH,CAKI,WALJ,EAMI,eAAe5F,OAAOE,MAAP,CAAcE,IAA7B,GAAoC,GAApC,GAA0CJ,OAAOE,MAAP,CAAc6K,GAAxD,GAA8D,GANlE;;EASA;EACA5J,OAAG8B,UAAH,GAAgBA,aAAWK,UAAX,EAAuBpC,KAAvB,EAA8BlB,MAA9B,EAAsCmB,EAAtC,EAA0CoD,MAA1C,CAAhB;;EAEAiG,UACGlF,EADH,CACM,OADN,EACegG,cAAYpK,KAAZ,EAAmBlB,MAAnB,EAA2BmB,EAA3B,EAA+BiK,MAA/B,CADf,EAEG9F,EAFH,CAEM,MAFN,EAEcwF,SAAOxH,UAAP,EAAmBpC,KAAnB,EAA0BlB,MAA1B,EAAkCmB,EAAlC,EAAsCoD,MAAtC,CAFd,EAGGe,EAHH,CAGM,KAHN,EAGa2E,YAAU3G,UAAV,EAAsBpC,KAAtB,EAA6BlB,MAA7B,EAAqCmB,EAArC,EAAyCoD,MAAzC,CAHb;;EAKA;EACA;EACA;EACArD,UAAMgH,SAAN,GAAkB/G,GAAGb,SAAH,CACfoC,MADe,CACR,KADQ,EAEf6D,MAFe,CAER,MAFQ,EAEA,QAFA,EAGfX,IAHe,CAGV,IAHU,EAGJ,YAHI,EAIfA,IAJe,CAIV,GAJU,EAIL5F,OAAOE,MAAP,CAAcE,IAJT,EAKfwF,IALe,CAKV,GALU,EAKL5F,OAAOE,MAAP,CAAc6K,GALT,EAMfnF,IANe,CAMV,OANU,EAMD7F,EAAEC,MAAF,CANC,EAOf4F,IAPe,CAOV,QAPU,EAOAoF,EAAEhL,MAAF,IAAY,CAPZ,EAQf6F,KARe,CAQT,SARS,EAQE,CARF,EASflD,IATe,CASV6H,KATU,CAAlB;EAUD,GAzEe;EAAA,CAAhB;;EC7DA,IAAMwC,sBAAsB,SAAtBA,mBAAsB,CAAC1J,UAAD,EAAatD,MAAb,EAAqBmB,EAArB,EAAyBoD,MAAzB,EAAiC6G,MAAjC,EAA4C;EACtE,MAAMlK,QAAQ;EACZoL,UAAM,EADM;EAEZpE,eAAW;EAFC,GAAd;;EAKA5E,aAAW2C,KAAX,CAAiB,SAAjB,IAA8B;EAC5BR,aAASA,UAAQnC,UAAR,EAAoBpC,KAApB,EAA2BlB,MAA3B,EAAmCmB,EAAnC,EAAuCoD,MAAvC,EAA+C6G,MAA/C,CADmB;EAE5BtF,eAAWA,YAAU5E,KAAV,EAAiBC,EAAjB,CAFiB;EAG5BkC,cAAUA,WAASC,UAAT,EAAqBpC,KAArB,EAA4BlB,MAA5B,CAHkB;EAI5BkG,gBAAY;EAAA,aAAMhF,MAAMoL,IAAZ;EAAA;EAJgB,GAA9B;EAMD,CAZD;;ECJA;EACA;EACA,IAAMW,eAAe,SAAfA,YAAe,CAACpB,CAAD,EAAIpF,CAAJ,EAAO8F,CAAP,EAAU3L,CAAV,EAAgB;EACnC,SAAO;EACLgI,OACE,CAAC,CAACiD,EAAEjD,CAAF,GAAMnC,EAAEoC,CAAR,GAAYgD,EAAEhD,CAAF,GAAMpC,EAAEmC,CAArB,KAA2B2D,EAAE3D,CAAF,GAAMhI,EAAEgI,CAAnC,IACC,CAACiD,EAAEjD,CAAF,GAAMnC,EAAEmC,CAAT,KAAe2D,EAAE3D,CAAF,GAAMhI,EAAEiI,CAAR,GAAY0D,EAAE1D,CAAF,GAAMjI,EAAEgI,CAAnC,CADF,KAEC,CAACiD,EAAEjD,CAAF,GAAMnC,EAAEmC,CAAT,KAAe2D,EAAE1D,CAAF,GAAMjI,EAAEiI,CAAvB,IAA4B,CAACgD,EAAEhD,CAAF,GAAMpC,EAAEoC,CAAT,KAAe0D,EAAE3D,CAAF,GAAMhI,EAAEgI,CAAvB,CAF7B,CAFG;EAKLC,OACE,CAAC,CAACgD,EAAEjD,CAAF,GAAMnC,EAAEoC,CAAR,GAAYgD,EAAEhD,CAAF,GAAMpC,EAAEmC,CAArB,KAA2B2D,EAAE1D,CAAF,GAAMjI,EAAEiI,CAAnC,IACC,CAACgD,EAAEhD,CAAF,GAAMpC,EAAEoC,CAAT,KAAe0D,EAAE3D,CAAF,GAAMhI,EAAEiI,CAAR,GAAY0D,EAAE1D,CAAF,GAAMjI,EAAEgI,CAAnC,CADF,KAEC,CAACiD,EAAEjD,CAAF,GAAMnC,EAAEmC,CAAT,KAAe2D,EAAE1D,CAAF,GAAMjI,EAAEiI,CAAvB,IAA4B,CAACgD,EAAEhD,CAAF,GAAMpC,EAAEoC,CAAT,KAAe0D,EAAE3D,CAAF,GAAMhI,EAAEgI,CAAvB,CAF7B;EANG,GAAP;EAUD,CAXD;;ECAA;EACA;EACA,IAAMsE,iBAAiB,SAAjBA,cAAiB;EAAA,SAAM,oBAAY;EACvC;EACA,QAAMC,mBAAmBC,OAAOD,gBAAP,IAA2B,CAApD;;EAEA;EACA,QAAME,eAAevG,SAASwG,aAAT,CAAuB,QAAvB,CAArB;;EAEA,QAAMC,mBAAmBpM,GAAGqM,MAAH,CAAUC,UAAnC;EACA;EACA,QAAMC,mBAAmBC,OACvBJ,iBAAiB1H,KAAjB,CAAuB+H,UAAvB,CAAkCC,OAAlC,CAA0C,IAA1C,EAAgD,EAAhD,CADuB,CAAzB;;EAIA,QAAMC,gBAAgB,EAAtB;EACA,QAAMC,kBACJJ,OAAOJ,iBAAiB1H,KAAjB,CAAuBmI,SAAvB,CAAiCH,OAAjC,CAAyC,IAAzC,EAA+C,EAA/C,CAAP,IAA6DC,aAD/D;EAEA,QAAM7N,QACJ,CAACsN,iBAAiBU,WAAjB,GAA+BP,gBAAhC,IAAoDP,gBADtD;EAEA,QAAMlC,SACJ,CAACsC,iBAAiBW,YAAjB,GAAgCH,eAAjC,IAAoDZ,gBADtD;EAEAE,iBAAapN,KAAb,GAAqBA,QAAQ,EAA7B,CApBuC;EAqBvCoN,iBAAapC,MAAb,GAAsBA,SAAS,EAA/B,CArBuC;EAsBvCoC,iBAAaxH,KAAb,CAAmB5F,KAAnB,GAA2BoN,aAAapN,KAAb,GAAqBkN,gBAArB,GAAwC,IAAnE;EACAE,iBAAaxH,KAAb,CAAmBoF,MAAnB,GAA4BoC,aAAapC,MAAb,GAAsBkC,gBAAtB,GAAyC,IAArE;;EAEA;EACA,QAAMgB,UAAUd,aAAae,UAAb,CAAwB,IAAxB,CAAhB;EACAD,YAAQE,SAAR,GAAoB,SAApB;EACAF,YAAQG,QAAR,CAAiB,CAAjB,EAAoB,CAApB,EAAuBjB,aAAapN,KAApC,EAA2CoN,aAAapC,MAAxD;;EAEA;EACA,SAAK,IAAMsD,GAAX,IAAkBpN,GAAGqM,MAArB,EAA6B;EAC3BW,cAAQK,SAAR,CACErN,GAAGqM,MAAH,CAAUe,GAAV,CADF,EAEEb,mBAAmBP,gBAFrB,EAGEY,kBAAkBZ,gBAHpB,EAIElN,QAAQyN,mBAAmBP,gBAJ7B,EAKElC,SAAS8C,kBAAkBZ,gBAL7B;EAOD;;EAED;EACA,QAAMsB,SAASrB,OAAOsB,GAAP,IAActB,OAAOuB,SAArB,IAAkCvB,MAAjD;EACA,QAAMwB,aAAa,IAAIC,aAAJ,EAAnB;EACA;EACA;EACA,QAAMC,cAAc3N,GAAGb,SAAH,CACjBoC,MADiB,CACV,KADU,EAEjB2C,IAFiB,GAGjB0J,SAHiB,CAGP,IAHO,CAApB;EAIAD,gBAAYE,YAAZ,CAAyB,WAAzB,EAAsC,iBAAiBlB,aAAjB,GAAiC,GAAvE;EACAgB,gBAAYE,YAAZ,CACE,QADF,EAEEF,YAAYG,YAAZ,CAAyB,QAAzB,IAAqCnB,aAFvC;EAIA;EACA;EACA;EACApL,uBAAOoM,WAAP,EACGtM,SADH,CACa,MADb,EAEGoD,IAFH,CAEQ,MAFR,EAEgB,OAFhB;EAGA,QAAMsJ,SAASN,WAAWO,iBAAX,CAA6BL,WAA7B,CAAf;;EAEA;EACA,QAAMM,MAAM,+BAA+BhC,OAAOiC,IAAP,CAAYH,MAAZ,CAA3C;EACA,QAAMI,MAAM,IAAIC,KAAJ,EAAZ;EACAD,QAAIE,MAAJ,GAAa,YAAM;EACjBrB,cAAQK,SAAR,CACEc,GADF,EAEE,CAFF,EAGE,CAHF,EAIEA,IAAIrP,KAAJ,GAAYkN,gBAJd,EAKEmC,IAAIrE,MAAJ,GAAakC,gBALf;EAOA,UAAI,OAAOsC,QAAP,KAAoB,UAAxB,EAAoC;EAClCA,iBAASpC,YAAT;EACD;EACF,KAXD;EAYAiC,QAAIF,GAAJ,GAAUA,GAAV;EACD,GA/EsB;EAAA,CAAvB;;ECFA,IAAM/L,aAAW,SAAXA,QAAW,CAACrD,MAAD,EAASmB,EAAT;EAAA,SAAgB,YAAM;EACrC,QAAIsC,UAAU,EAAd;EACA,QAAIrC,UAAU,EAAd;EACA,QAAIsO,SAAS,EAAb;EACA;EACA;EACA,QAAI1P,OAAOsB,OAAP,CAAe1B,MAAf,KAA0B,CAA9B,EAAiC;EAC/B,UAAI+P,QAAQxO,GACToB,CADS,GAETC,SAFS,CAEC,QAFD,EAGTmN,KAHS,EAAZ;EAIA,WAAK,IAAI7H,IAAI,CAAb,EAAgBA,IAAI6H,MAAM/P,MAA1B,EAAkCkI,GAAlC,EAAuC;EACrC,YAAI9F,uBAAe2N,MAAM7H,CAAN,CAAf,MAA6B,IAAjC,EAAuC;EACrCrE,kBAAQ3C,IAAR,CAAa6O,MAAM7H,CAAN,EAAS8H,QAAtB;EACA,cAAIC,SAAS,EAAb;EACA,cAAIC,SAAS9N,uBAAe2N,MAAM7H,CAAN,CAAf,CAAb;EACA,cACE,OAAO9H,OAAO0B,UAAP,CAAkBiO,MAAM7H,CAAN,EAAS8H,QAA3B,EAAqCzN,MAArC,CAA4C3B,MAA5C,GAAqD,CAArD,CAAP,KACA,QAFF,EAGE;EACA,iBAAK,IAAIK,IAAI,CAAb,EAAgBA,IAAIiP,OAAOlQ,MAA3B,EAAmCiB,GAAnC,EAAwC;EACtC,kBACE4C,QAAQwD,QAAR,CAAiB0I,MAAM7H,CAAN,EAAS8H,QAA1B,KACA5P,OAAO+P,QAAP,CAAgB9I,QAAhB,CAAyB0I,MAAM7H,CAAN,EAAS8H,QAAlC,CAFF,EAGE;EACAC,uBAAO/O,IAAP,CACEd,OAAO0B,UAAP,CAAkBiO,MAAM7H,CAAN,EAAS8H,QAA3B,EAAqCzN,MAArC,CAA4CnB,MAA5C,CAAmD8O,OAAOjP,CAAP,CAAnD,CADF;EAGD,eAPD,MAOO,IAAIb,OAAO0B,UAAP,CAAkBiO,MAAM7H,CAAN,EAAS8H,QAA3B,EAAqCzN,MAArC,OAAkD,CAAtD,EAAyD;EAC9D0N,uBAAOG,OAAP,CACEhQ,OAAO0B,UAAP,CAAkBiO,MAAM7H,CAAN,EAAS8H,QAA3B,EAAqCzN,MAArC,CAA4CnB,MAA5C,CAAmD8O,OAAOjP,CAAP,CAAnD,CADF;EAGD;EACF;EACDO,oBAAQN,IAAR,CAAa+O,MAAb;EACA,iBAAK,IAAII,KAAK,CAAd,EAAiBA,KAAK7O,QAAQxB,MAA9B,EAAsCqQ,IAAtC,EAA4C;EAC1C,kBAAI7O,QAAQ6O,EAAR,EAAYrQ,MAAZ,KAAuB,CAA3B,EAA8B;EAC5BwB,wBAAQ6O,EAAR,IAAc,CAAC,CAAD,EAAI,CAAJ,CAAd;EACD;EACF;EACF,WAxBD,MAwBO;EACLP,mBAAOC,MAAM7H,CAAN,EAAS8H,QAAhB,IAA4B5N,uBAAe2N,MAAM7H,CAAN,CAAf,CAA5B;EACA,gBAAIoI,WAAWlQ,OAAO0B,UAAP,CAAkBiO,MAAM7H,CAAN,EAAS8H,QAA3B,EAAqCzN,MAArC,CAA4C1B,KAA5C,EAAf;EACA,gBAAI0P,YAAYnQ,OAAO0B,UAAP,CAAkBiO,MAAM7H,CAAN,EAAS8H,QAA3B,EAAqCzN,MAArC,CAA4C3B,MAA5C,EAAhB;EACA,iBAAK,IAAImH,IAAI,CAAb,EAAgBA,IAAIuI,SAAStQ,MAA7B,EAAqC+H,GAArC,EAA0C;EACxC,kBACEuI,SAASvI,CAAT,KAAemI,OAAO,CAAP,CAAf,IACAI,SAASvI,CAAT,KAAemI,OAAO,CAAP,CADf,IAEArM,QAAQwD,QAAR,CAAiB0I,MAAM7H,CAAN,EAAS8H,QAA1B,CAFA,IAGA5P,OAAO+P,QAAP,CAAgB9I,QAAhB,CAAyB0I,MAAM7H,CAAN,EAAS8H,QAAlC,CAJF,EAKE;EACAC,uBAAO/O,IAAP,CAAYoP,SAASvI,CAAT,CAAZ;EACD,eAPD,MAOO,IAAIuI,SAASvI,CAAT,KAAemI,OAAO,CAAP,CAAf,IAA4BI,SAASvI,CAAT,KAAemI,OAAO,CAAP,CAA/C,EAA0D;EAC/DD,uBAAOG,OAAP,CAAeE,SAASvI,CAAT,CAAf;EACD;EACF;EACDvG,oBAAQN,IAAR,CAAa+O,MAAb;EACA,iBAAK,IAAII,MAAK,CAAd,EAAiBA,MAAK7O,QAAQxB,MAA9B,EAAsCqQ,KAAtC,EAA4C;EAC1C,kBAAI7O,QAAQ6O,GAAR,EAAYrQ,MAAZ,KAAuB,CAA3B,EAA8B;EAC5BwB,wBAAQ6O,GAAR,IAAc,CAAC,CAAD,EAAI,CAAJ,CAAd;EACD;EACF;EACF;EACF;EACF;EACD;EACA,UAAMrM,SAAS;EACbC,cAAM,cAASjD,CAAT,EAAY4C,CAAZ,EAAeN,SAAf,EAA0B;EAC9B,cAAIkN,WAAWxP,EAAE4C,CAAF,CAAf;EACA,cAAI6M,gBAAgBrQ,OAAO0B,UAAP,CAAkB8B,CAAlB,EAAqBrB,MAArB,CACjB3B,MADiB,GAEjBgG,OAFiB,CAET4J,QAFS,CAApB;EAGA,cAAIE,qBAAqBtQ,OAAO0B,UAAP,CAAkB8B,CAAlB,EAAqBrB,MAArB,CAA4B1B,KAA5B,GACvB4P,aADuB,CAAzB;EAGA,iBACEC,sBAAsBZ,OAAOlM,CAAP,EAAU,CAAV,CAAtB,IACA8M,sBAAsBZ,OAAOlM,CAAP,EAAU,CAAV,CAFxB;EAID,SAbY;EAcbO,gBAAQ,gBAASnD,CAAT,EAAY4C,CAAZ,EAAeN,SAAf,EAA0B;EAChC,iBAAO9B,QAAQ8B,SAAR,EAAmB,CAAnB,KAAyBtC,EAAE4C,CAAF,CAAzB,IAAiC5C,EAAE4C,CAAF,KAAQpC,QAAQ8B,SAAR,EAAmB,CAAnB,CAAhD;EACD,SAhBY;EAiBbc,gBAAQ,gBAASpD,CAAT,EAAY4C,CAAZ,EAAeN,SAAf,EAA0B;EAChC,cAAIkN,WAAWxP,EAAE4C,CAAF,CAAf;EACA,cAAI6M,gBAAgBrQ,OAAO0B,UAAP,CAAkB8B,CAAlB,EAAqBrB,MAArB,CACjB3B,MADiB,GAEjBgG,OAFiB,CAET4J,QAFS,CAApB;EAGA,cAAIE,qBAAqBtQ,OAAO0B,UAAP,CAAkB8B,CAAlB,EAAqBrB,MAArB,CAA4B1B,KAA5B,GACvB4P,aADuB,CAAzB;EAGA,iBACEC,sBAAsBZ,OAAOlM,CAAP,EAAU,CAAV,CAAtB,IACA8M,sBAAsBZ,OAAOlM,CAAP,EAAU,CAAV,CAFxB;EAID;EA7BY,OAAf;EA+BA,aAAOxD,OAAOnB,IAAP,CAAY6E,MAAZ,CAAmB;EAAA,eACxBD,QAAQS,KAAR,CAAc,UAACV,CAAD,EAAIN,SAAJ;EAAA,iBACZU,OAAO5D,OAAO0B,UAAP,CAAkB8B,CAAlB,EAAqBnC,IAA5B,EAAkCT,CAAlC,EAAqC4C,CAArC,EAAwCN,SAAxC,CADY;EAAA,SAAd,CADwB;EAAA,OAAnB,CAAP;EAKD,KAhGD,MAgGO;EACL;EACA;EACA;EACA,UAAIqN,iBAAiB,EAArB;;EAJK,iCAKIC,GALJ;EAMH,YAAI1O,QAAQ9B,OAAOsB,OAAP,CAAekP,GAAf,CAAZ;EACA,YAAIX,SAAS,EAAb;EACA,YAAIC,SAAShO,MAAMO,MAAnB;EACA,YAAIoB,UAAU,CAAC3B,MAAMjD,IAAP,CAAd;EACA,YACE,OAAOmB,OAAO0B,UAAP,CAAkBI,MAAMjD,IAAxB,EAA8BsD,MAA9B,CAAqC3B,MAArC,GAA8C,CAA9C,CAAP,KAA4D,QAD9D,EAEE;EACA,eAAK,IAAIK,KAAI,CAAb,EAAgBA,KAAIiP,OAAOlQ,MAA3B,EAAmCiB,IAAnC,EAAwC;EACtC,gBACE4C,QAAQwD,QAAR,CAAiBnF,MAAMjD,IAAvB,KACAmB,OAAO+P,QAAP,CAAgB9I,QAAhB,CAAyBnF,MAAMjD,IAA/B,CAFF,EAGE;EACAgR,qBAAO/O,IAAP,CAAYd,OAAO0B,UAAP,CAAkBI,MAAMjD,IAAxB,EAA8BsD,MAA9B,CAAqCnB,MAArC,CAA4C8O,OAAOjP,EAAP,CAA5C,CAAZ;EACD,aALD,MAKO,IAAIb,OAAO0B,UAAP,CAAkBI,MAAMjD,IAAxB,EAA8BsD,MAA9B,OAA2C,CAA/C,EAAkD;EACvD0N,qBAAOG,OAAP,CACEhQ,OAAO0B,UAAP,CAAkBI,MAAMjD,IAAxB,EAA8BsD,MAA9B,CAAqCnB,MAArC,CAA4C8O,OAAOjP,EAAP,CAA5C,CADF;EAGD;EACF;EACDO,kBAAQN,IAAR,CAAa+O,MAAb;EACA,eAAK,IAAII,OAAK,CAAd,EAAiBA,OAAK7O,QAAQxB,MAA9B,EAAsCqQ,MAAtC,EAA4C;EAC1C,gBAAI7O,QAAQ6O,IAAR,EAAYrQ,MAAZ,KAAuB,CAA3B,EAA8B;EAC5BwB,sBAAQ6O,IAAR,IAAc,CAAC,CAAD,EAAI,CAAJ,CAAd;EACD;EACF;EACF,SArBD,MAqBO;EACLP,iBAAO5N,MAAMjD,IAAb,IAAqBiD,MAAMO,MAA3B;EACA,cAAI6N,YAAWlQ,OAAO0B,UAAP,CAAkBI,MAAMjD,IAAxB,EAA8BsD,MAA9B,CAAqC1B,KAArC,EAAf;EACA,cAAI0P,aAAYnQ,OAAO0B,UAAP,CAAkBI,MAAMjD,IAAxB,EAA8BsD,MAA9B,CAAqC3B,MAArC,EAAhB;EACA,eAAK,IAAImH,KAAI,CAAb,EAAgBA,KAAIuI,UAAStQ,MAA7B,EAAqC+H,IAArC,EAA0C;EACxC,gBACEuI,UAASvI,EAAT,KAAemI,OAAO,CAAP,CAAf,IACAI,UAASvI,EAAT,KAAemI,OAAO,CAAP,CADf,IAEArM,QAAQwD,QAAR,CAAiBnF,MAAMjD,IAAvB,CAFA,IAGAmB,OAAO+P,QAAP,CAAgB9I,QAAhB,CAAyBnF,MAAMjD,IAA/B,CAJF,EAKE;EACAgR,qBAAO/O,IAAP,CAAYoP,UAASvI,EAAT,CAAZ;EACD,aAPD,MAOO,IAAIuI,UAASvI,EAAT,KAAemI,OAAO,CAAP,CAAf,IAA4BI,UAASvI,EAAT,KAAemI,OAAO,CAAP,CAA/C,EAA0D;EAC/DD,qBAAOG,OAAP,CAAeE,UAASvI,EAAT,CAAf;EACD;EACF;EACDvG,kBAAQN,IAAR,CAAa+O,MAAb;EACA,eAAK,IAAII,OAAK,CAAd,EAAiBA,OAAK7O,QAAQxB,MAA9B,EAAsCqQ,MAAtC,EAA4C;EAC1C,gBAAI7O,QAAQ6O,IAAR,EAAYrQ,MAAZ,KAAuB,CAA3B,EAA8B;EAC5BwB,sBAAQ6O,IAAR,IAAc,CAAC,CAAD,EAAI,CAAJ,CAAd;EACD;EACF;EACF;EACD,YAAIrM,SAAS;EACXC,gBAAM,cAASjD,CAAT,EAAY4C,CAAZ,EAAeN,SAAf,EAA0B;EAC9B,gBAAIkN,WAAWxP,EAAE4C,CAAF,CAAf;EACA,gBAAI6M,gBAAgBrQ,OAAO0B,UAAP,CAAkB8B,CAAlB,EAAqBrB,MAArB,CACjB3B,MADiB,GAEjBgG,OAFiB,CAET4J,QAFS,CAApB;EAGA,gBAAIE,qBAAqBtQ,OAAO0B,UAAP,CAAkB8B,CAAlB,EAAqBrB,MAArB,CAA4B1B,KAA5B,GACvB4P,aADuB,CAAzB;EAGA,mBACEC,sBAAsBZ,OAAOlM,CAAP,EAAU,CAAV,CAAtB,IACA8M,sBAAsBZ,OAAOlM,CAAP,EAAU,CAAV,CAFxB;EAID,WAbU;EAcXO,kBAAQ,gBAASnD,CAAT,EAAY4C,CAAZ,EAAeN,SAAf,EAA0B;EAChC,mBAAO9B,QAAQoP,GAAR,EAAa,CAAb,KAAmB5P,EAAE4C,CAAF,CAAnB,IAA2B5C,EAAE4C,CAAF,KAAQpC,QAAQoP,GAAR,EAAa,CAAb,CAA1C;EACD,WAhBU;EAiBXxM,kBAAQ,gBAASpD,CAAT,EAAY4C,CAAZ,EAAeN,SAAf,EAA0B;EAChC,gBAAIkN,WAAWxP,EAAE4C,CAAF,CAAf;EACA,gBAAI6M,gBAAgBrQ,OAAO0B,UAAP,CAAkB8B,CAAlB,EAAqBrB,MAArB,CACjB3B,MADiB,GAEjBgG,OAFiB,CAET4J,QAFS,CAApB;EAGA,gBAAIE,qBAAqBtQ,OAAO0B,UAAP,CAAkB8B,CAAlB,EAAqBrB,MAArB,CAA4B1B,KAA5B,GACvB4P,aADuB,CAAzB;EAGA,mBACEC,sBAAsBZ,OAAOlM,CAAP,EAAU,CAAV,CAAtB,IACA8M,sBAAsBZ,OAAOlM,CAAP,EAAU,CAAV,CAFxB;EAID;EA7BU,SAAb;;EAgCA;EACA;EACA;EACA,YAAIiN,WAAWzQ,OAAOnB,IAAP,CAAY6E,MAAZ,CAAmB;EAAA,iBAChCD,QAAQS,KAAR,CAAc,UAACV,CAAD,EAAIN,SAAJ;EAAA,mBACZU,OAAO5D,OAAO0B,UAAP,CAAkB8B,CAAlB,EAAqBnC,IAA5B,EAAkCT,CAAlC,EAAqC4C,CAArC,EAAwCN,SAAxC,CADY;EAAA,WAAd,CADgC;EAAA,SAAnB,CAAf;EAKA,aAAK,IAAIwN,IAAI,CAAb,EAAgBA,IAAID,SAAS7Q,MAA7B,EAAqC8Q,GAArC,EAA0C;EACxCH,yBAAezP,IAAf,CAAoB2P,SAASC,CAAT,CAApB;EACD;EACDjN,kBAAU,EAAV;EACAiM,iBAAS,EAAT;EAlGG;;EAKL,WAAK,IAAIc,MAAM,CAAf,EAAkBA,MAAMxQ,OAAOsB,OAAP,CAAe1B,MAAvC,EAA+C4Q,KAA/C,EAAsD;EAAA,cAA7CA,GAA6C;EA8FrD;EACD,aAAOD,cAAP;EACD;EACF,GA5MgB;EAAA,CAAjB;;ECFA,IAAMlM,iBAAiB,SAAjBA,cAAiB,CAACf,UAAD,EAAatD,MAAb,EAAqBmB,EAArB;EAAA,SAA4B,YAAsB;EAAA,QAArB8C,SAAqB,uEAAT,IAAS;;EACvE,QAAIA,cAAc,IAAlB,EAAwB;EACtB,aAAOX,WAAWW,SAAlB;EACD;;EAEDA,gBAAY0M,OAAO1M,SAAP,EAAkB2M,WAAlB,EAAZ;EACA,QAAI3M,cAAc,KAAd,IAAuBA,cAAc,IAAzC,EAA+C;EAC7C,YAAM,IAAIG,KAAJ,CAAU,uBAAuBH,SAAjC,CAAN;EACD;;EAEDX,eAAWW,SAAX,GAAuBA,SAAvB;EACAjE,WAAOmD,OAAP,GAAiBG,WAAWuN,WAAX,GAAyBxN,QAAzB,EAAjB;EACAlC,OAAG6B,aAAH;EACA,WAAO7B,EAAP;EACD,GAdsB;EAAA,CAAvB;;EAgBA,IAAM2P,YAAY,SAAZA,SAAY,CAACxN,UAAD,EAAatD,MAAb,EAAqBmB,EAArB;EAAA,SAA4B,YAAiB;EAAA,QAAhB4P,IAAgB,uEAAT,IAAS;;EAC7D,QAAIA,SAAS,IAAb,EAAmB;EACjB,aAAOzN,WAAWyN,IAAlB;EACD;;EAED,QAAI5P,GAAG6P,UAAH,GAAgBxK,OAAhB,CAAwBuK,IAAxB,MAAkC,CAAC,CAAvC,EAA0C;EACxC,YAAM,IAAI3M,KAAJ,CAAU,2CAA2C2M,IAArD,CAAN;EACD;;EAED;EACA;EACA,QAAIA,SAASzN,WAAWyN,IAAxB,EAA8B;EAC5B;EACA;EACA,UAAIzN,WAAWyN,IAAX,KAAoB,MAAxB,EAAgC;EAC9B5P,WAAG8B,UAAH;EACD;;EAED;EACAK,iBAAW2C,KAAX,CAAiB3C,WAAWyN,IAA5B,EAAkCjL,SAAlC,CAA4C3E,EAA5C;EACA;EACAmC,iBAAWyN,IAAX,GAAkBA,IAAlB;EACAzN,iBAAW2C,KAAX,CAAiB3C,WAAWyN,IAA5B,EAAkCtL,OAAlC;EACA,UAAIsL,SAAS,MAAb,EAAqB;EACnB,eAAO5P,GAAGkD,cAAV;EACD,OAFD,MAEO;EACLlD,WAAGkD,cAAH,GAAoBA,eAAef,UAAf,EAA2BtD,MAA3B,EAAmCmB,EAAnC,CAApB;EACD;EACF;;EAED,WAAOA,EAAP;EACD,GA/BiB;EAAA,CAAlB;;EChBA;;;;;;;EAOA,IAAM8P,kBAAkB,SAAlBA,eAAkB;EAAA,SAAU;EAAA,WAChCjR,OAAO0B,UAAP,CAAkBd,CAAlB,EAAqBsQ,KAArB,GAA6BlR,OAAO0B,UAAP,CAAkBd,CAAlB,EAAqBsQ,KAAlD,GAA0DtQ,CAD1B;EAAA,GAAV;EAAA,CAAxB;;ECLA,IAAMuQ,uBAAuB,SAAvBA,oBAAuB,CAACnR,MAAD,EAASmB,EAAT,EAAawD,IAAb;EAAA,SAC3B,UAASzB,SAAT,EAAoB;EAClB/B,OAAGiQ,IAAH,CAAQlO,SAAR;EACA/B,OAAG8B,UAAH,CAAcC,SAAd;;EAEA;EACA/B,OAAGb,SAAH,CACGoC,MADH,CACU,KADV,EAEGF,SAFH,CAEa,QAFb,EAGGkB,MAHH,CAGU;EAAA,aAAK9C,MAAMsC,SAAX;EAAA,KAHV,EAIGmO,UAJH,GAKGC,QALH,CAKYtR,OAAOuR,aALnB,EAMG5O,IANH,CAMQgC,KAAKpE,KAAL,CAAWP,OAAO0B,UAAP,CAAkBwB,SAAlB,EAA6Bf,MAAxC,CANR;EAOAhB,OAAGrC,MAAH;EACD,GAd0B;EAAA,CAA7B;;ECAA,IAAM0S,eAAe,SAAfA,YAAe,CAACxR,MAAD,EAASmB,EAAT,EAAgB;EACnC,MAAI,CAACnB,OAAOwR,YAAZ,EAA0B;;EAE1B,MAAIC,QAAQrO,kBAAMsO,MAAlB;EACAD,UAAQA,QAAQ,CAAR,GAAY,CAAC,CAAb,GAAiBA,KAAzB;EACAA,UAAQA,QAAQ,CAAR,GAAY,CAAZ,GAAgBA,KAAxB;;EAEAzR,SAAO2R,sBAAP,IAAiCF,KAAjC;EACAtQ,KAAG6I,GAAH,CACGxH,SADH,CACa,YADb,EAEGoD,IAFH,CAGI,WAHJ,EAII,4BAA4B5F,OAAO2R,sBAAnC,GAA4D,GAJhE;EAMAvO,oBAAMwO,cAAN;EACD,CAfD;;;;ECIA,IAAMC,aAAa,SAAbA,UAAa,CAAC7R,MAAD,EAASmB,EAAT,EAAa2Q,QAAb,EAAuBnN,IAAvB,EAA6BoN,KAA7B;EAAA,SAAuC,YAErD;EAAA,QADHR,aACG,uEADa,IACb;;EACH,QAAIA,kBAAkB,IAAtB,EAA4B;EAC1BA,sBAAgBvR,OAAOuR,aAAvB;EACD;;EAED,QAAMS,SAAS7Q,GAAG6I,GAAH,CACZxH,SADY,CACF,YADE,EAEZ3D,IAFY,CAEPsC,GAAGkK,uBAAH,EAFO,CAAf;EAGA;EACA2G,WACG1L,KADH,GAEGX,MAFH,CAEU,OAFV,EAGGC,IAHH,CAGQ,OAHR,EAGiB,WAHjB,EAIGA,IAJH,CAIQ,WAJR,EAIqB;EAAA,aAAK,eAAekM,SAAStO,CAAT,CAAf,GAA6B,GAAlC;EAAA,KAJrB,EAKGqC,KALH,CAKS,SALT,EAKoB,CALpB,EAMGF,MANH,CAMU,OANV,EAOGC,IAPH,CAOQ,OAPR,EAOiB,MAPjB,EAQGA,IARH,CAQQ,WARR,EAQqB,gBARrB,EASGnD,IATH,CASQ,UAAS7B,CAAT,EAAY;EAChB,UAAMqR,cAAcvP,mBAAO,IAAP,EAAaC,IAAb,CAClBxB,GAAG+Q,eAAH,CAAmBvN,IAAnB,EAAyB3E,OAAO0B,UAAP,CAAkBd,CAAlB,CAAzB,CADkB,CAApB;;EAIAqR,kBACGzP,SADH,CACa,MADb,EAEGqD,KAFH,CAES,MAFT,EAEiB,MAFjB,EAGGA,KAHH,CAGS,QAHT,EAGmB,MAHnB,EAIGA,KAJH,CAIS,iBAJT,EAI4B,YAJ5B;;EAMAoM,kBACGzP,SADH,CACa,MADb,EAEGqD,KAFH,CAES,MAFT,EAEiB,MAFjB,EAGGA,KAHH,CAGS,QAHT,EAGmB,MAHnB,EAIGA,KAJH,CAIS,iBAJT,EAI4B,YAJ5B;EAKD,KAzBH,EA0BGF,MA1BH,CA0BU,UA1BV,EA2BGC,IA3BH,CA2BQ,aA3BR,EA2BuB,QA3BvB,EA4BGA,IA5BH,CA4BQ,OA5BR,EA4BiB,OA5BjB,EA6BGA,IA7BH,CA6BQ,GA7BR,EA6Ba,CA7Bb,EA8BGA,IA9BH,CA8BQ,GA9BR,EA8Ba,CA9Bb,EA+BGA,IA/BH,CAgCI,WAhCJ,EAiCI,4BAA4B5F,OAAO2R,sBAAnC,GAA4D,GAjChE,EAmCGQ,IAnCH,CAmCQlB,gBAAgBjR,MAAhB,CAnCR,EAoCGsF,EApCH,CAoCM,UApCN,EAoCkB6L,qBAAqBnR,MAArB,EAA6BmB,EAA7B,EAAiCwD,IAAjC,CApClB,EAqCGW,EArCH,CAqCM,OArCN,EAqCekM,aAAaxR,MAAb,EAAqBmB,EAArB,CArCf;;EAuCA;EACA6Q,WAAOpM,IAAP,CAAY,SAAZ,EAAuB,CAAvB;EACAoM,WACGtP,MADH,CACU,OADV,EAEG2O,UAFH,GAGGC,QAHH,CAGYC,aAHZ,EAIG9O,IAJH,CAIQ,UAAS7B,CAAT,EAAY;EAChB8B,yBAAO,IAAP,EAAaC,IAAb,CAAkBxB,GAAG+Q,eAAH,CAAmBvN,IAAnB,EAAyB3E,OAAO0B,UAAP,CAAkBd,CAAlB,CAAzB,CAAlB;EACD,KANH;EAOAoR,WACGtP,MADH,CACU,QADV,EAEG2O,UAFH,GAGGC,QAHH,CAGYC,aAHZ,EAIGY,IAJH,CAIQlB,gBAAgBjR,MAAhB,CAJR,EAKG4F,IALH,CAMI,WANJ,EAOI,4BAA4B5F,OAAO2R,sBAAnC,GAA4D,GAPhE;;EAUA;EACAK,WAAOrL,IAAP,GAAcZ,MAAd;;EAEA,QAAMxD,IAAIpB,GAAG6I,GAAH,CAAOxH,SAAP,CAAiB,YAAjB,CAAV;EACAD,MAAE8O,UAAF,GACGC,QADH,CACYC,aADZ,EAEG3L,IAFH,CAEQ,WAFR,EAEqB;EAAA,aAAK,eAAekM,SAAStO,CAAT,CAAf,GAA6B,GAAlC;EAAA,KAFrB,EAGGqC,KAHH,CAGS,SAHT,EAGoB,CAHpB;;EAKA1E,OAAG6I,GAAH,CACGxH,SADH,CACa,OADb,EAEG6O,UAFH,GAGGC,QAHH,CAGYC,aAHZ,EAIG9O,IAJH,CAIQ,UAAS7B,CAAT,EAAY;EAChB8B,yBAAO,IAAP,EAAaC,IAAb,CAAkBxB,GAAG+Q,eAAH,CAAmBvN,IAAnB,EAAyB3E,OAAO0B,UAAP,CAAkBd,CAAlB,CAAzB,CAAlB;EACD,KANH;;EAQA,QAAImR,MAAMK,SAAV,EAAqBjR,GAAGiR,SAAH;EACrB,QAAIL,MAAMM,WAAV,EAAuBlR,GAAGkR,WAAH;EACvB,QAAIlR,GAAG2P,SAAH,OAAmB,MAAvB,EAA+B;EAC7B,UAAMC,OAAO5P,GAAG2P,SAAH,EAAb;EACA3P,SAAG2P,SAAH,CAAa,MAAb;EACA3P,SAAG2P,SAAH,CAAaC,IAAb;EACD;EACD,WAAO/I,OAAP;EACD,GA9FkB;EAAA,CAAnB;;ECNA;EACA,IAAMsK,WAAW,SAAXA,QAAW,SAAU;EACzB,MAAMtH,IAAIhL,OAAOiL,MAAP,GAAgBjL,OAAOE,MAAP,CAAc6K,GAA9B,GAAoC/K,OAAOE,MAAP,CAAcgL,MAA5D;;EAEA,MAAIlL,OAAOuS,kBAAP,IAA6B,QAAjC,EAA2C;EACzC,WAAO,CACLvH,IACE,CADF,GAEEhL,OAAOwS,yBAAP,CAAiCtH,MAFnC,GAGElL,OAAOwS,yBAAP,CAAiCzH,GAJ9B,EAKL,CALK,CAAP;EAOD,GARD,MAQO,IAAI/K,OAAOuS,kBAAP,IAA6B,KAAjC,EAAwC;EAC7C,WAAO,CACLvH,IAAI,CADC,EAEL,IACEhL,OAAOwS,yBAAP,CAAiCtH,MADnC,GAEElL,OAAOwS,yBAAP,CAAiCzH,GAJ9B,CAAP;EAMD;EACD,SAAO,CAACC,IAAI,CAAL,EAAQ,CAAR,CAAP;EACD,CApBD;;ECMA,IAAMyH,YAAY,SAAZA,SAAY,CAACzS,MAAD,EAASmB,EAAT,EAAaiK,MAAb,EAAqBsH,GAArB;EAAA,SAChB,YAAW;EACT;EACA,QAAMC,gBAAgB;EACpB9O,YAAM,cAASiE,CAAT,EAAY;EAChB,YAAI8K,UAAUvQ,eAAOrC,OAAOnB,IAAd,EAAoB;EAAA,iBAAM+B,EAAEkH,CAAF,IAAOlH,EAAEkH,CAAF,EAAK+K,OAAL,EAAP,GAAwB,IAA9B;EAAA,SAApB,CAAd;EACA;EACA,YAAID,QAAQ,CAAR,MAAeA,QAAQ,CAAR,CAAnB,EAA+B;EAC7B,iBAAOE,qBACJtS,MADI,CACGoS,OADH,EAEJnS,KAFI,CAEE6R,SAAStS,MAAT,CAFF,CAAP;EAGD;EACD,YAAIA,OAAO+P,QAAP,CAAgB9I,QAAhB,CAAyBa,CAAzB,CAAJ,EAAiC;EAC/B8K,oBAAUA,QAAQxT,GAAR,CAAY;EAAA,mBAAO2T,SAAS/C,OAAT,CAAiBgD,GAAjB,CAAP;EAAA,WAAZ,CAAV;EACD;EACD,eAAOC,oBACJzS,MADI,CACGoS,OADH,EAEJnS,KAFI,CAEE6R,SAAStS,MAAT,CAFF,CAAP;EAGD,OAfmB;EAgBpB+D,cAAQ,gBAAS+D,CAAT,EAAY;EAClB,YAAI8K,UAAUvQ,eAAOrC,OAAOnB,IAAd,EAAoB;EAAA,iBAAK,CAAC+B,EAAEkH,CAAF,CAAN;EAAA,SAApB,CAAd;EACA;EACA,YAAI8K,QAAQ,CAAR,MAAeA,QAAQ,CAAR,CAAnB,EAA+B;EAC7B,iBAAOE,qBACJtS,MADI,CACGoS,OADH,EAEJnS,KAFI,CAEE6R,SAAStS,MAAT,CAFF,CAAP;EAGD;EACD,YAAIA,OAAO+P,QAAP,CAAgB9I,QAAhB,CAAyBa,CAAzB,CAAJ,EAAiC;EAC/B8K,oBAAUA,QAAQxT,GAAR,CAAY;EAAA,mBAAO2T,SAAS/C,OAAT,CAAiBgD,GAAjB,CAAP;EAAA,WAAZ,CAAV;EACD;EACD,eAAOE,sBACJ1S,MADI,CACGoS,OADH,EAEJnS,KAFI,CAEE6R,SAAStS,MAAT,CAFF,CAAP;EAGD,OA9BmB;EA+BpBgE,cAAQ,gBAAS8D,CAAT,EAAY;EAClB,YAAIqL,SAAS,EAAb;EAAA,YACE3S,SAAS,EADX;EAEA;EACA;EACAR,eAAOnB,IAAP,CAAYO,GAAZ,CAAgB,aAAK;EACnB,cAAIoE,EAAEsE,CAAF,MAAS/F,SAAT,IAAsB/B,OAAOuS,kBAAP,KAA8B,WAAxD,EAAqE;EACnE,mBAAO,IAAP,CADmE;EAEpE;EACD,cAAIY,OAAO3P,EAAEsE,CAAF,CAAP,MAAiB/F,SAArB,EAAgC;EAC9BoR,mBAAO3P,EAAEsE,CAAF,CAAP,IAAe,CAAf;EACD,WAFD,MAEO;EACLqL,mBAAO3P,EAAEsE,CAAF,CAAP,IAAeqL,OAAO3P,EAAEsE,CAAF,CAAP,IAAe,CAA9B;EACD;EACF,SATD;EAUA,YAAI9H,OAAO+P,QAAP,CAAgB9I,QAAhB,CAAyBa,CAAzB,CAAJ,EAAiC;EAC/BtH,mBAASgB,OAAOmI,mBAAP,CAA2BwJ,MAA3B,EAAmCC,IAAnC,EAAT;EACD,SAFD,MAEO;EACL,cAAIC,UAAU7R,OAAOmI,mBAAP,CAA2BwJ,MAA3B,EAAmCC,IAAnC,EAAd;EACA,eAAK,IAAIvS,IAAI,CAAb,EAAgBA,IAAIW,OAAOmI,mBAAP,CAA2BwJ,MAA3B,EAAmCvT,MAAvD,EAA+DiB,GAA/D,EAAoE;EAClEL,mBAAOM,IAAP,CAAYuS,QAAQC,GAAR,EAAZ;EACD;EACF;;EAED;EACA,YAAIC,mBAAmB,EAAvB;EACA,YAAI/S,OAAOZ,MAAP,KAAkB,CAAtB,EAAyB;EACvB;EACAY,mBAAS,CAAC,GAAD,EAAMA,OAAO,CAAP,CAAN,EAAiB,GAAjB,CAAT;EACD;EACD,YAAIgT,QAAQlB,SAAStS,MAAT,EAAiB,CAAjB,KAAuBQ,OAAOZ,MAAP,GAAgB,CAAvC,CAAZ;EACA,aAAK,IAAI+H,IAAI,CAAb,EAAgBA,IAAInH,OAAOZ,MAA3B,EAAmC+H,GAAnC,EAAwC;EACtC,cAAI4L,iBAAiB3T,MAAjB,KAA4B,CAAhC,EAAmC;EACjC2T,6BAAiBzS,IAAjB,CAAsB,CAAtB;EACA;EACD;EACDyS,2BAAiBzS,IAAjB,CAAsByS,iBAAiB5L,IAAI,CAArB,IAA0B6L,KAAhD;EACD;EACD,eAAOC,uBACJjT,MADI,CACGA,MADH,EAEJC,KAFI,CAEE8S,gBAFF,CAAP;EAGD;EAxEmB,KAAtB;EA0EA/R,WAAOC,IAAP,CAAYzB,OAAO0B,UAAnB,EAA+Bf,OAA/B,CAAuC,UAASmH,CAAT,EAAY;EACjD,UACE9H,OAAO0B,UAAP,CAAkBoG,CAAlB,EAAqB3F,MAArB,KAAgCJ,SAAhC,IACA/B,OAAO0B,UAAP,CAAkBoG,CAAlB,EAAqB3F,MAArB,KAAgC,IAFlC,EAGE;EACAnC,eAAO0B,UAAP,CAAkBoG,CAAlB,EAAqB3F,MAArB,GAA8BwQ,cAAc3S,OAAO0B,UAAP,CAAkBoG,CAAlB,EAAqBzG,IAAnC,EAC5ByG,CAD4B,CAA9B;EAGD;EACF,KATD;;EAWA;EACA;EACAsD,WAAO3K,KAAP,CAAa,CAAC,CAAD,EAAIV,EAAEC,MAAF,CAAJ,CAAb,EAA6B0T,OAA7B,CAAqC,GAArC;;EAEA;EACA,QAAMvG,mBAAmBC,OAAOD,gBAAP,IAA2B,CAApD;;EAEA;EACAhM,OAAGb,SAAH,CACGkC,SADH,CACa,QADb,EAEGqD,KAFH,CAES,YAFT,EAEuB7F,OAAOE,MAAP,CAAc6K,GAAd,GAAoB,IAF3C,EAGGlF,KAHH,CAGS,aAHT,EAGwB7F,OAAOE,MAAP,CAAcE,IAAd,GAAqB,IAH7C,EAIGyF,KAJH,CAIS,OAJT,EAIkB9F,EAAEC,MAAF,IAAY,CAAZ,GAAgB,IAJlC,EAKG6F,KALH,CAKS,QALT,EAKmBmF,EAAEhL,MAAF,IAAY,CAAZ,GAAgB,IALnC,EAMG4F,IANH,CAMQ,OANR,EAMiB,CAAC7F,EAAEC,MAAF,IAAY,CAAb,IAAkBmN,gBANnC,EAOGvH,IAPH,CAOQ,QAPR,EAOkB,CAACoF,EAAEhL,MAAF,IAAY,CAAb,IAAkBmN,gBAPpC;EAQA;EACAuF,QAAIjF,UAAJ,CAAekG,WAAf,GAA6B3T,OAAO4T,KAApC;EACAlB,QAAIjF,UAAJ,CAAeoG,SAAf,GAA2B7T,OAAO6T,SAAlC;EACAnB,QAAIjF,UAAJ,CAAeqG,wBAAf,GAA0C9T,OAAO+T,SAAjD;EACArB,QAAIjF,UAAJ,CAAeuG,WAAf,GAA6BhU,OAAOiU,KAApC;EACAvB,QAAIjF,UAAJ,CAAelN,KAAf,CAAqB4M,gBAArB,EAAuCA,gBAAvC;EACAuF,QAAIvP,OAAJ,CAAYwQ,WAAZ,GAA0B3T,OAAOkU,YAAjC;EACAxB,QAAIvP,OAAJ,CAAY0Q,SAAZ,GAAwB7T,OAAO6T,SAA/B;EACAnB,QAAIvP,OAAJ,CAAY2Q,wBAAZ,GAAuC9T,OAAO+T,SAA9C;EACArB,QAAIvP,OAAJ,CAAY6Q,WAAZ,GAA0BhU,OAAOiU,KAAjC;EACAvB,QAAIvP,OAAJ,CAAY5C,KAAZ,CAAkB4M,gBAAlB,EAAoCA,gBAApC;EACAuF,QAAIyB,SAAJ,CAAcN,SAAd,GAA0B7T,OAAOoU,oBAAjC;EACA1B,QAAIyB,SAAJ,CAAc5T,KAAd,CAAoB4M,gBAApB,EAAsCA,gBAAtC;EACAuF,QAAI2B,MAAJ,CAAWR,SAAX,GAAuB7T,OAAOsU,eAA9B;EACA5B,QAAI2B,MAAJ,CAAWE,WAAX,GAAyBvU,OAAOwU,iBAAhC;EACA9B,QAAI2B,MAAJ,CAAWI,UAAX,GAAwBzU,OAAO0U,gBAA/B;EACAhC,QAAI2B,MAAJ,CAAW9T,KAAX,CAAiB4M,gBAAjB,EAAmCA,gBAAnC;;EAEA,WAAO,IAAP;EACD,GA3He;EAAA,CAAlB;;ECJA,IAAMiF,YAAY,SAAZA,SAAY,CAACpS,MAAD,EAASmB,EAAT,EAAa4Q,KAAb;EAAA,SAChB,YAAW;EACT,QAAI,CAAC5Q,GAAGoB,CAAH,EAAL,EAAa;EACXpB,SAAGuE,UAAH;EACD;;EAED,QAAMnD,IAAIpB,GAAGoB,CAAH,EAAV;;EAEA;EACAA,MAAEoD,MAAF,CAAS,OAAT,EACGC,IADH,CACQ,OADR,EACiB,OADjB,EAEGnD,IAFH,CAEQ,UAAS7B,CAAT,EAAY;EAChB,UAAIZ,OAAO0B,UAAP,CAAkBd,CAAlB,MAAyBmB,SAA7B,EAAwC;EACtC/B,eAAO0B,UAAP,CAAkBd,CAAlB,EAAqB,OAArB,IAAgCoE,eAAOtC,mBAAO,IAAP,CAAP,EAAqBL,MAArB,CAA4B,CAC1D,CAAC,CAAC,EAAF,EAAM,CAAN,CAD0D,EAE1D,CAAC,EAAD,EAAKrC,OAAO0B,UAAP,CAAkBd,CAAlB,EAAqBuB,MAArB,CAA4B1B,KAA5B,GAAoC,CAApC,CAAL,CAF0D,CAA5B,CAAhC;EAIAiC,2BAAO,IAAP,EAAaC,IAAb,CACE3C,OAAO0B,UAAP,CAAkBd,CAAlB,EAAqB,OAArB,EACG0E,EADH,CACM,OADN,EACe,YAAW;EACtB,cAAIlC,kBAAMmC,WAAN,KAAsB,IAAtB,IAA8B,CAACnC,kBAAMmC,WAAN,CAAkBoP,OAArD,EAA8D;EAC5DxT,eAAG8B,UAAH;EACD;EACF,SALH,EAMGqC,EANH,CAMM,OANN,EAMe,YAAW;EACtB,cAAI,CAAClC,kBAAMmC,WAAN,CAAkBoP,OAAvB,EAAgC;EAC9BxT,eAAGW,KAAH;EACD;EACF,SAVH,EAWGwD,EAXH,CAWM,KAXN,EAWa,YAAW;EACpB;EACA;EACA;EACA;EACA,cAAIlC,kBAAMmC,WAAN,CAAkBoP,OAAtB,EAA+B;EAC7B,gBAAIC,OAAOlS,mBAAO,IAAP,EACRA,MADQ,CACD,YADC,EAERiN,KAFQ,GAEA,CAFA,EAEGkF,SAFd;EAGAD,mBAAOA,KAAK/G,OAAL,CACL,mBADK,EAEL,2BACE,aADF,GAEE7N,OAAOsB,OAAP,CAAe1B,MAFjB,GAGE,GALG,CAAP;EAOA,gBAAIkV,MAAMpS,mBAAO,IAAP,EAAaiN,KAAb,GAAqB,CAArB,EAAwBC,QAAlC;EACA,gBAAI9N,QAAQ;EACVuE,kBAAIrG,OAAOsB,OAAP,CAAe1B,MADT;EAEVyC,sBAAQL,uBAAe,IAAf,CAFE;EAGV4S,oBAAMA,IAHI;EAIV/V,oBAAMiW;EAJI,aAAZ;EAMA9U,mBAAOsB,OAAP,CAAeR,IAAf,CAAoBgB,KAApB;EACAY,+BAAOA,mBAAO,IAAP,EAAaiN,KAAb,GAAqB,CAArB,EAAwBoF,UAA/B,EACGrS,MADH,CACU,OADV,EAEGiN,KAFH,GAEW,CAFX,EAEckF,SAFd,IAE2BD,IAF3B;EAGAzT,eAAGW,KAAH;EACA9B,mBAAO0B,UAAP,CAAkBd,CAAlB,EAAqBkB,KAArB,CAA2Bc,IAA3B,CAAgCF,mBAAO,IAAP,EAAa,IAAb,CAAhC;EACAA,+BAAO,IAAP,EACGA,MADH,CACU,YADV,EAEGkD,IAFH,CAEQ,OAFR,EAEiB,cAFjB;EAGAzE,eAAGiR,SAAH;EACD,WA5BD,MA4BO;EACLjR,eAAGW,KAAH;EACD;EACF,SA/CH,CADF;EAkDAY,2BAAO,IAAP,EAAa4C,EAAb,CAAgB,UAAhB,EAA4B,YAAW;EACrCnE,aAAG8B,UAAH,CAAcrC,CAAd;EACD,SAFD;EAGD;EACF,KA9DH;;EAgEAmR,UAAMK,SAAN,GAAkB,IAAlB;EACA,WAAO,IAAP;EACD,GA3Ee;EAAA,CAAlB;;ECDA,IAAM4C,cAAc,SAAdA,WAAc,CAAChV,MAAD,EAASmB,EAAT;EAAA,SAClB,UAAS8T,MAAT,EAAiB5T,IAAjB,EAAuB;EACrB,QAAM6T,IAAI7T,QAAQ,QAAlB;EACA,QAAI,OAAO4T,MAAP,KAAkB,WAAtB,EAAmC;EACjCA,eAAS,IAAT;EACD;;EAED;EACA,QAAI,CAACzT,OAAOC,IAAP,CAAYzB,OAAO0B,UAAnB,EAA+B9B,MAApC,EAA4C;EAC1CuB,SAAGgU,gBAAH;EACD;EACDhU,OAAGsR,SAAH;;EAEA;EACA,QAAM2C,SAAS5T,OAAOC,IAAP,CAAYzB,OAAO0B,UAAnB,EAA+BgC,MAA/B,CACb;EAAA,aAAK1D,OAAO0B,UAAP,CAAkB8B,CAAlB,EAAqBnC,IAArB,IAA6B6T,CAAlC;EAAA,KADa,CAAf;;EAIA,QAAID,MAAJ,EAAY;EACV,UAAIrC,UAAUvQ,eACZ+S,OACGhW,GADH,CACO;EAAA,eAAKY,OAAO0B,UAAP,CAAkBd,CAAlB,EAAqBuB,MAArB,CAA4B3B,MAA5B,EAAL;EAAA,OADP,EAEGmB,MAFH,CAEU,UAACE,GAAD,EAAMD,GAAN;EAAA,eAAcC,IAAIrC,MAAJ,CAAWoC,GAAX,CAAd;EAAA,OAFV,CADY,CAAd;;EAMAwT,aAAOzU,OAAP,CAAe,aAAK;EAClBX,eAAO0B,UAAP,CAAkBd,CAAlB,EAAqBuB,MAArB,CAA4B3B,MAA5B,CAAmCoS,OAAnC;EACD,OAFD;EAGD,KAVD,MAUO;EACLwC,aAAOzU,OAAP,CAAe,aAAK;EAClBX,eAAO0B,UAAP,CAAkBd,CAAlB,EAAqBuB,MAArB,CAA4B3B,MAA5B,CAAmC6B,eAAOrC,OAAOnB,IAAd,EAAoB;EAAA,iBAAK,CAAC+B,EAAEkH,CAAF,CAAN;EAAA,SAApB,CAAnC;EACD,OAFD;EAGD;;EAED;EACA,QAAI9H,OAAOqV,eAAP,KAA2B,IAA/B,EAAqC;EACnClU,SAAGkU,eAAH,CAAmBrV,OAAOqV,eAA1B;EACD;;EAED,WAAO,IAAP;EACD,GAxCiB;EAAA,CAApB;;ECFA,IAAMC,uBAAuB,SAAvBA,oBAAuB,CAACtV,MAAD,EAAS8R,QAAT;EAAA,SAAsB;EAAA,WACjDtQ,OAAOC,IAAP,CAAYzB,OAAO0B,UAAnB,EAA+BtC,GAA/B,CAAmC,aAAK;EACtC,UAAMwJ,IAAIkJ,SAASlR,CAAT,CAAV;EACA,UAAMiI,IAAI7I,OAAO0B,UAAP,CAAkBd,CAAlB,EAAqBuB,MAArB,CAA4BoT,IAAI3U,CAAJ,CAA5B,CAAV;EACA,aAAO,CAACgI,CAAD,EAAIC,CAAJ,CAAP;EACD,KAJD,CADiD;EAAA,GAAtB;EAAA,CAA7B;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ECAA,IAAM2M,UAAU,SAAVA,OAAU;EAAA,SAAK5U,MAAM,IAAN,IAAcA,MAAMmB,SAAzB;EAAA,CAAhB;;EAEA,IAAM0T,yBAAyB,SAAzBA,sBAAyB,CAACzV,MAAD,EAASmB,EAAT;EAAA,SAC7B,UAASoI,IAAT,EAAe;EACb,QAAMmM,QAAQvU,GAAGwU,oBAAH,CAAwB3V,OAAOnB,IAA/B,CAAd;EACA0K,WAAOA,OAAOA,IAAP,GAAc/H,OAAOC,IAAP,CAAYiU,KAAZ,CAArB;;EAEA,WAAOnM,KAAK5H,MAAL,CAAY,UAACC,GAAD,EAAMC,GAAN,EAAWhB,CAAX,EAAiB;EAClC,UAAMiH,IAAI9H,OAAO0B,UAAP,CAAkBG,GAAlB,IAAyB7B,OAAO0B,UAAP,CAAkBG,GAAlB,CAAzB,GAAkD,EAA5D;EACAD,UAAIC,GAAJ,iBACKiG,CADL;EAEE8N,gBAAQJ,QAAQ1N,EAAE8N,MAAV,IAAoB9N,EAAE8N,MAAtB,GAA+B,MAFzC;EAGEC,eAAOL,QAAQ1N,EAAE+N,KAAV,IAAmB/N,EAAE+N,KAArB,GAA6B,CAHtC;EAIEC,uBAAeN,QAAQ1N,EAAEgO,aAAV,IAA2BhO,EAAEgO,aAA7B,GAA6C,CAJ9D;EAKEC,uBAAeP,QAAQ1N,EAAEiO,aAAV,IAA2BjO,EAAEiO,aAA7B,GAA6C,CAL9D;EAMEC,qBAAaR,QAAQ1N,EAAEkO,WAAV,IAAyBlO,EAAEkO,WAA3B,GAAyC,CANxD;EAOE3U,cAAMmU,QAAQ1N,EAAEzG,IAAV,IAAkByG,EAAEzG,IAApB,GAA2BqU,MAAM7T,GAAN,CAPnC;EAQEoU,eAAOT,QAAQ1N,EAAEmO,KAAV,IAAmBnO,EAAEmO,KAArB,GAA6BpV;EARtC;;EAWA,aAAOe,GAAP;EACD,KAdM,EAcJ,EAdI,CAAP;EAeD,GApB4B;EAAA,CAA/B;;ECOA;;;;;;;;;;EAUA,IAAM8D,aAAa,SAAbA,UAAa,CAAC1F,MAAD,EAASmB,EAAT,EAAaiK,MAAb,EAAqB2G,KAArB,EAA4BpN,IAA5B;EAAA,SACjB,YAAW;EACT,QAAIxD,GAAGoB,CAAH,OAAWR,SAAf,EAA0B;EACxBZ,SAAG+U,UAAH;EACD;EACD;EACA/U,OAAGgV,EAAH,GAAQhV,GAAG6I,GAAH,CACLxH,SADK,CACK,YADL,EAEL3D,IAFK,CAEAsC,GAAGkK,uBAAH,EAFA,EAE8B,UAASzK,CAAT,EAAY;EAC9C,aAAOA,CAAP;EACD,KAJK,EAKL0F,KALK,GAMLX,MANK,CAME,OANF,EAOLC,IAPK,CAOA,OAPA,EAOS,WAPT,EAQLA,IARK,CAQA,WARA,EAQa,UAAShF,CAAT,EAAY;EAC7B,aAAO,eAAewK,OAAOxK,CAAP,CAAf,GAA2B,GAAlC;EACD,KAVK,CAAR;EAWA;EACAO,OAAGgV,EAAH,CACGxQ,MADH,CACU,OADV,EAEGC,IAFH,CAEQ,OAFR,EAEiB,MAFjB,EAGGA,IAHH,CAGQ,WAHR,EAGqB,gBAHrB,EAIGnD,IAJH,CAIQ,UAAS7B,CAAT,EAAY;EAChB,UAAIqR,cAAcvP,mBAAO,IAAP,EAAaC,IAAb,CAChBxB,GAAG+Q,eAAH,CAAmBvN,IAAnB,EAAyB3E,OAAO0B,UAAP,CAAkBd,CAAlB,CAAzB,CADgB,CAAlB;;EAIAqR,kBACGzP,SADH,CACa,MADb,EAEGqD,KAFH,CAES,MAFT,EAEiB,MAFjB,EAGGA,KAHH,CAGS,QAHT,EAGmB,MAHnB,EAIGA,KAJH,CAIS,iBAJT,EAI4B,YAJ5B;;EAMAoM,kBACGzP,SADH,CACa,MADb,EAEGqD,KAFH,CAES,MAFT,EAEiB,MAFjB,EAGGA,KAHH,CAGS,QAHT,EAGmB,MAHnB,EAIGA,KAJH,CAIS,iBAJT,EAI4B,YAJ5B;EAKD,KApBH,EAsBGF,MAtBH,CAsBU,UAtBV,EAuBGC,IAvBH,CAuBQ,aAvBR,EAuBuB,QAvBvB,EAwBGA,IAxBH,CAwBQ,GAxBR,EAwBa,CAxBb,EAyBGA,IAzBH,CA0BI,WA1BJ,EA2BI,4BAA4B5F,OAAO2R,sBAAnC,GAA4D,GA3BhE,EA6BG/L,IA7BH,CA6BQ,GA7BR,EA6Ba,CA7Bb,EA8BGA,IA9BH,CA8BQ,OA9BR,EA8BiB,OA9BjB,EA+BGuM,IA/BH,CA+BQlB,gBAAgBjR,MAAhB,CA/BR,EAgCGsF,EAhCH,CAgCM,UAhCN,EAgCkB6L,qBAAqBnR,MAArB,EAA6BmB,EAA7B,EAAiCwD,IAAjC,CAhClB,EAiCGW,EAjCH,CAiCM,OAjCN,EAiCekM,aAAaxR,MAAb,EAAqBmB,EAArB,CAjCf;;EAmCA,QAAInB,OAAOuS,kBAAP,KAA8B,KAAlC,EAAyC;EACvCpR,SAAG6I,GAAH,CACGrE,MADH,CACU,MADV,EAEGC,IAFH,CAEQ,IAFR,EAEc,CAFd,EAGGA,IAHH,CAGQ,IAHR,EAGc,IAAI5F,OAAOwS,yBAAP,CAAiCzH,GAHnD,EAIGnF,IAJH,CAIQ,IAJR,EAIc7F,EAAEC,MAAF,CAJd,EAKG4F,IALH,CAKQ,IALR,EAKc,IAAI5F,OAAOwS,yBAAP,CAAiCzH,GALnD,EAMGnF,IANH,CAMQ,cANR,EAMwB,CANxB,EAOGA,IAPH,CAOQ,QAPR,EAOkB,MAPlB,EAQGA,IARH,CAQQ,MARR,EAQgB,MARhB,EASGA,IATH,CASQ,iBATR,EAS2B,YAT3B;EAUD,KAXD,MAWO,IAAI5F,OAAOuS,kBAAP,KAA8B,QAAlC,EAA4C;EACjDpR,SAAG6I,GAAH,CACGrE,MADH,CACU,MADV,EAEGC,IAFH,CAEQ,IAFR,EAEc,CAFd,EAGGA,IAHH,CAGQ,IAHR,EAGcoF,EAAEhL,MAAF,IAAY,CAAZ,GAAgBA,OAAOwS,yBAAP,CAAiCtH,MAH/D,EAIGtF,IAJH,CAIQ,IAJR,EAIc7F,EAAEC,MAAF,CAJd,EAKG4F,IALH,CAKQ,IALR,EAKcoF,EAAEhL,MAAF,IAAY,CAAZ,GAAgBA,OAAOwS,yBAAP,CAAiCtH,MAL/D,EAMGtF,IANH,CAMQ,cANR,EAMwB,CANxB,EAOGA,IAPH,CAOQ,QAPR,EAOkB,MAPlB,EAQGA,IARH,CAQQ,MARR,EAQgB,MARhB,EASGA,IATH,CASQ,iBATR,EAS2B,YAT3B;EAUD;;EAEDmM,UAAMqE,IAAN,GAAa,IAAb;EACA,WAAO,IAAP;EACD,GA/EgB;EAAA,CAAnB;;;;EChBA;EACA,IAAMC,WAAW,SAAXA,QAAW,CAACrW,MAAD,EAASmB,EAAT,EAAa2Q,QAAb;EAAA,SAA0B,cAAM;EAC/C,QAAMwE,IAAIC,MAAM,GAAhB;EACA,QAAM7D,MAAMvR,GAAGuR,GAAH,CAAO8D,IAAnB;EACA,QAAMtK,aAAa,CAAnB;EACA,QAAME,WAAW,IAAIpD,KAAKiD,EAA1B;EACAyG,QAAIsB,WAAJ,GAAkB/K,YAAI,CAAC,IAAID,KAAKyN,GAAL,CAASzW,OAAOnB,IAAP,CAAYe,MAArB,EAA6B,IAAI,CAAjC,CAAL,EAA0C,CAA1C,CAAJ,CAAlB;EACAI,WAAOnB,IAAP,CAAY8B,OAAZ,CAAoB,aAAK;EACvB+V,2BAAQ1W,OAAO0B,UAAf,EAA2Bf,OAA3B,CAAmC,UAAC6C,CAAD,EAAI3C,CAAJ,EAAU;EAC3C6R,YAAIiE,SAAJ;EACAjE,YAAIvG,GAAJ,CACE2F,SAAStO,CAAT,CADF,EAEExD,OAAO0B,UAAP,CAAkB8B,EAAE+K,GAApB,EAAyBpM,MAAzB,CAAgCvB,EAAE4C,CAAF,CAAhC,CAFF,EAGE8S,CAHF,EAIEpK,UAJF,EAKEE,QALF;EAOAsG,YAAIkE,MAAJ;EACAlE,YAAImE,IAAJ;EACD,OAXD;EAYD,KAbD;EAcA,WAAO7O,OAAP;EACD,GArBgB;EAAA,CAAjB;;ECFA,IAAMkK,kBAAkB,SAAlBA,eAAkB,CAACvN,IAAD,EAAOzB,SAAP,EAAqB;EAC3C,MAAI4T,gBAAJ;;EAEA,UAAQ5T,UAAU0S,MAAlB;EACE,SAAK,MAAL;EACEkB,gBAAUC,gBAAS7T,UAAUf,MAAnB,CAAV;EACA;EACF,SAAK,OAAL;EACE2U,gBAAUE,iBAAU9T,UAAUf,MAApB,CAAV;EACA;EACF,SAAK,KAAL;EACE2U,gBAAUG,eAAQ/T,UAAUf,MAAlB,CAAV;EACA;EACF,SAAK,QAAL;EACE2U,gBAAUI,kBAAWhU,UAAUf,MAArB,CAAV;EACA;EACF;EACE2U,gBAAUC,gBAAS7T,UAAUf,MAAnB,CAAV;EACA;EAfJ;;EAkBA2U,UACGjB,KADH,CACS3S,UAAU2S,KADnB,EAEGsB,UAFH,CAEcjU,UAAUiU,UAFxB,EAGGC,aAHH,CAGiBlU,UAAU4S,aAH3B,EAIGuB,aAJH,CAIiBnU,UAAU6S,aAJ3B,EAKGC,WALH,CAKe9S,UAAU8S,WALzB,EAMGsB,UANH,CAMcpU,UAAUoU,UANxB;;EAQA,SAAOR,OAAP;EACD,CA9BD;;ECGA;EACA,IAAMzE,cAAc,SAAdA,WAAc,CAACrS,MAAD,EAASmB,EAAT,EAAaiK,MAAb,EAAqB0G,QAArB,EAA+ByF,QAA/B,EAAyCxF,KAAzC;EAAA,SAClB,YAAW;EACT,QAAI5Q,GAAGoB,CAAH,OAAWR,SAAf,EAA0BZ,GAAGuE,UAAH;EAC1B,QAAMnD,IAAIpB,GAAGoB,CAAH,EAAV;;EAEAA,MAAEsD,KAAF,CAAQ,QAAR,EAAkB,MAAlB,EAA0BlD,IAA1B,CACE8H,cACGnF,EADH,CACM,OADN,EACe,UAAS1E,CAAT,EAAY;EACvB2W,eAAS3W,CAAT,IAAc,KAAK4W,UAAL,GAAkBpM,OAAOxK,CAAP,CAAhC;EACD,KAHH,EAIG0E,EAJH,CAIM,MAJN,EAIc,UAAS1E,CAAT,EAAY;EACtB2W,eAAS3W,CAAT,IAAcoI,KAAKC,GAAL,CACZlJ,EAAEC,MAAF,CADY,EAEZgJ,KAAKE,GAAL,CAAS,CAAT,EAAa,KAAKsO,UAAL,IAAmBpU,kBAAMqU,EAAtC,CAFY,CAAd;EAIAtW,SAAGuW,cAAH;EACAtM,aAAO5K,MAAP,CAAcW,GAAGkK,uBAAH,EAAd;EACAlK,SAAGrC,MAAH;EACAyD,QAAEqD,IAAF,CAAO,WAAP,EAAoB;EAAA,eAAK,eAAekM,SAASlR,CAAT,CAAf,GAA6B,GAAlC;EAAA,OAApB;EACD,KAbH,EAcG0E,EAdH,CAcM,KAdN,EAca,UAAS1E,CAAT,EAAY;EACrB,aAAO,KAAK4W,UAAZ;EACA,aAAOD,SAAS3W,CAAT,CAAP;EACA8B,yBAAO,IAAP,EACG2O,UADH,GAEGzL,IAFH,CAEQ,WAFR,EAEqB,eAAewF,OAAOxK,CAAP,CAAf,GAA2B,GAFhD;EAGAO,SAAGrC,MAAH;EACAqC,SAAGwW,YAAH;EACD,KAtBH,CADF;EAyBA5F,UAAMM,WAAN,GAAoB,IAApB;EACA,WAAO,IAAP;EACD,GAhCiB;EAAA,CAApB;;ECNA;EACA;EACA,IAAMuF,SAAS,SAATA,MAAS,CAAC5X,MAAD,EAASmB,EAAT,EAAa4Q,KAAb,EAAoBxN,MAApB,EAA+B;EAC5C,SAAO,YAAW;EAChB;EACApD,OAAGb,SAAH,CACGoC,MADH,CACU,KADV,EAEGkD,IAFH,CAEQ,OAFR,EAEiB5F,OAAOC,KAFxB,EAGG2F,IAHH,CAGQ,QAHR,EAGkB5F,OAAOiL,MAHzB;EAIA9J,OAAG6I,GAAH,CAAOpE,IAAP,CACE,WADF,EAEE,eAAe5F,OAAOE,MAAP,CAAcE,IAA7B,GAAoC,GAApC,GAA0CJ,OAAOE,MAAP,CAAc6K,GAAxD,GAA8D,GAFhE;;EAKA;EACA,QAAIgH,MAAMK,SAAV,EAAqBjR,GAAG8B,UAAH;;EAErB;EACA9B,OAAGsR,SAAH;;EAEA;EACA,QAAItR,GAAGoB,CAAH,EAAJ,EAAYpB,GAAGuE,UAAH;EACZ,QAAIqM,MAAMK,SAAV,EAAqBjR,GAAGiR,SAAH;EACrB,QAAIL,MAAMM,WAAV,EAAuBlR,GAAGkR,WAAH;;EAEvB9N,WAAO5B,IAAP,CAAY,QAAZ,EAAsB,IAAtB,EAA4B;EAC1B1C,aAAOD,OAAOC,KADY;EAE1BgL,cAAQjL,OAAOiL,MAFW;EAG1B/K,cAAQF,OAAOE;EAHW,KAA5B;;EAMA,WAAO,IAAP;EACD,GA7BD;EA8BD,CA/BD;;ECFA;EACA;EACA;EACA,IAAM2X,UAAU,SAAVA,OAAU,CAAC7X,MAAD,EAASmB,EAAT,EAAaiK,MAAb;EAAA,SAAwB,mBAAW;EACjD,QAAM0M,WAAW3W,GAAGkK,uBAAH,GAA6B,CAA7B,CAAjB;;EAEAlK,OAAG4W,uBAAH,CAA2BC,OAA3B;EACA;EACA;EACA;EACA,QAAMC,YAAYH,aAAa3W,GAAGkK,uBAAH,GAA6B,CAA7B,CAA/B;;EAEA,QAAI4M,SAAJ,EAAe;EACb7M,aAAO5K,MAAP,CAAcW,GAAGkK,uBAAH,EAAd;EACA,UAAM6M,cAAclY,OAAOkY,WAAP,CAAmB5Y,KAAnB,CAAyB,CAAzB,CAApB;EACA6B,SAAGgX,WAAH;;EAEA,UAAM9D,SAASrU,OAAOqU,MAAP,CAAc/U,KAAd,CAAoB,CAApB,CAAf;EACA6B,SAAGiX,MAAH;;EAEA,UAAM7V,IAAIpB,GAAGoB,CAAH,EAAV;EACAA,QAAE8O,UAAF,GACGC,QADH,CACY,IADZ,EAEG1L,IAFH,CAEQ,WAFR,EAEqB;EAAA,eAAK,eAAewF,OAAOxK,CAAP,CAAf,GAA2B,GAAhC;EAAA,OAFrB;EAGAO,SAAGrC,MAAH;;EAEA;EACA,UAAIoZ,YAAYtY,MAAZ,KAAuB,CAA3B,EAA8B;EAC5BuB,WAAGgT,SAAH,CAAa+D,WAAb;EACD;EACD,UAAI7D,OAAOzU,MAAP,KAAkB,CAAtB,EAAyB;EACvBuB,WAAGkX,IAAH,CAAQhE,MAAR;EACD;EACF;EACF,GA/Be;EAAA,CAAhB;;ECHA,IAAMqD,iBAAiB,SAAjBA,cAAiB,CAAC1X,MAAD,EAAS8R,QAAT;EAAA,SAAsB,YAAM;EACjD,QAAMwG,OAAO9W,OAAO+W,MAAP,CAAc,EAAd,EAAkBvY,OAAO0B,UAAzB,CAAb;EACA,QAAM8W,qBAAqBhX,OAAOC,IAAP,CAAYzB,OAAO0B,UAAnB,EAA+B0R,IAA/B,CACzB,UAACvH,CAAD,EAAIpF,CAAJ;EAAA,aAAWqL,SAASjG,CAAT,IAAciG,SAASrL,CAAT,CAAd,KAA8B,CAA9B,GAAkC,CAAlC,GAAsCqL,SAASjG,CAAT,IAAciG,SAASrL,CAAT,CAA/D;EAAA,KADyB,CAA3B;EAGAzG,WAAO0B,UAAP,GAAoB,EAApB;EACA8W,uBAAmB7X,OAAnB,CAA2B,UAAC6C,CAAD,EAAI3C,CAAJ,EAAU;EACnCb,aAAO0B,UAAP,CAAkB8B,CAAlB,IAAuB8U,KAAK9U,CAAL,CAAvB;EACAxD,aAAO0B,UAAP,CAAkB8B,CAAlB,EAAqByS,KAArB,GAA6BpV,CAA7B;EACD,KAHD;EAID,GAVsB;EAAA,CAAvB;;ECAA,IAAMkX,0BAA0B,SAA1BA,uBAA0B;EAAA,SAAU,mBAAW;EACnD,QAAMO,OAAO9W,OAAO+W,MAAP,CAAc,EAAd,EAAkBvY,OAAO0B,UAAzB,CAAb;EACA,QAAM8W,qBAAqBhX,OAAOC,IAAP,CAAYzB,OAAO0B,UAAnB,EAA+B0R,IAA/B,CAAoC,UAACvH,CAAD,EAAIpF,CAAJ,EAAU;EACvE,UAAMgS,kBACJzY,OAAO0B,UAAP,CAAkBmK,CAAlB,EAAqB1J,MAArB,CAA4B6V,QAAQnM,CAAR,CAA5B,IACA7L,OAAO0B,UAAP,CAAkB+E,CAAlB,EAAqBtE,MAArB,CAA4B6V,QAAQvR,CAAR,CAA5B,CAFF;;EAIA;EACA;EACA;EACA,aAAOgS,oBAAoB,CAApB,GAAwB5M,EAAE6M,aAAF,CAAgBjS,CAAhB,CAAxB,GAA6CgS,eAApD;EACD,KAT0B,CAA3B;EAUAzY,WAAO0B,UAAP,GAAoB,EAApB;EACA8W,uBAAmB7X,OAAnB,CAA2B,UAAC6C,CAAD,EAAI3C,CAAJ,EAAU;EACnCb,aAAO0B,UAAP,CAAkB8B,CAAlB,IAAuB8U,KAAK9U,CAAL,CAAvB;EACAxD,aAAO0B,UAAP,CAAkB8B,CAAlB,EAAqByS,KAArB,GAA6BpV,CAA7B;EACD,KAHD;EAID,GAjB+B;EAAA,CAAhC;;ECAA,IAAM8X,YAAY,SAAZA,SAAY,CAAC3Y,MAAD,EAASsD,UAAT,EAAwB;EACxC,MAAItD,OAAOmD,OAAP,IAAkBnD,OAAOmD,OAAP,CAAevD,MAAf,KAA0BI,OAAOnB,IAAP,CAAYe,MAA5D,EACE,OAAO,IAAP;;EAEF,MAAMgZ,SAAStV,WAAWuN,WAAX,GAAyB3K,UAAzB,EAAf;;EAEA,OAAK,IAAIqI,GAAT,IAAgBqK,MAAhB,EAAwB;EACtB,QAAIA,OAAO/T,cAAP,CAAsB0J,GAAtB,CAAJ,EAAgC;EAC9B,aAAO,IAAP;EACD;EACF;EACD,SAAO,KAAP;EACD,CAZD;;ECIA,IAAMzO,QAAQ,SAARA,KAAQ,CAACE,MAAD,EAASmB,EAAT,EAAauR,GAAb,EAAkBpP,UAAlB;EAAA,SACZ,UAASuV,KAAT,EAAgB;EACdnG,QAAImG,KAAJ,EAAWC,SAAX,CAAqB,CAArB,EAAwB,CAAxB,EAA2B/Y,EAAEC,MAAF,IAAY,CAAvC,EAA0CgL,EAAEhL,MAAF,IAAY,CAAtD;;EAEA;EACA;EACA;EACA,QAAI6Y,UAAU,SAAV,IAAuBF,UAAU3Y,MAAV,EAAkBsD,UAAlB,CAA3B,EAA0D;EACxDoP,UAAIvP,OAAJ,CAAYkL,SAAZ,GAAwBlN,GAAGb,SAAH,CAAauF,KAAb,CAAmB,kBAAnB,CAAxB;EACA6M,UAAIvP,OAAJ,CAAY6Q,WAAZ,GAA0B,IAAIhU,OAAO+Y,cAArC;EACArG,UAAIvP,OAAJ,CAAYmL,QAAZ,CAAqB,CAArB,EAAwB,CAAxB,EAA2BvO,EAAEC,MAAF,IAAY,CAAvC,EAA0CgL,EAAEhL,MAAF,IAAY,CAAtD;EACA0S,UAAIvP,OAAJ,CAAY6Q,WAAZ,GAA0BhU,OAAOiU,KAAjC;EACD;EACD,WAAO,IAAP;EACD,GAdW;EAAA,CAAd;;ECJO,IAAM+E,YAAY,IAAlB;;MCKMC,MAAb;EAEI,oBAAaC,QAAb,EACA;EAAA;;EACI,aAAKC,WAAL,CAAiBD,QAAjB;EACH;;EALL;EAAA;EAAA,0BAOOrY,CAPP,EAOS8G,CAPT,EAQI;EACI,gBAAI9G,IAAI,CAAJ,IAASA,IAAI,KAAKqY,QAAL,CAActZ,MAA3B,IAAqC+H,IAAI,CAAzC,IAA8CA,IAAI,KAAKuR,QAAL,CAAc,CAAd,EAAiBtZ,MAAvE,EACA;EACI,uBAAO,IAAP;EACH;EACD,mBAAO,KAAKsZ,QAAL,CAAcrY,IAAE,CAAhB,EAAmB8G,IAAE,CAArB,CAAP;EACH;EAdL;EAAA;EAAA,4BAgBS9G,CAhBT,EAiBI;EACI,gBAAIA,IAAI,KAAKqY,QAAL,CAActZ,MAAtB,EACA;EACI,uBAAO,IAAP;EACH;EACD,mBAAO,IAAIwZ,MAAJ,CAAW,KAAKF,QAAL,CAAcrY,IAAE,CAAhB,CAAX,CAAP;EACH;EAvBL;EAAA;EAAA,4BAyBS8G,CAzBT,EA0BI;EACI,gBAAI,KAAKuR,QAAL,CAActZ,MAAd,KAAyB,CAA7B,EACA;EACI,uBAAO,IAAP;EACH;EACD,gBAAI+H,IAAI,KAAKuR,QAAL,CAAc,CAAd,EAAiBtZ,MAAzB,EACA;EACI,uBAAO,IAAP;EACH;EACD,gBAAIyZ,MAAM,EAAV;EAAA,gBAAcC,IAAI,KAAKJ,QAAL,CAActZ,MAAhC;EACA,iBAAK,IAAIiB,IAAI,CAAb,EAAgBA,IAAIyY,CAApB,EAAuBzY,GAAvB,EACA;EACIwY,oBAAIvY,IAAJ,CAAS,KAAKoY,QAAL,CAAcrY,CAAd,EAAiB8G,IAAE,CAAnB,CAAT;EACH;EACD,mBAAO,IAAIyR,MAAJ,CAAWC,GAAX,CAAP;EACH;EAzCL;EAAA;EAAA,qCA4CI;EACI,gBAAIE,OAAQ,KAAKL,QAAL,CAActZ,MAAd,KAAyB,CAA1B,GAA+B,CAA/B,GAAmC,KAAKsZ,QAAL,CAAc,CAAd,EAAiBtZ,MAA/D;EACA,mBAAO,EAAC4Z,MAAM,KAAKN,QAAL,CAActZ,MAArB,EAA6B2Z,MAAMA,IAAnC,EAAP;EACH;EA/CL;EAAA;EAAA,+BAkDI;EACI,mBAAO,KAAKL,QAAL,CAActZ,MAArB;EACH;EApDL;EAAA;EAAA,+BAuDI;EACI,gBAAI,KAAKsZ,QAAL,CAActZ,MAAd,KAAyB,CAA7B,EACA;EACI,uBAAO,CAAP;EACH;EACD,mBAAO,KAAKsZ,QAAL,CAAc,CAAd,EAAiBtZ,MAAxB;EACH;EA7DL;EAAA;EAAA,4BA+DS6Z,MA/DT,EAgEI;EACI,gBAAIC,IAAID,OAAOP,QAAP,IAAmBO,MAA3B;EACA,gBAAI,CAACC,EAAE,CAAF,CAAD,IAAS,OAAOA,EAAE,CAAF,EAAK,CAAL,CAAP,KAAoB,WAAjC,EACA;EACIA,oBAAI,IAAIT,MAAJ,CAAWS,CAAX,EAAcR,QAAlB;EACH;EACD,gBAAI,KAAKA,QAAL,CAActZ,MAAd,KAAyB,CAAzB,IAA8B8Z,EAAE9Z,MAAF,KAAa,CAA/C,EACA;EACI,uBAAO,KAAKsZ,QAAL,CAActZ,MAAd,KAAyB8Z,EAAE9Z,MAAlC;EACH;EACD,gBAAI,KAAKsZ,QAAL,CAActZ,MAAd,KAAyB8Z,EAAE9Z,MAA/B,EACA;EACI,uBAAO,KAAP;EACH;EACD,gBAAI,KAAKsZ,QAAL,CAAc,CAAd,EAAiBtZ,MAAjB,KAA4B8Z,EAAE,CAAF,EAAK9Z,MAArC,EACA;EACI,uBAAO,KAAP;EACH;EACD,gBAAIiB,IAAI,KAAKqY,QAAL,CAActZ,MAAtB;EAAA,gBAA8B+Z,KAAK,KAAKT,QAAL,CAAc,CAAd,EAAiBtZ,MAApD;EAAA,gBAA4D+H,CAA5D;EACA,mBAAO9G,GAAP,EACA;EACI8G,oBAAIgS,EAAJ;EACA,uBAAOhS,GAAP,EACA;EACI,wBAAIqB,KAAK4Q,GAAL,CAAS,KAAKV,QAAL,CAAcrY,CAAd,EAAiB8G,CAAjB,IAAsB+R,EAAE7Y,CAAF,EAAK8G,CAAL,CAA/B,IAA0CqR,SAA9C,EACA;EACI,+BAAO,KAAP;EACH;EACJ;EACJ;EACD,mBAAO,IAAP;EACH;EA/FL;EAAA;EAAA,8BAkGI;EACI,mBAAO,IAAIC,MAAJ,CAAW,KAAKC,QAAhB,CAAP;EACH;EApGL;EAAA;EAAA,4BAsGSW,EAtGT,EAsGa1L,OAtGb,EAuGI;EACI,gBAAI,KAAK+K,QAAL,CAActZ,MAAd,KAAyB,CAA7B,EACA;EACI,uBAAO,IAAIqZ,MAAJ,CAAW,EAAX,CAAP;EACH;EACD,gBAAIa,MAAM,EAAV;EAAA,gBAAcjZ,IAAI,KAAKqY,QAAL,CAActZ,MAAhC;EAAA,gBAAwC+Z,KAAK,KAAKT,QAAL,CAAc,CAAd,EAAiBtZ,MAA9D;EAAA,gBAAsE+H,CAAtE;EACA,mBAAO9G,GAAP,EACA;EACI8G,oBAAIgS,EAAJ;EACAG,oBAAIjZ,CAAJ,IAAS,EAAT;EACA,uBAAO8G,GAAP,EACA;EACImS,wBAAIjZ,CAAJ,EAAO8G,CAAP,IAAYkS,GAAGlX,IAAH,CAAQwL,OAAR,EAAiB,KAAK+K,QAAL,CAAcrY,CAAd,EAAiB8G,CAAjB,CAAjB,EAAsC9G,IAAI,CAA1C,EAA6C8G,IAAI,CAAjD,CAAZ;EACH;EACJ;EACD,mBAAO,IAAIsR,MAAJ,CAAWa,GAAX,CAAP;EACH;EAvHL;EAAA;EAAA,qCAyHkBL,MAzHlB,EA0HI;EACI,gBAAIC,IAAID,OAAOP,QAAP,IAAmBO,MAA3B;EACA,gBAAI,OAAOC,EAAE,CAAF,EAAK,CAAL,CAAP,KAAoB,WAAxB,EACA;EACIA,oBAAI,IAAIT,MAAJ,CAAWS,CAAX,EAAcR,QAAlB;EACH;EACD,gBAAI,KAAKA,QAAL,CAActZ,MAAd,KAAyB,CAA7B,EACA;EACI,uBAAO8Z,EAAE9Z,MAAF,KAAa,CAApB;EACH;EACD,mBAAQ,KAAKsZ,QAAL,CAActZ,MAAd,KAAyB8Z,EAAE9Z,MAA3B,IAAqC,KAAKsZ,QAAL,CAAc,CAAd,EAAiBtZ,MAAjB,KAA4B8Z,EAAE,CAAF,EAAK9Z,MAA9E;EACH;EArIL;EAAA;EAAA,4BAuIS6Z,MAvIT,EAwII;EACI,gBAAI,KAAKP,QAAL,CAActZ,MAAd,KAAyB,CAA7B,EACA;EACI,uBAAO,KAAKR,GAAL,CAAS,UAASwJ,CAAT,EACZ;EACI,2BAAOA,CAAP;EACH,iBAHE,CAAP;EAIH;EACD,gBAAI8Q,IAAID,OAAOP,QAAP,IAAmBO,MAA3B;EACA,gBAAI,OAAOC,EAAE,CAAF,EAAK,CAAL,CAAP,KAAoB,WAAxB,EACA;EACIA,oBAAI,IAAIT,MAAJ,CAAWS,CAAX,EAAcR,QAAlB;EACH;EACD,gBAAI,CAAC,KAAKa,YAAL,CAAkBL,CAAlB,CAAL,EACA;EACI,uBAAO,IAAP;EACH;EACD,mBAAO,KAAKta,GAAL,CAAS,UAASwJ,CAAT,EAAY/H,CAAZ,EAAe8G,CAAf,EACZ;EACI,uBAAOiB,IAAI8Q,EAAE7Y,IAAE,CAAJ,EAAO8G,IAAE,CAAT,CAAX;EACH,aAHE,CAAP;EAIH;EA7JL;EAAA;EAAA,iCA+Jc8R,MA/Jd,EAgKI;EACI,gBAAI,KAAKP,QAAL,CAActZ,MAAd,KAAyB,CAA7B,EACA;EACI,uBAAO,KAAKR,GAAL,CAAS,UAASwJ,CAAT,EAChB;EACI,2BAAOA,CAAP;EACH,iBAHM,CAAP;EAIH;EACD,gBAAI8Q,IAAID,OAAOP,QAAP,IAAmBO,MAA3B;EACA,gBAAI,OAAOC,EAAE,CAAF,EAAK,CAAL,CAAP,KAAoB,WAAxB,EACA;EACIA,oBAAI,IAAIT,MAAJ,CAAWS,CAAX,EAAcR,QAAlB;EACH;EACD,gBAAI,CAAC,KAAKa,YAAL,CAAkBL,CAAlB,CAAL,EACA;EACI,uBAAO,IAAP;EACH;EACD,mBAAO,KAAKta,GAAL,CAAS,UAASwJ,CAAT,EAAY/H,CAAZ,EAAe8G,CAAf,EACZ;EACI,uBAAOiB,IAAI8Q,EAAE7Y,IAAE,CAAJ,EAAO8G,IAAE,CAAT,CAAX;EACH,aAHE,CAAP;EAIH;EArLL;EAAA;EAAA,4CAuLyB8R,MAvLzB,EAwLI;EACI,gBAAI,KAAKP,QAAL,CAActZ,MAAd,KAAyB,CAA7B,EACA;EACI,uBAAO,KAAP;EACH;EACD,gBAAI8Z,IAAID,OAAOP,QAAP,IAAmBO,MAA3B;EACA,gBAAI,OAAOC,EAAE,CAAF,EAAK,CAAL,CAAP,KAAoB,WAAxB,EACA;EACIA,oBAAI,IAAIT,MAAJ,CAAWS,CAAX,EAAcR,QAAlB;EACH;EACD;EACA,mBAAQ,KAAKA,QAAL,CAAc,CAAd,EAAiBtZ,MAAjB,KAA4B8Z,EAAE9Z,MAAtC;EACH;EApML;EAAA;EAAA,iCAsMc6Z,MAtMd,EAuMI;EACI,gBAAI,KAAKP,QAAL,CAActZ,MAAd,KAAyB,CAA7B,EACA;EACI,uBAAO,IAAP;EACH;EACD,gBAAI,CAAC6Z,OAAOP,QAAZ,EACA;EACI,uBAAO,KAAK9Z,GAAL,CAAS,UAASwJ,CAAT,EAChB;EACI,2BAAOA,IAAI6Q,MAAX;EACH,iBAHM,CAAP;EAIH;EACD,gBAAIO,eAAeP,OAAOQ,OAAP,GAAiB,IAAjB,GAAwB,KAA3C;EACA,gBAAIP,IAAID,OAAOP,QAAP,IAAmBO,MAA3B;EACA,gBAAI,OAAOC,EAAE,CAAF,EAAK,CAAL,CAAP,KAAoB,WAAxB,EACA;EACIA,oBAAI,IAAIT,MAAJ,CAAWS,CAAX,EAAcR,QAAlB;EACH;EACD,gBAAI,CAAC,KAAKgB,mBAAL,CAAyBR,CAAzB,CAAL,EACA;EACI,uBAAO,IAAP;EACH;EACD,gBAAI7Y,IAAI,KAAKqY,QAAL,CAActZ,MAAtB;EAAA,gBAA8B+Z,KAAKD,EAAE,CAAF,EAAK9Z,MAAxC;EAAA,gBAAgD+H,CAAhD;EACA,gBAAI4R,OAAO,KAAKL,QAAL,CAAc,CAAd,EAAiBtZ,MAA5B;EAAA,gBAAoC2M,CAApC;EAAA,gBAAuC2M,WAAW,EAAlD;EAAA,gBAAsDiB,GAAtD;EACA,mBAAOtZ,GAAP,EACA;EACI8G,oBAAIgS,EAAJ;EACAT,yBAASrY,CAAT,IAAc,EAAd;EACA,uBAAO8G,GAAP,EACA;EACI4E,wBAAIgN,IAAJ;EACAY,0BAAM,CAAN;EACA,2BAAO5N,GAAP,EACA;EACI4N,+BAAO,KAAKjB,QAAL,CAAcrY,CAAd,EAAiB0L,CAAjB,IAAsBmN,EAAEnN,CAAF,EAAK5E,CAAL,CAA7B;EACH;EACDuR,6BAASrY,CAAT,EAAY8G,CAAZ,IAAiBwS,GAAjB;EACH;EACJ;EACD,gBAAIT,IAAI,IAAIT,MAAJ,CAAWC,QAAX,CAAR;EACA,mBAAOc,eAAeN,EAAEL,GAAF,CAAM,CAAN,CAAf,GAA0BK,CAAjC;EACH;EAhPL;EAAA;EAAA,8BAkPW7N,CAlPX,EAkPcpF,CAlPd,EAkPiB8F,CAlPjB,EAkPoB3L,CAlPpB,EAmPI;EACI,gBAAI,KAAKsY,QAAL,CAActZ,MAAd,KAAyB,CAA7B,EACA;EACI,uBAAO,IAAP;EACH;EACD,gBAAIsZ,WAAW,EAAf;EAAA,gBAAmBkB,KAAK7N,CAAxB;EAAA,gBAA2B1L,CAA3B;EAAA,gBAA8B8Y,EAA9B;EAAA,gBAAkChS,CAAlC;EACA,gBAAI6R,OAAO,KAAKN,QAAL,CAActZ,MAAzB;EAAA,gBAAiC2Z,OAAO,KAAKL,QAAL,CAAc,CAAd,EAAiBtZ,MAAzD;EACA,mBAAOwa,IAAP,EACA;EACIvZ,oBAAI0L,IAAI6N,EAAJ,GAAS,CAAb;EACAlB,yBAASrY,CAAT,IAAc,EAAd;EACA8Y,qBAAK/Y,CAAL;EACA,uBAAO+Y,IAAP,EACA;EACIhS,wBAAI/G,IAAI+Y,EAAJ,GAAS,CAAb;EACAT,6BAASrY,CAAT,EAAY8G,CAAZ,IAAiB,KAAKuR,QAAL,CAAc,CAACrN,IAAEhL,CAAF,GAAI,CAAL,IAAQ2Y,IAAtB,EAA4B,CAAC/S,IAAEkB,CAAF,GAAI,CAAL,IAAQ4R,IAApC,CAAjB;EACH;EACJ;EACD,mBAAO,IAAIN,MAAJ,CAAWC,QAAX,CAAP;EACH;EAtQL;EAAA;EAAA,oCAyQI;EACI,gBAAI,KAAKA,QAAL,CAActZ,MAAd,KAAyB,CAA7B,EACA;EACI,uBAAO,IAAIqZ,MAAJ,CAAW,EAAX,CAAP;EACH;EACD,gBAAIO,OAAO,KAAKN,QAAL,CAActZ,MAAzB;EAAA,gBAAiCiB,CAAjC;EAAA,gBAAoC0Y,OAAO,KAAKL,QAAL,CAAc,CAAd,EAAiBtZ,MAA5D;EAAA,gBAAoE+H,CAApE;EACA,gBAAIuR,WAAW,EAAf;EAAA,gBAAmBrY,IAAI0Y,IAAvB;EACA,mBAAO1Y,GAAP,EACA;EACI8G,oBAAI6R,IAAJ;EACAN,yBAASrY,CAAT,IAAc,EAAd;EACA,uBAAO8G,GAAP,EACA;EACIuR,6BAASrY,CAAT,EAAY8G,CAAZ,IAAiB,KAAKuR,QAAL,CAAcvR,CAAd,EAAiB9G,CAAjB,CAAjB;EACH;EACJ;EACD,mBAAO,IAAIoY,MAAJ,CAAWC,QAAX,CAAP;EACH;EA1RL;EAAA;EAAA,mCA6RI;EACI,gBAAIK,OAAQ,KAAKL,QAAL,CAActZ,MAAd,KAAyB,CAA1B,GAA+B,CAA/B,GAAmC,KAAKsZ,QAAL,CAAc,CAAd,EAAiBtZ,MAA/D;EACA,mBAAQ,KAAKsZ,QAAL,CAActZ,MAAd,KAAyB2Z,IAAjC;EACH;EAhSL;EAAA;EAAA,8BAmSI;EACI,gBAAI,KAAKL,QAAL,CAActZ,MAAd,KAAyB,CAA7B,EACA;EACI,uBAAO,IAAP;EACH;EACD,gBAAIya,IAAI,CAAR;EAAA,gBAAWxZ,IAAI,KAAKqY,QAAL,CAActZ,MAA7B;EAAA,gBAAqC+Z,KAAK,KAAKT,QAAL,CAAc,CAAd,EAAiBtZ,MAA3D;EAAA,gBAAmE+H,CAAnE;EACA,mBAAO9G,GAAP,EACA;EACI8G,oBAAIgS,EAAJ;EACA,uBAAOhS,GAAP,EACA;EACI,wBAAIqB,KAAK4Q,GAAL,CAAS,KAAKV,QAAL,CAAcrY,CAAd,EAAiB8G,CAAjB,CAAT,IAAgCqB,KAAK4Q,GAAL,CAASS,CAAT,CAApC,EACA;EACIA,4BAAI,KAAKnB,QAAL,CAAcrY,CAAd,EAAiB8G,CAAjB,CAAJ;EACH;EACJ;EACJ;EACD,mBAAO0S,CAAP;EACH;EArTL;EAAA;EAAA,gCAuTazR,CAvTb,EAwTI;EACI,gBAAI,KAAKsQ,QAAL,CAActZ,MAAd,KAAyB,CAA7B,EACA;EACI,uBAAO,IAAP;EACH;EACD,gBAAkBwa,KAAK,KAAKlB,QAAL,CAActZ,MAArC;EAAA,gBAA6CiB,CAA7C;EAAA,gBAAgD8Y,KAAK,KAAKT,QAAL,CAAc,CAAd,EAAiBtZ,MAAtE;EAAA,gBAA8E+H,CAA9E;EACA,iBAAK9G,IAAI,CAAT,EAAYA,IAAIuZ,EAAhB,EAAoBvZ,GAApB,EACA;EACI,qBAAK8G,IAAI,CAAT,EAAYA,IAAIgS,EAAhB,EAAoBhS,GAApB,EACA;EACI,wBAAI,KAAKuR,QAAL,CAAcrY,CAAd,EAAiB8G,CAAjB,MAAwBiB,CAA5B,EACA;EACI,+BAAO;EACH/H,+BAAGA,IAAE,CADF;EAEH8G,+BAAGA,IAAE;EAFF,yBAAP;EAIH;EACJ;EACJ;EACD,mBAAO,IAAP;EACH;EA5UL;EAAA;EAAA,mCA+UI;EACI,gBAAI,CAAC,KAAK2S,QAAV,EACA;EACI,uBAAO,IAAP;EACH;EACD,gBAAIR,MAAM,EAAV;EAAA,gBAAcR,IAAI,KAAKJ,QAAL,CAActZ,MAAhC;EACA,iBAAK,IAAIiB,IAAI,CAAb,EAAgBA,IAAIyY,CAApB,EAAuBzY,GAAvB,EACA;EACIiZ,oBAAIhZ,IAAJ,CAAS,KAAKoY,QAAL,CAAcrY,CAAd,EAAiBA,CAAjB,CAAT;EACH;EACD,mBAAO,IAAIuY,MAAJ,CAAWU,GAAX,CAAP;EACH;EA1VL;EAAA;EAAA,4CA6VI;EACI,gBAAI,KAAKZ,QAAL,CAActZ,MAAd,KAAyB,CAA7B,EACA;EACI,uBAAO,IAAIqZ,MAAJ,CAAW,EAAX,CAAP;EACH;EACD,gBAAIS,IAAI,KAAKa,GAAL,EAAR;EAAA,gBAAoBT,GAApB;EACA,gBAAIR,IAAI,KAAKJ,QAAL,CAActZ,MAAtB;EAAA,gBAA8BiB,CAA9B;EAAA,gBAAiC8G,CAAjC;EAAA,gBAAoC6S,KAAK,KAAKtB,QAAL,CAAc,CAAd,EAAiBtZ,MAA1D;EAAA,gBAAkE4D,CAAlE;EACA,iBAAK3C,IAAI,CAAT,EAAYA,IAAIyY,CAAhB,EAAmBzY,GAAnB,EACA;EACI,oBAAI6Y,EAAER,QAAF,CAAWrY,CAAX,EAAcA,CAAd,MAAqB,CAAzB,EACA;EACI,yBAAK8G,IAAI9G,IAAI,CAAb,EAAgB8G,IAAI2R,CAApB,EAAuB3R,GAAvB,EACA;EACI,4BAAI+R,EAAER,QAAF,CAAWvR,CAAX,EAAc9G,CAAd,MAAqB,CAAzB,EACA;EACIiZ,kCAAM,EAAN;EACA,iCAAKtW,IAAI,CAAT,EAAYA,IAAIgX,EAAhB,EAAoBhX,GAApB,EACA;EACIsW,oCAAIhZ,IAAJ,CAAS4Y,EAAER,QAAF,CAAWrY,CAAX,EAAc2C,CAAd,IAAmBkW,EAAER,QAAF,CAAWvR,CAAX,EAAcnE,CAAd,CAA5B;EACH;EACDkW,8BAAER,QAAF,CAAWrY,CAAX,IAAgBiZ,GAAhB;EACA;EACH;EACJ;EACJ;EACD,oBAAIJ,EAAER,QAAF,CAAWrY,CAAX,EAAcA,CAAd,MAAqB,CAAzB,EACA;EACI,yBAAK8G,IAAI9G,IAAI,CAAb,EAAgB8G,IAAI2R,CAApB,EAAuB3R,GAAvB,EACA;EACI,4BAAI8S,aAAaf,EAAER,QAAF,CAAWvR,CAAX,EAAc9G,CAAd,IAAmB6Y,EAAER,QAAF,CAAWrY,CAAX,EAAcA,CAAd,CAApC;EACAiZ,8BAAM,EAAN;EACA,6BAAKtW,IAAI,CAAT,EAAYA,IAAIgX,EAAhB,EAAoBhX,GAApB,EACA;EACI;EACA;EACA;EACA;EACAsW,gCAAIhZ,IAAJ,CAAS0C,KAAK3C,CAAL,GAAS,CAAT,GAAa6Y,EAAER,QAAF,CAAWvR,CAAX,EAAcnE,CAAd,IAAmBkW,EAAER,QAAF,CAAWrY,CAAX,EAAc2C,CAAd,IAAmBiX,UAA5D;EACH;EACDf,0BAAER,QAAF,CAAWvR,CAAX,IAAgBmS,GAAhB;EACH;EACJ;EACJ;EACD,mBAAOJ,CAAP;EACH;EAzYL;EAAA;EAAA,sCA4YI;EACI,gBAAI,KAAKR,QAAL,CAActZ,MAAd,KAAyB,CAA7B,EACA;EACI,uBAAO,CAAP;EACH;EACD,gBAAI,CAAC,KAAK0a,QAAL,EAAL,EACA;EACI,uBAAO,IAAP;EACH;EACD,gBAAIZ,IAAI,KAAKgB,iBAAL,EAAR;EACA,gBAAIC,MAAMjB,EAAER,QAAF,CAAW,CAAX,EAAc,CAAd,CAAV;EAAA,gBAA4BI,IAAII,EAAER,QAAF,CAAWtZ,MAA3C;EACA,iBAAK,IAAIiB,IAAI,CAAb,EAAgBA,IAAIyY,CAApB,EAAuBzY,GAAvB,EACA;EACI8Z,sBAAMA,MAAMjB,EAAER,QAAF,CAAWrY,CAAX,EAAcA,CAAd,CAAZ;EACH;EACD,mBAAO8Z,GAAP;EACH;EA5ZL;EAAA;EAAA,qCA+ZI;EACI,mBAAQ,KAAKL,QAAL,MAAmB,KAAKM,WAAL,OAAuB,CAAlD;EACH;EAjaL;EAAA;EAAA,gCAoaI;EACI,gBAAI,KAAK1B,QAAL,CAActZ,MAAd,KAAyB,CAA7B,EACA;EACI,uBAAO,CAAP;EACH;EACD,gBAAI,CAAC,KAAK0a,QAAL,EAAL,EACA;EACI,uBAAO,IAAP;EACH;EACD,gBAAIO,KAAK,KAAK3B,QAAL,CAAc,CAAd,EAAiB,CAAjB,CAAT;EAAA,gBAA8BI,IAAI,KAAKJ,QAAL,CAActZ,MAAhD;EACA,iBAAK,IAAIiB,IAAI,CAAb,EAAgBA,IAAIyY,CAApB,EAAuBzY,GAAvB,EACA;EACIga,sBAAM,KAAK3B,QAAL,CAAcrY,CAAd,EAAiBA,CAAjB,CAAN;EACH;EACD,mBAAOga,EAAP;EACH;EAnbL;EAAA;EAAA,+BAsbI;EACI,gBAAI,KAAK3B,QAAL,CAActZ,MAAd,KAAyB,CAA7B,EACA;EACI,uBAAO,CAAP;EACH;EACD,gBAAI8Z,IAAI,KAAKgB,iBAAL,EAAR;EAAA,gBAAkCI,OAAO,CAAzC;EACA,gBAAIja,IAAI,KAAKqY,QAAL,CAActZ,MAAtB;EAAA,gBAA8B+Z,KAAK,KAAKT,QAAL,CAAc,CAAd,EAAiBtZ,MAApD;EAAA,gBAA4D+H,CAA5D;EACA,mBAAO9G,GAAP,EACA;EACI8G,oBAAIgS,EAAJ;EACA,uBAAOhS,GAAP,EACA;EACI,wBAAIqB,KAAK4Q,GAAL,CAASF,EAAER,QAAF,CAAWrY,CAAX,EAAc8G,CAAd,CAAT,IAA6BqR,SAAjC,EACA;EACI8B;EACA;EACH;EACJ;EACJ;EACD,mBAAOA,IAAP;EACH;EA1cL;EAAA;EAAA,gCA4carB,MA5cb,EA6cI;EACI,gBAAI,KAAKP,QAAL,CAActZ,MAAd,KAAyB,CAA7B,EACA;EACI,uBAAO,KAAK2a,GAAL,EAAP;EACH;EACD,gBAAIb,IAAID,OAAOP,QAAP,IAAmBO,MAA3B;EACA,gBAAI,OAAOC,EAAE,CAAF,EAAK,CAAL,CAAP,KAAoB,WAAxB,EACA;EACIA,oBAAI,IAAIT,MAAJ,CAAWS,CAAX,EAAcR,QAAlB;EACH;EACD,gBAAI6B,IAAI,KAAKR,GAAL,EAAR;EAAA,gBAAoBhB,OAAOwB,EAAE7B,QAAF,CAAW,CAAX,EAActZ,MAAzC;EACA,gBAAIiB,IAAIka,EAAE7B,QAAF,CAAWtZ,MAAnB;EAAA,gBAA2B+Z,KAAKD,EAAE,CAAF,EAAK9Z,MAArC;EAAA,gBAA6C+H,CAA7C;EACA,gBAAI9G,MAAM6Y,EAAE9Z,MAAZ,EACA;EACI,uBAAO,IAAP;EACH;EACD,mBAAOiB,GAAP,EACA;EACI8G,oBAAIgS,EAAJ;EACA,uBAAOhS,GAAP,EACA;EACIoT,sBAAE7B,QAAF,CAAWrY,CAAX,EAAc0Y,OAAO5R,CAArB,IAA0B+R,EAAE7Y,CAAF,EAAK8G,CAAL,CAA1B;EACH;EACJ;EACD,mBAAOoT,CAAP;EACH;EAteL;EAAA;EAAA,kCAyeI;EACI,gBAAI,KAAK7B,QAAL,CAActZ,MAAd,KAAyB,CAA7B,EACA;EACI,uBAAO,IAAP;EACH;EACD,gBAAI,CAAC,KAAK0a,QAAL,EAAD,IAAoB,KAAKU,UAAL,EAAxB,EACA;EACI,uBAAO,IAAP;EACH;EACD,gBAAI1B,IAAI,KAAKJ,QAAL,CAActZ,MAAtB;EAAA,gBAA8BiB,IAAGyY,CAAjC;EAAA,gBAAoC3R,CAApC;EACA,gBAAI+R,IAAI,KAAKuB,OAAL,CAAahC,OAAOiC,CAAP,CAAS5B,CAAT,CAAb,EAA0BoB,iBAA1B,EAAR;EACA,gBAAIF,KAAKd,EAAER,QAAF,CAAW,CAAX,EAActZ,MAAvB;EAAA,gBAA+B4D,CAA/B;EAAA,gBAAkCsW,GAAlC;EAAA,gBAAuCqB,OAAvC;EACA,gBAAIC,mBAAmB,EAAvB;EAAA,gBAA2BC,WAA3B;EACA;EACA;EACA,mBAAOxa,GAAP,EACA;EACI;EACAiZ,sBAAM,EAAN;EACAsB,iCAAiBva,CAAjB,IAAsB,EAAtB;EACAsa,0BAAUzB,EAAER,QAAF,CAAWrY,CAAX,EAAcA,CAAd,CAAV;EACA,qBAAK2C,IAAI,CAAT,EAAYA,IAAIgX,EAAhB,EAAoBhX,GAApB,EACA;EACI6X,kCAAc3B,EAAER,QAAF,CAAWrY,CAAX,EAAc2C,CAAd,IAAmB2X,OAAjC;EACArB,wBAAIhZ,IAAJ,CAASua,WAAT;EACA;EACA;EACA,wBAAI7X,KAAK8V,CAAT,EACA;EACI8B,yCAAiBva,CAAjB,EAAoBC,IAApB,CAAyBua,WAAzB;EACH;EACJ;EACD3B,kBAAER,QAAF,CAAWrY,CAAX,IAAgBiZ,GAAhB;EACA;EACA;EACAnS,oBAAI9G,CAAJ;EACA,uBAAO8G,GAAP,EACA;EACImS,0BAAM,EAAN;EACA,yBAAKtW,IAAI,CAAT,EAAYA,IAAIgX,EAAhB,EAAoBhX,GAApB,EACA;EACIsW,4BAAIhZ,IAAJ,CAAS4Y,EAAER,QAAF,CAAWvR,CAAX,EAAcnE,CAAd,IAAmBkW,EAAER,QAAF,CAAWrY,CAAX,EAAc2C,CAAd,IAAmBkW,EAAER,QAAF,CAAWvR,CAAX,EAAc9G,CAAd,CAA/C;EACH;EACD6Y,sBAAER,QAAF,CAAWvR,CAAX,IAAgBmS,GAAhB;EACH;EACJ;EACD,mBAAO,IAAIb,MAAJ,CAAWmC,gBAAX,CAAP;EACH;EAxhBL;EAAA;EAAA,gCA2hBI;EACI,mBAAO,KAAKhc,GAAL,CAAS,UAASwJ,CAAT,EACZ;EACI,uBAAOI,KAAKsS,KAAL,CAAW1S,CAAX,CAAP;EACH,aAHE,CAAP;EAIH;EAhiBL;EAAA;EAAA,+BAkiBYA,CAliBZ,EAmiBI;EACI,mBAAO,KAAKxJ,GAAL,CAAS,UAASoE,CAAT,EACZ;EACI,uBAAQwF,KAAK4Q,GAAL,CAASpW,IAAIoF,CAAb,KAAmBoQ,SAApB,GAAiCpQ,CAAjC,GAAqCpF,CAA5C;EACH,aAHE,CAAP;EAIH;EAxiBL;EAAA;EAAA,kCA2iBI;EACI,gBAAI+X,cAAc,EAAlB;EACA,gBAAIjC,IAAI,KAAKJ,QAAL,CAActZ,MAAtB;EACA,gBAAI0Z,MAAM,CAAV,EAAa,OAAO,IAAP;EACb,iBAAK,IAAIzY,IAAI,CAAb,EAAgBA,IAAIyY,CAApB,EAAuBzY,GAAvB,EACA;EACI0a,4BAAYza,IAAZ,CAAiB,IAAIsY,MAAJ,CAAW,KAAKF,QAAL,CAAcrY,CAAd,CAAX,EAA6B2a,OAA7B,EAAjB;EACH;EACD,mBAAOD,YAAYE,IAAZ,CAAiB,IAAjB,CAAP;EACH;EApjBL;EAAA;EAAA,oCAsjBiB3B,GAtjBjB,EAujBI;EACI,gBAAIjZ,CAAJ;EAAA,gBAAO8G,CAAP;EAAA,gBAAUuR,WAAWY,IAAIZ,QAAJ,IAAgBY,GAArC;EACA,gBAAIZ,SAAS,CAAT,KAAe,OAAOA,SAAS,CAAT,EAAY,CAAZ,CAAP,KAA2B,WAA9C,EACA;EACIrY,oBAAIqY,SAAStZ,MAAb;EACA,qBAAKsZ,QAAL,GAAgB,EAAhB;EACA,uBAAOrY,GAAP,EACA;EACI8G,wBAAIuR,SAASrY,CAAT,EAAYjB,MAAhB;EACA,yBAAKsZ,QAAL,CAAcrY,CAAd,IAAmB,EAAnB;EACA,2BAAO8G,GAAP,EACA;EACI,6BAAKuR,QAAL,CAAcrY,CAAd,EAAiB8G,CAAjB,IAAsBuR,SAASrY,CAAT,EAAY8G,CAAZ,CAAtB;EACH;EACJ;EACD,uBAAO,IAAP;EACH;EACD,gBAAI2R,IAAIJ,SAAStZ,MAAjB;EACA,iBAAKsZ,QAAL,GAAgB,EAAhB;EACA,iBAAKrY,IAAI,CAAT,EAAYA,IAAIyY,CAAhB,EAAmBzY,GAAnB,EACA;EACI,qBAAKqY,QAAL,CAAcpY,IAAd,CAAmB,CAACoY,SAASrY,CAAT,CAAD,CAAnB;EACH;EACD,mBAAO,IAAP;EACH;;EAED;;EAjlBJ;EAAA;EAAA,kCAmlBI;EACI,gBAAI6a,SAAS,EAAb;EACA,gBAAI,KAAKxC,QAAL,CAActZ,MAAd,IAAwB,CAA5B,EACA;EACI,uBAAO,EAAP;EACH;;EAGD,iBAAK,IAAI+H,IAAI,CAAb,EAAgBA,IAAI,KAAKuR,QAAL,CAAc,CAAd,EAAiBtZ,MAArC,EAA6C+H,GAA7C,EACA;EACI,qBAAK,IAAI9G,IAAI,CAAb,EAAgBA,IAAI,KAAKqY,QAAL,CAActZ,MAAlC,EAA0CiB,GAA1C,EACA;EACI6a,2BAAO5a,IAAP,CAAY,KAAKoY,QAAL,CAAcrY,CAAd,EAAiB8G,CAAjB,CAAZ;EACH;EACJ;EACD,mBAAO+T,MAAP;EACH;;EAED;;EArmBJ;EAAA;EAAA,oCAumBI;EACI,gBAAI,KAAKxC,QAAL,CAActZ,MAAd,IAAwB,CAAxB,IAA6B,KAAKsZ,QAAL,CAAc,CAAd,EAAiBtZ,MAAjB,IAA2B,CAA5D,EACA;EACI,uBAAO,IAAP;EACH;;EAED,gBAAI,KAAKsZ,QAAL,CAActZ,MAAd,GAAuB,CAAvB,IAA4B,KAAKsZ,QAAL,CAAc,CAAd,EAAiBtZ,MAAjB,GAA0B,CAA1D,EACA;EACI,uBAAO,IAAP;EACH;;EAED,iBAAK,IAAIiB,IAAI,CAAb,EAAgBA,IAAI,KAAKqY,QAAL,CAActZ,MAAlC,EAA0CiB,GAA1C,EACA;EACI,qBAAK,IAAI8G,IAAI,KAAKuR,QAAL,CAAcrY,CAAd,EAAiBjB,MAA9B,EAAsC+H,IAAI,CAA1C,EAA6CA,GAA7C,EACA;EACI,wBAAI9G,KAAK8G,CAAT,EACA;EACI,6BAAKuR,QAAL,CAAcrY,CAAd,EAAiBC,IAAjB,CAAsB,CAAtB;EACH,qBAHD,MAKA;EACI,6BAAKoY,QAAL,CAAcrY,CAAd,EAAiBC,IAAjB,CAAsB,CAAtB;EACH;EACJ;EACJ;;EAED,iBAAK,IAAID,IAAI,KAAKqY,QAAL,CAActZ,MAA3B,EAAmCiB,IAAI,CAAvC,EAA0CA,GAA1C,EACA;EACI,oBAAIA,KAAK,CAAT,EACA;EACI,yBAAKqY,QAAL,CAAcpY,IAAd,CAAmB,CAAC,CAAD,EAAI,CAAJ,EAAO,CAAP,EAAU,CAAV,CAAnB;EACH,iBAHD,MAIK,IAAID,KAAK,CAAT,EACL;EACI,yBAAKqY,QAAL,CAAcpY,IAAd,CAAmB,CAAC,CAAD,EAAI,CAAJ,EAAO,CAAP,EAAU,CAAV,CAAnB;EACH,iBAHI,MAIA,IAAID,KAAK,CAAT,EACL;EACI,yBAAKqY,QAAL,CAAcpY,IAAd,CAAmB,CAAC,CAAD,EAAI,CAAJ,EAAO,CAAP,EAAU,CAAV,CAAnB;EACH,iBAHI,MAIA,IAAID,KAAK,CAAT,EACL;EACI,yBAAKqY,QAAL,CAAcpY,IAAd,CAAmB,CAAC,CAAD,EAAI,CAAJ,EAAO,CAAP,EAAU,CAAV,CAAnB;EACH;EACJ;;EAED,mBAAO,IAAP;EACH;;EAED;;EAxpBJ;EAAA;EAAA,kCA0pBI;EACI,gBAAI,KAAKoY,QAAL,CAActZ,MAAd,IAAwB,CAAxB,IAA6B,KAAKsZ,QAAL,CAAc,CAAd,EAAiBtZ,MAAjB,IAA2B,CAA5D,EACA;EACI,uBAAO,IAAP;EACH;;EAED,mBAAO,IAAIqZ,MAAJ,CAAW,CAAC,CAAC,KAAKC,QAAL,CAAc,CAAd,EAAiB,CAAjB,CAAD,EAAsB,KAAKA,QAAL,CAAc,CAAd,EAAiB,CAAjB,CAAtB,EAA2C,KAAKA,QAAL,CAAc,CAAd,EAAiB,CAAjB,CAA3C,CAAD,EACI,CAAC,KAAKA,QAAL,CAAc,CAAd,EAAiB,CAAjB,CAAD,EAAsB,KAAKA,QAAL,CAAc,CAAd,EAAiB,CAAjB,CAAtB,EAA2C,KAAKA,QAAL,CAAc,CAAd,EAAiB,CAAjB,CAA3C,CADJ,EAEI,CAAC,KAAKA,QAAL,CAAc,CAAd,EAAiB,CAAjB,CAAD,EAAsB,KAAKA,QAAL,CAAc,CAAd,EAAiB,CAAjB,CAAtB,EAA2C,KAAKA,QAAL,CAAc,CAAd,EAAiB,CAAjB,CAA3C,CAFJ,CAAX,CAAP;EAGH;EAnqBL;EAAA;EAAA;;EAsqBAD,OAAOiC,CAAP,GAAW,UAAS5B,CAAT,EACX;EACI,QAAIQ,MAAM,EAAV;EAAA,QAAcjZ,IAAIyY,CAAlB;EAAA,QAAqB3R,CAArB;EACA,WAAO9G,GAAP,EACA;EACI8G,YAAI2R,CAAJ;EACAQ,YAAIjZ,CAAJ,IAAS,EAAT;EACA,eAAO8G,GAAP,EACA;EACImS,gBAAIjZ,CAAJ,EAAO8G,CAAP,IAAa9G,MAAM8G,CAAP,GAAY,CAAZ,GAAgB,CAA5B;EACH;EACJ;EACD,WAAO,IAAIsR,MAAJ,CAAWa,GAAX,CAAP;EACH,CAbD;;EAeAb,OAAO0C,QAAP,GAAkB,UAASzC,QAAT,EAClB;EACI,QAAIrY,IAAIqY,SAAStZ,MAAjB;EACA,QAAI8Z,IAAIT,OAAOiC,CAAP,CAASra,CAAT,CAAR;EACA,WAAOA,GAAP,EACA;EACI6Y,UAAER,QAAF,CAAWrY,CAAX,EAAcA,CAAd,IAAmBqY,SAASrY,CAAT,CAAnB;EACH;EACD,WAAO6Y,CAAP;EACH,CATD;;EAWAT,OAAO2C,QAAP,GAAkB,UAASC,KAAT,EAAgBhQ,CAAhB,EAClB;EACI,QAAI,CAACA,CAAL,EACA;EACI,eAAO,IAAIoN,MAAJ,CAAW,CACd,CAACjQ,KAAK8S,GAAL,CAASD,KAAT,CAAD,EAAmB,CAAC7S,KAAK+S,GAAL,CAASF,KAAT,CAApB,CADc,EAEd,CAAC7S,KAAK+S,GAAL,CAASF,KAAT,CAAD,EAAoB7S,KAAK8S,GAAL,CAASD,KAAT,CAApB,CAFc,CAAX,CAAP;EAIH;EACD,QAAIlX,OAAOkH,EAAE0O,GAAF,EAAX;EACA,QAAI5V,KAAKuU,QAAL,CAActZ,MAAd,KAAyB,CAA7B,EACA;EACI,eAAO,IAAP;EACH;EACD,QAAIoc,MAAMrX,KAAKsV,OAAL,EAAV;EACA,QAAIrR,IAAIjE,KAAKuU,QAAL,CAAc,CAAd,IAAiB8C,GAAzB;EAAA,QAA8BnT,IAAIlE,KAAKuU,QAAL,CAAc,CAAd,IAAiB8C,GAAnD;EAAA,QAAwDtL,IAAI/L,KAAKuU,QAAL,CAAc,CAAd,IAAiB8C,GAA7E;EACA,QAAIC,IAAIjT,KAAK+S,GAAL,CAASF,KAAT,CAAR;EAAA,QAAyBtP,IAAIvD,KAAK8S,GAAL,CAASD,KAAT,CAA7B;EAAA,QAA8C3G,IAAI,IAAI3I,CAAtD;EACA;EACA;EACA;EACA,WAAO,IAAI0M,MAAJ,CAAW,CACd,CAAE/D,IAAEtM,CAAF,GAAIA,CAAJ,GAAQ2D,CAAV,EAAa2I,IAAEtM,CAAF,GAAIC,CAAJ,GAAQoT,IAAEvL,CAAvB,EAA0BwE,IAAEtM,CAAF,GAAI8H,CAAJ,GAAQuL,IAAEpT,CAApC,CADc,EAEd,CAAEqM,IAAEtM,CAAF,GAAIC,CAAJ,GAAQoT,IAAEvL,CAAZ,EAAewE,IAAErM,CAAF,GAAIA,CAAJ,GAAQ0D,CAAvB,EAA0B2I,IAAErM,CAAF,GAAI6H,CAAJ,GAAQuL,IAAErT,CAApC,CAFc,EAGd,CAAEsM,IAAEtM,CAAF,GAAI8H,CAAJ,GAAQuL,IAAEpT,CAAZ,EAAeqM,IAAErM,CAAF,GAAI6H,CAAJ,GAAQuL,IAAErT,CAAzB,EAA4BsM,IAAExE,CAAF,GAAIA,CAAJ,GAAQnE,CAApC,CAHc,CAAX,CAAP;EAKH,CAzBD;;EA2BA0M,OAAOiD,SAAP,GAAmB,UAAShH,CAAT,EACnB;EACI,QAAI3I,IAAIvD,KAAK8S,GAAL,CAAS5G,CAAT,CAAR;EAAA,QAAqB+G,IAAIjT,KAAK+S,GAAL,CAAS7G,CAAT,CAAzB;EACA,WAAO,IAAI+D,MAAJ,CAAW,CACd,CAAG,CAAH,EAAO,CAAP,EAAW,CAAX,CADc,EAEd,CAAG,CAAH,EAAO1M,CAAP,EAAU,CAAC0P,CAAX,CAFc,EAGd,CAAG,CAAH,EAAOA,CAAP,EAAW1P,CAAX,CAHc,CAAX,CAAP;EAKH,CARD;EASA0M,OAAOkD,SAAP,GAAmB,UAASjH,CAAT,EACnB;EACI,QAAI3I,IAAIvD,KAAK8S,GAAL,CAAS5G,CAAT,CAAR;EAAA,QAAqB+G,IAAIjT,KAAK+S,GAAL,CAAS7G,CAAT,CAAzB;EACA,WAAO,IAAI+D,MAAJ,CAAW,CACd,CAAG1M,CAAH,EAAO,CAAP,EAAW0P,CAAX,CADc,EAEd,CAAG,CAAH,EAAO,CAAP,EAAW,CAAX,CAFc,EAGd,CAAE,CAACA,CAAH,EAAO,CAAP,EAAW1P,CAAX,CAHc,CAAX,CAAP;EAKH,CARD;EASA0M,OAAOmD,SAAP,GAAmB,UAASlH,CAAT,EACnB;EACI,QAAI3I,IAAIvD,KAAK8S,GAAL,CAAS5G,CAAT,CAAR;EAAA,QAAqB+G,IAAIjT,KAAK+S,GAAL,CAAS7G,CAAT,CAAzB;EACA,WAAO,IAAI+D,MAAJ,CAAW,CACd,CAAG1M,CAAH,EAAM,CAAC0P,CAAP,EAAW,CAAX,CADc,EAEd,CAAGA,CAAH,EAAO1P,CAAP,EAAW,CAAX,CAFc,EAGd,CAAG,CAAH,EAAO,CAAP,EAAW,CAAX,CAHc,CAAX,CAAP;EAKH,CARD;;EAUA0M,OAAOoD,MAAP,GAAgB,UAAS/C,CAAT,EAAYe,CAAZ,EAChB;EACI,WAAOpB,OAAOqD,IAAP,CAAYhD,CAAZ,EAAee,CAAf,EAAkBjb,GAAlB,CAAsB,YACzB;EACI,eAAO4J,KAAKuT,MAAL,EAAP;EACH,KAHE,CAAP;EAIH,CAND;;EAQA;EACAtD,OAAOuD,WAAP,GAAqB,UAAUC,CAAV,EACrB;EACI,QAAIA,EAAEvD,QAAF,CAAWtZ,MAAX,IAAqB,CAAzB,EACA;EACI,YAAI0W,IAAI2C,OAAOiC,CAAP,CAAS,CAAT,CAAR;EACA5E,UAAE4C,QAAF,CAAW,CAAX,EAAc,CAAd,IAAmBuD,EAAEvD,QAAF,CAAW,CAAX,CAAnB;EACA5C,UAAE4C,QAAF,CAAW,CAAX,EAAc,CAAd,IAAmBuD,EAAEvD,QAAF,CAAW,CAAX,CAAnB;EACA,eAAO5C,CAAP;EACH;;EAED,QAAImG,EAAEvD,QAAF,CAAWtZ,MAAX,IAAqB,CAAzB,EACA;EACI,YAAI0W,IAAI2C,OAAOiC,CAAP,CAAS,CAAT,CAAR;EACA5E,UAAE4C,QAAF,CAAW,CAAX,EAAc,CAAd,IAAmBuD,EAAEvD,QAAF,CAAW,CAAX,CAAnB;EACA5C,UAAE4C,QAAF,CAAW,CAAX,EAAc,CAAd,IAAmBuD,EAAEvD,QAAF,CAAW,CAAX,CAAnB;EACA5C,UAAE4C,QAAF,CAAW,CAAX,EAAc,CAAd,IAAmBuD,EAAEvD,QAAF,CAAW,CAAX,CAAnB;EACA,eAAO5C,CAAP;EACH;;EAED,UAAM,gCAAN;EACH,CApBD;;EAsBA2C,OAAOqD,IAAP,GAAc,UAAShD,CAAT,EAAYe,CAAZ,EACd;EACI,QAAIP,MAAM,EAAV;EAAA,QAAcjZ,IAAIyY,CAAlB;EAAA,QAAqB3R,CAArB;EACA,WAAO9G,GAAP,EACA;EACI8G,YAAI0S,CAAJ;EACAP,YAAIjZ,CAAJ,IAAS,EAAT;EACA,eAAO8G,GAAP,EACA;EACImS,gBAAIjZ,CAAJ,EAAO8G,CAAP,IAAY,CAAZ;EACH;EACJ;EACD,WAAO,IAAIsR,MAAJ,CAAWa,GAAX,CAAP;EACH,CAbD;;EAeAb,OAAO7T,SAAP,CAAiBsX,iBAAjB,GAAqCzD,OAAO7T,SAAP,CAAiBsV,iBAAtD;EACAzB,OAAO7T,SAAP,CAAiBuV,GAAjB,GAAuB1B,OAAO7T,SAAP,CAAiBwV,WAAxC;EACA3B,OAAO7T,SAAP,CAAiByV,EAAjB,GAAsB5B,OAAO7T,SAAP,CAAiBuX,KAAvC;EACA1D,OAAO7T,SAAP,CAAiBwX,EAAjB,GAAsB3D,OAAO7T,SAAP,CAAiB0V,IAAvC;EACA7B,OAAO7T,SAAP,CAAiByX,GAAjB,GAAuB5D,OAAO7T,SAAP,CAAiB0X,OAAxC;EACA7D,OAAO7T,SAAP,CAAiBwD,CAAjB,GAAqBqQ,OAAO7T,SAAP,CAAiB2X,QAAtC;;MC1yBa3D,MAAb;EAEI,oBAAaF,QAAb,EACA;EAAA;;EACI,aAAKC,WAAL,CAAiBD,QAAjB;EACH;;EALL;EAAA;EAAA,0BAOOrY,CAPP,EAQI;EACI,mBAAQA,IAAI,CAAJ,IAASA,IAAI,KAAKqY,QAAL,CAActZ,MAA5B,GAAsC,IAAtC,GAA6C,KAAKsZ,QAAL,CAAcrY,IAAE,CAAhB,CAApD;EACH;EAVL;EAAA;EAAA,qCAaI;EACI,mBAAO,KAAKqY,QAAL,CAActZ,MAArB;EACH;EAfL;EAAA;EAAA,kCAkBI;EACI,mBAAOoJ,KAAK8C,IAAL,CAAU,KAAKkR,GAAL,CAAS,IAAT,CAAV,CAAP;EACH;EApBL;EAAA;EAAA,4BAsBSC,MAtBT,EAuBI;EACI,gBAAI3D,IAAI,KAAKJ,QAAL,CAActZ,MAAtB;EACA,gBAAIsd,IAAID,OAAO/D,QAAP,IAAmB+D,MAA3B;EACA,gBAAI3D,MAAM4D,EAAEtd,MAAZ,EACA;EACI,uBAAO,KAAP;EACH;EACD,mBAAO0Z,GAAP,EACA;EACI,oBAAItQ,KAAK4Q,GAAL,CAAS,KAAKV,QAAL,CAAcI,CAAd,IAAmB4D,EAAE5D,CAAF,CAA5B,IAAoCN,SAAxC,EACA;EACI,2BAAO,KAAP;EACH;EACJ;EACD,mBAAO,IAAP;EACH;EAtCL;EAAA;EAAA,8BAwCW;EACH,mBAAO,IAAII,MAAJ,CAAW,KAAKF,QAAhB,CAAP;EACH;EA1CL;EAAA;EAAA,4BA4CSW,EA5CT,EA4Ca1L,OA5Cb,EA6CI;EACI,gBAAI+K,WAAW,EAAf;EACA,iBAAKzW,IAAL,CAAU,UAASmG,CAAT,EAAY/H,CAAZ,EACN;EACIqY,yBAASpY,IAAT,CAAc+Y,GAAGlX,IAAH,CAAQwL,OAAR,EAAiBvF,CAAjB,EAAoB/H,CAApB,CAAd;EACH,aAHL;EAIA,mBAAO,IAAIuY,MAAJ,CAAWF,QAAX,CAAP;EACH;EApDL;EAAA;EAAA,gCAsDaW,EAtDb,EAsDiB1L,OAtDjB,EAuDI;EACI,gBAAImL,IAAI,KAAKJ,QAAL,CAActZ,MAAtB;EACA,iBAAK,IAAIiB,IAAI,CAAb,EAAgBA,IAAIyY,CAApB,EAAuBzY,GAAvB,EACA;EACIgZ,mBAAGlX,IAAH,CAAQwL,OAAR,EAAiB,KAAK+K,QAAL,CAAcrY,CAAd,CAAjB,EAAmCA,IAAE,CAArC;EACH;EACJ;EA7DL;EAAA;EAAA,uCAgEI;EACI,gBAAIyV,IAAI,KAAK2D,OAAL,EAAR;EACA,gBAAI3D,MAAM,CAAV,EACA;EACI,uBAAO,KAAKiE,GAAL,EAAP;EACH;EACD,mBAAO,KAAKnb,GAAL,CAAS,UAASwJ,CAAT,EACZ;EACI,uBAAOA,IAAE0N,CAAT;EACH,aAHE,CAAP;EAIH;EA1EL;EAAA;EAAA,kCA4Ee2G,MA5Ef,EA6EI;EACI,gBAAIC,IAAID,OAAO/D,QAAP,IAAmB+D,MAA3B;EACA,gBAAI3D,IAAI,KAAKJ,QAAL,CAActZ,MAAtB;EACA,gBAAI0Z,MAAM4D,EAAEtd,MAAZ,EACA;EACI,uBAAO,IAAP;EACH;EACD,gBAAIod,MAAM,CAAV;EAAA,gBAAaG,OAAO,CAApB;EAAA,gBAAuBC,OAAO,CAA9B;EACA;EACA,iBAAK3a,IAAL,CAAU,UAASmG,CAAT,EAAY/H,CAAZ,EACN;EACImc,uBAAOpU,IAAIsU,EAAErc,IAAE,CAAJ,CAAX;EACAsc,wBAAQvU,IAAIA,CAAZ;EACAwU,wBAAQF,EAAErc,IAAE,CAAJ,IAASqc,EAAErc,IAAE,CAAJ,CAAjB;EACH,aALL;EAMAsc,mBAAOnU,KAAK8C,IAAL,CAAUqR,IAAV,CAAP,CAAwBC,OAAOpU,KAAK8C,IAAL,CAAUsR,IAAV,CAAP;EACxB,gBAAID,OAAKC,IAAL,KAAc,CAAlB,EACA;EACI,uBAAO,IAAP;EACH;EACD,gBAAIvB,QAAQmB,OAAOG,OAAKC,IAAZ,CAAZ;EACA,gBAAIvB,QAAQ,CAAC,CAAb,EACA;EACIA,wBAAQ,CAAC,CAAT;EACH;EACD,gBAAIA,QAAQ,CAAZ,EACA;EACIA,wBAAQ,CAAR;EACH;EACD,mBAAO7S,KAAKqU,IAAL,CAAUxB,KAAV,CAAP;EACH;EA3GL;EAAA;EAAA,qCA6GkBoB,MA7GlB,EA8GI;EACI,gBAAIjR,QAAQ,KAAKsR,SAAL,CAAeL,MAAf,CAAZ;EACA,mBAAQjR,UAAU,IAAX,GAAmB,IAAnB,GAA2BA,SAASgN,SAA3C;EACH;EAjHL;EAAA;EAAA,yCAmHsBiE,MAnHtB,EAoHI;EACI,gBAAIjR,QAAQ,KAAKsR,SAAL,CAAeL,MAAf,CAAZ;EACA,mBAAQjR,UAAU,IAAX,GAAmB,IAAnB,GAA2BhD,KAAK4Q,GAAL,CAAS5N,QAAQhD,KAAKiD,EAAtB,KAA6B+M,SAA/D;EACH;EAvHL;EAAA;EAAA,0CAyHuBiE,MAzHvB,EA0HI;EACI,gBAAID,MAAM,KAAKA,GAAL,CAASC,MAAT,CAAV;EACA,mBAAQD,QAAQ,IAAT,GAAiB,IAAjB,GAAyBhU,KAAK4Q,GAAL,CAASoD,GAAT,KAAiBhE,SAAjD;EACH;EA7HL;EAAA;EAAA,4BA+HSiE,MA/HT,EAgII;EACI,gBAAIC,IAAID,OAAO/D,QAAP,IAAmB+D,MAA3B;EACA,gBAAI,KAAK/D,QAAL,CAActZ,MAAd,KAAyBsd,EAAEtd,MAA/B,EACA;EACI,uBAAO,IAAP;EACH;EACD,mBAAO,KAAKR,GAAL,CAAS,UAASwJ,CAAT,EAAY/H,CAAZ,EAAe;EAAE,uBAAO+H,IAAIsU,EAAErc,IAAE,CAAJ,CAAX;EAAoB,aAA9C,CAAP;EACH;EAvIL;EAAA;EAAA,iCAyIcoc,MAzId,EA0II;EACI,gBAAIC,IAAID,OAAO/D,QAAP,IAAmB+D,MAA3B;EACA,gBAAI,KAAK/D,QAAL,CAActZ,MAAd,KAAyBsd,EAAEtd,MAA/B,EACA;EACI,uBAAO,IAAP;EACH;EACD,mBAAO,KAAKR,GAAL,CAAS,UAASwJ,CAAT,EAAY/H,CAAZ,EACZ;EACI,uBAAO+H,IAAIsU,EAAErc,IAAE,CAAJ,CAAX;EACH,aAHE,CAAP;EAIH;EApJL;EAAA;EAAA,iCAsJciH,CAtJd,EAuJI;EACI,mBAAO,KAAK1I,GAAL,CAAS,UAASwJ,CAAT,EACZ;EACI,uBAAOA,IAAEd,CAAT;EACH,aAHE,CAAP;EAIH;EA5JL;EAAA;EAAA,4BA8JSmV,MA9JT,EA+JI;EACI,gBAAIC,IAAID,OAAO/D,QAAP,IAAmB+D,MAA3B;EACA,gBAAOM,UAAU,CAAjB;EAAA,gBAAoBjE,IAAI,KAAKJ,QAAL,CAActZ,MAAtC;EACA,gBAAI0Z,MAAM4D,EAAEtd,MAAZ,EACA;EACI,uBAAO,IAAP;EACH;EACD,mBAAO0Z,GAAP,EACA;EACIiE,2BAAW,KAAKrE,QAAL,CAAcI,CAAd,IAAmB4D,EAAE5D,CAAF,CAA9B;EACH;EACD,mBAAOiE,OAAP;EACH;EA3KL;EAAA;EAAA,8BA6KWN,MA7KX,EA8KI;EACI,gBAAIO,IAAIP,OAAO/D,QAAP,IAAmB+D,MAA3B;EACA,gBAAI,KAAK/D,QAAL,CAActZ,MAAd,KAAyB,CAAzB,IAA8B4d,EAAE5d,MAAF,KAAa,CAA/C,EACA;EACI,uBAAO,IAAP;EACH;EACD,gBAAI6d,IAAI,KAAKvE,QAAb;EACA,mBAAO,IAAIE,MAAJ,CAAW,CACbqE,EAAE,CAAF,IAAOD,EAAE,CAAF,CAAR,GAAiBC,EAAE,CAAF,IAAOD,EAAE,CAAF,CADV,EAEbC,EAAE,CAAF,IAAOD,EAAE,CAAF,CAAR,GAAiBC,EAAE,CAAF,IAAOD,EAAE,CAAF,CAFV,EAGbC,EAAE,CAAF,IAAOD,EAAE,CAAF,CAAR,GAAiBC,EAAE,CAAF,IAAOD,EAAE,CAAF,CAHV,CAAX,CAAP;EAKH;EA1LL;EAAA;EAAA,8BA6LI;EACI,gBAAInD,IAAI,CAAR;EAAA,gBAAWxZ,IAAI,KAAKqY,QAAL,CAActZ,MAA7B;EACA,mBAAOiB,GAAP,EACA;EACI,oBAAImI,KAAK4Q,GAAL,CAAS,KAAKV,QAAL,CAAcrY,CAAd,CAAT,IAA6BmI,KAAK4Q,GAAL,CAASS,CAAT,CAAjC,EACA;EACIA,wBAAI,KAAKnB,QAAL,CAAcrY,CAAd,CAAJ;EACH;EACJ;EACD,mBAAOwZ,CAAP;EACH;EAvML;EAAA;EAAA,gCAyMazR,CAzMb,EA0MI;EACI,gBAAIqN,QAAQ,IAAZ;EAAA,gBAAkBqD,IAAI,KAAKJ,QAAL,CAActZ,MAApC;EACA,iBAAK,IAAIiB,IAAI,CAAb,EAAgBA,IAAIyY,CAApB,EAAuBzY,GAAvB,EACA;EACI,oBAAIoV,UAAU,IAAV,IAAkB,KAAKiD,QAAL,CAAcrY,CAAd,MAAqB+H,CAA3C,EACA;EACIqN,4BAAQpV,IAAI,CAAZ;EACH;EACJ;EACD,mBAAOoV,KAAP;EACH;EApNL;EAAA;EAAA,2CAuNI;EACI,mBAAOgD,OAAO0C,QAAP,CAAgB,KAAKzC,QAArB,CAAP;EACH;EAzNL;EAAA;EAAA,gCA4NI;EACI,mBAAO,KAAK9Z,GAAL,CAAS,UAASwJ,CAAT,EACZ;EACI,uBAAOI,KAAKsS,KAAL,CAAW1S,CAAX,CAAP;EACH,aAHE,CAAP;EAIH;EAjOL;EAAA;EAAA,+BAmOYA,CAnOZ,EAoOI;EACI,mBAAO,KAAKxJ,GAAL,CAAS,UAASyJ,CAAT,EACZ;EACI,uBAAQG,KAAK4Q,GAAL,CAAS/Q,IAAID,CAAb,KAAmBoQ,SAApB,GAAiCpQ,CAAjC,GAAqCC,CAA5C;EACH,aAHE,CAAP;EAIH;EAzOL;EAAA;EAAA,qCA2OkB6U,GA3OlB,EA4OI;EACI,gBAAIA,IAAIC,MAAJ,IAAeD,IAAIE,KAAJ,IAAaF,IAAIG,GAApC,EACA;EACI,uBAAOH,IAAII,YAAJ,CAAiB,IAAjB,CAAP;EACH;EACD,gBAAIZ,IAAIQ,IAAIxE,QAAJ,IAAgBwE,GAAxB;EACA,gBAAIR,EAAEtd,MAAF,KAAa,KAAKsZ,QAAL,CAActZ,MAA/B,EACA;EACI,uBAAO,IAAP;EACH;EACD,gBAAIua,MAAM,CAAV;EAAA,gBAAa4D,IAAb;EACA,iBAAKtb,IAAL,CAAU,UAASmG,CAAT,EAAY/H,CAAZ,EACN;EACIkd,uBAAOnV,IAAIsU,EAAErc,IAAE,CAAJ,CAAX;EACAsZ,uBAAO4D,OAAOA,IAAd;EACH,aAJL;EAKA,mBAAO/U,KAAK8C,IAAL,CAAUqO,GAAV,CAAP;EACH;EA7PL;EAAA;EAAA,+BA+PY6D,IA/PZ,EAgQI;EACI,mBAAOA,KAAKC,QAAL,CAAc,IAAd,CAAP;EACH;EAlQL;EAAA;EAAA,+BAoQYC,KApQZ,EAqQI;EACI,mBAAOA,MAAMD,QAAN,CAAe,IAAf,CAAP;EACH;EAvQL;EAAA;EAAA,+BAyQY/I,CAzQZ,EAyQewI,GAzQf,EA0QI;EACI,gBAAIR,CAAJ;EAAA,gBAAOiB,IAAI,IAAX;EAAA,gBAAiBvV,CAAjB;EAAA,gBAAoBC,CAApB;EAAA,gBAAuB6H,CAAvB;EACA,gBAAIwE,EAAE0F,WAAN,EACA;EACIuD,oBAAIjJ,EAAEgE,QAAN;EACH;EACD,oBAAQ,KAAKA,QAAL,CAActZ,MAAtB;EAEI,qBAAK,CAAL;EACA;EACIsd,4BAAIQ,IAAIxE,QAAJ,IAAgBwE,GAApB;EACA,4BAAIR,EAAEtd,MAAF,KAAa,CAAjB,EACA;EACI,mCAAO,IAAP;EACH;EACD,4BAAI,CAACue,CAAL,EACA;EACIA,gCAAIlF,OAAO2C,QAAP,CAAgB1G,CAAhB,EAAmBgE,QAAvB;EACH;EACDtQ,4BAAI,KAAKsQ,QAAL,CAAc,CAAd,IAAmBgE,EAAE,CAAF,CAAvB;EACArU,4BAAI,KAAKqQ,QAAL,CAAc,CAAd,IAAmBgE,EAAE,CAAF,CAAvB;EACA,+BAAO,IAAI9D,MAAJ,CAAW,CACd8D,EAAE,CAAF,IAAOiB,EAAE,CAAF,EAAK,CAAL,IAAUvV,CAAjB,GAAqBuV,EAAE,CAAF,EAAK,CAAL,IAAUtV,CADjB,EAEdqU,EAAE,CAAF,IAAOiB,EAAE,CAAF,EAAK,CAAL,IAAUvV,CAAjB,GAAqBuV,EAAE,CAAF,EAAK,CAAL,IAAUtV,CAFjB,CAAX,CAAP;EAIA;EACH;EACD,qBAAK,CAAL;EACA;EACI,4BAAI,CAAC6U,IAAIU,SAAT,EACA;EACI,mCAAO,IAAP;EACH;EACD,4BAAIC,IAAIX,IAAIY,cAAJ,CAAmB,IAAnB,EAAyBpF,QAAjC;EACA,4BAAI,CAACiF,CAAL,EACA;EACIA,gCAAIlF,OAAO2C,QAAP,CAAgB1G,CAAhB,EAAmBwI,IAAIU,SAAvB,EAAkClF,QAAtC;EACH;EACDtQ,4BAAI,KAAKsQ,QAAL,CAAc,CAAd,IAAmBmF,EAAE,CAAF,CAAvB;EACAxV,4BAAI,KAAKqQ,QAAL,CAAc,CAAd,IAAmBmF,EAAE,CAAF,CAAvB;EACA3N,4BAAI,KAAKwI,QAAL,CAAc,CAAd,IAAmBmF,EAAE,CAAF,CAAvB;EACA,+BAAO,IAAIjF,MAAJ,CAAW,CACdiF,EAAE,CAAF,IAAOF,EAAE,CAAF,EAAK,CAAL,IAAUvV,CAAjB,GAAqBuV,EAAE,CAAF,EAAK,CAAL,IAAUtV,CAA/B,GAAmCsV,EAAE,CAAF,EAAK,CAAL,IAAUzN,CAD/B,EAEd2N,EAAE,CAAF,IAAOF,EAAE,CAAF,EAAK,CAAL,IAAUvV,CAAjB,GAAqBuV,EAAE,CAAF,EAAK,CAAL,IAAUtV,CAA/B,GAAmCsV,EAAE,CAAF,EAAK,CAAL,IAAUzN,CAF/B,EAGd2N,EAAE,CAAF,IAAOF,EAAE,CAAF,EAAK,CAAL,IAAUvV,CAAjB,GAAqBuV,EAAE,CAAF,EAAK,CAAL,IAAUtV,CAA/B,GAAmCsV,EAAE,CAAF,EAAK,CAAL,IAAUzN,CAH/B,CAAX,CAAP;EAKA;EACH;EACD;EACA;EACI,+BAAO,IAAP;EACH;EA7CL;EA+CH;EA/TL;EAAA;EAAA,qCAiUkBgN,GAjUlB,EAkUI;EACI,gBAAIA,IAAIC,MAAR,EACA;EACI;EACA,oBAAIY,IAAI,KAAKrF,QAAL,CAAc5Z,KAAd,EAAR;EACA,oBAAI+e,IAAIX,IAAIY,cAAJ,CAAmBC,CAAnB,EAAsBrF,QAA9B;EACA,uBAAO,IAAIE,MAAJ,CAAW,CAACiF,EAAE,CAAF,KAAQA,EAAE,CAAF,IAAOE,EAAE,CAAF,CAAf,CAAD,EAAuBF,EAAE,CAAF,KAAQA,EAAE,CAAF,IAAOE,EAAE,CAAF,CAAf,CAAvB,EAA6CF,EAAE,CAAF,KAAQA,EAAE,CAAF,KAAQE,EAAE,CAAF,KAAQ,CAAhB,CAAR,CAA7C,CAAX,CAAP;EACH,aAND,MAQA;EACI;EACA,oBAAIC,IAAId,IAAIxE,QAAJ,IAAgBwE,GAAxB;EACA,oBAAI,KAAKxE,QAAL,CAActZ,MAAd,KAAyB4e,EAAE5e,MAA/B,EACA;EACI,2BAAO,IAAP;EACH;EACD,uBAAO,KAAKR,GAAL,CAAS,UAASwJ,CAAT,EAAY/H,CAAZ,EAAe;EAAE,2BAAO2d,EAAE3d,IAAE,CAAJ,KAAU2d,EAAE3d,IAAE,CAAJ,IAAS+H,CAAnB,CAAP;EAA+B,iBAAzD,CAAP;EACH;EACJ;EApVL;EAAA;EAAA,+BAuVI;EACI,gBAAIsU,IAAI,KAAK3C,GAAL,EAAR;EACA,oBAAQ2C,EAAEhE,QAAF,CAAWtZ,MAAnB;EAEI,qBAAK,CAAL;EACA;EACI;EACH;EACD,qBAAK,CAAL;EACA;EACIsd,0BAAEhE,QAAF,CAAWpY,IAAX,CAAgB,CAAhB;EACA;EACH;EACD;EACA;EACI,+BAAO,IAAP;EACH;EAdL;EAgBA,mBAAOoc,CAAP;EACH;EA1WL;EAAA;EAAA,kCA6WI;EACI,mBAAO,MAAM,KAAKhE,QAAL,CAAcuC,IAAd,CAAmB,IAAnB,CAAN,GAAiC,GAAxC;EACH;EA/WL;EAAA;EAAA,oCAiXiB3B,GAjXjB,EAkXI;EACI,iBAAKZ,QAAL,GAAgB,CAACY,IAAIZ,QAAJ,IAAgBY,GAAjB,EAAsBxa,KAAtB,EAAhB;EACA,mBAAO,IAAP;EACH;;EAED;;EAvXJ;EAAA;EAAA,kCAyXI;EACI,mBAAO,KAAK4Z,QAAZ;EACH;EA3XL;EAAA;EAAA;;EA8XAE,OAAOiD,MAAP,GAAgB,UAAS/C,CAAT,EAChB;EACI,QAAIJ,WAAW,EAAf;EACA,WAAOI,GAAP,EACA;EACIJ,iBAASpY,IAAT,CAAckI,KAAKuT,MAAL,EAAd;EACH;EACD,WAAO,IAAInD,MAAJ,CAAWF,QAAX,CAAP;EACH,CARD;;EAUAE,OAAOkD,IAAP,GAAc,UAAShD,CAAT,EACd;EACI,QAAIJ,WAAW,EAAf;EACA,WAAOI,GAAP,EACA;EACIJ,iBAASpY,IAAT,CAAc,CAAd;EACH;EACD,WAAO,IAAIsY,MAAJ,CAAWF,QAAX,CAAP;EACH,CARD;;EAUAE,OAAOhU,SAAP,CAAiBwD,CAAjB,GAAqBwQ,OAAOhU,SAAP,CAAiB2X,QAAtC;EACA3D,OAAOhU,SAAP,CAAiB3C,IAAjB,GAAwB2W,OAAOhU,SAAP,CAAiBzE,OAAzC;;EAEAyY,OAAOvY,CAAP,GAAW,IAAIuY,MAAJ,CAAW,CAAC,CAAD,EAAG,CAAH,EAAK,CAAL,CAAX,CAAX;EACAA,OAAOzR,CAAP,GAAW,IAAIyR,MAAJ,CAAW,CAAC,CAAD,EAAG,CAAH,EAAK,CAAL,CAAX,CAAX;EACAA,OAAOtR,CAAP,GAAW,IAAIsR,MAAJ,CAAW,CAAC,CAAD,EAAG,CAAH,EAAK,CAAL,CAAX,CAAX;;EC1ZA,IAAMqF,mBAAmB,SAAnBA,gBAAmB,CAACze,MAAD,EAAS8R,QAAT,EAAmByD,GAAnB,EAA2B;EAClD,MAAMmJ,YAAY,EAAlB;;EAEA,MAAMlb,IAAIhC,OAAOC,IAAP,CAAYzB,OAAO0B,UAAnB,CAAV;EACA,MAAM6X,OAAO/V,EAAE5D,MAAf;EACA,MAAMiM,IAAI,GAAV,CALkD;EAMlD,OAAK,IAAIhL,IAAI,CAAb,EAAgBA,IAAI0Y,IAApB,EAA0B,EAAE1Y,CAA5B,EAA+B;EAC7B;EACA,QAAM+H,IAAIkJ,SAAStO,EAAE3C,CAAF,CAAT,CAAV;EACA,QAAMgI,IAAI7I,OAAO0B,UAAP,CAAkB8B,EAAE3C,CAAF,CAAlB,EAAwBsB,MAAxB,CAA+BoT,IAAI/R,EAAE3C,CAAF,CAAJ,CAA/B,CAAV;EACA6d,cAAU5d,IAAV,CAAe,IAAIsY,MAAJ,CAAW,CAACxQ,CAAD,EAAIC,CAAJ,CAAX,CAAf;;EAEA;EACA,QAAIhI,IAAI0Y,OAAO,CAAf,EAAkB;EAChB,UAAMoF,KAAK/V,IAAIiD,KAAKiG,SAAStO,EAAE3C,IAAI,CAAN,CAAT,IAAqB+H,CAA1B,CAAf;EACA,UAAIgW,KAAK/V,IAAIgD,KAAK7L,OAAO0B,UAAP,CAAkB8B,EAAE3C,IAAI,CAAN,CAAlB,EAA4BsB,MAA5B,CAAmCoT,IAAI/R,EAAE3C,IAAI,CAAN,CAAJ,CAAnC,IAAoDgI,CAAzD,CAAb;EACA,UAAI7I,OAAOqV,eAAP,KAA2B,IAA/B,EAAqC;EACnC,YAAMwJ,eAAe7e,OAAO8e,gBAAP,CAClBC,GADkB,CAEjB/e,OAAO0B,UAAP,CAAkB1B,OAAOqV,eAAzB,EAA0ClT,MAA1C,CACEoT,IAAIvV,OAAOqV,eAAX,CADF,CAFiB,EAMlB0J,GANkB,CAMdvb,EAAE3C,CAAF,CANc,CAArB;EAOA,YAAMme,gBAAgBhf,OAAO8e,gBAAP,CACnBC,GADmB,CAElB/e,OAAO0B,UAAP,CAAkB1B,OAAOqV,eAAzB,EAA0ClT,MAA1C,CACEoT,IAAIvV,OAAOqV,eAAX,CADF,CAFkB,EAMnB0J,GANmB,CAMfvb,EAAE3C,IAAI,CAAN,CANe,CAAtB;EAOA,YAAIoe,WAAW,OAAOJ,eAAeG,aAAtB,CAAf;EACAJ,aAAKK,WAAW,CAAC,IAAIjf,OAAOkf,gBAAZ,KAAiCN,KAAKK,QAAtC,CAAhB;EACD;EACDP,gBAAU5d,IAAV,CAAe,IAAIsY,MAAJ,CAAW,CAACuF,EAAD,EAAKC,EAAL,CAAX,CAAf;EACD;EACF;;EAED,SAAOF,SAAP;EACD,CAvCD;;ECAA,IAAMS,uBAAuB,SAAvBA,oBAAuB,CAACC,UAAD,EAAaV,SAAb,EAA2B;EACtD,MAAMnF,OAAOmF,UAAU9e,MAAvB;EACA,MAAMiM,IAAIuT,UAAV;EACA,MAAMC,MAAM,EAAZ;;EAEAA,MAAIve,IAAJ,CAAS4d,UAAU,CAAV,CAAT;EACAW,MAAIve,IAAJ,CACE,IAAIsY,MAAJ,CAAW,CACTsF,UAAU,CAAV,EAAavX,CAAb,CAAe,CAAf,IAAoB0E,IAAI,CAAJ,IAAS6S,UAAU,CAAV,EAAavX,CAAb,CAAe,CAAf,IAAoBuX,UAAU,CAAV,EAAavX,CAAb,CAAe,CAAf,CAA7B,CADX,EAETuX,UAAU,CAAV,EAAavX,CAAb,CAAe,CAAf,CAFS,CAAX,CADF;EAMA,OAAK,IAAIkS,MAAM,CAAf,EAAkBA,MAAME,OAAO,CAA/B,EAAkC,EAAEF,GAApC,EAAyC;EACvC,QAAIiG,MAAMZ,UAAUrF,GAAV,CAAV;EACA,QAAIjZ,OAAOse,UAAUrF,MAAM,CAAhB,CAAX;EACA,QAAIlZ,QAAQue,UAAUrF,MAAM,CAAhB,CAAZ;;EAEA,QAAIkG,OAAOnf,KAAKof,QAAL,CAAcrf,KAAd,CAAX;EACAkf,QAAIve,IAAJ,CAASwe,IAAI/f,GAAJ,CAAQggB,KAAK3W,CAAL,CAAOiD,CAAP,CAAR,CAAT;EACAwT,QAAIve,IAAJ,CAASwe,GAAT;EACAD,QAAIve,IAAJ,CAASwe,IAAIE,QAAJ,CAAaD,KAAK3W,CAAL,CAAOiD,CAAP,CAAb,CAAT;EACD;;EAEDwT,MAAIve,IAAJ,CACE,IAAIsY,MAAJ,CAAW,CACTsF,UAAUnF,OAAO,CAAjB,EAAoBpS,CAApB,CAAsB,CAAtB,IACE0E,IAAI,CAAJ,IAAS6S,UAAUnF,OAAO,CAAjB,EAAoBpS,CAApB,CAAsB,CAAtB,IAA2BuX,UAAUnF,OAAO,CAAjB,EAAoBpS,CAApB,CAAsB,CAAtB,CAApC,CAFO,EAGTuX,UAAUnF,OAAO,CAAjB,EAAoBpS,CAApB,CAAsB,CAAtB,CAHS,CAAX,CADF;EAOAkY,MAAIve,IAAJ,CAAS4d,UAAUnF,OAAO,CAAjB,CAAT;;EAEA,SAAO8F,GAAP;EACD,CAjCD;;ECFA;AACA;EAIA,IAAMI,cAAc,SAAdA,WAAc,CAACzf,MAAD,EAAS8R,QAAT,EAAmBlR,CAAnB,EAAsB8R,GAAtB,EAA8B;EAChD,MAAMgM,YAAYD,iBAAiBze,MAAjB,EAAyB8R,QAAzB,EAAmClR,CAAnC,CAAlB;EACA,MAAMye,MAAMF,qBAAqBnf,OAAOof,UAA5B,EAAwCV,SAAxC,CAAZ;;EAEAhM,MAAIgN,MAAJ,CAAWL,IAAI,CAAJ,EAAOlY,CAAP,CAAS,CAAT,CAAX,EAAwBkY,IAAI,CAAJ,EAAOlY,CAAP,CAAS,CAAT,CAAxB;;EAEA,OAAK,IAAItG,IAAI,CAAb,EAAgBA,IAAIwe,IAAIzf,MAAxB,EAAgCiB,KAAK,CAArC,EAAwC;EACtC,QAAIb,OAAO2f,iBAAX,EAA8B;EAC5B,WAAK,IAAIhY,IAAI,CAAb,EAAgBA,IAAI,CAApB,EAAuBA,GAAvB,EAA4B;EAC1B+K,YAAIpE,QAAJ,CAAa+Q,IAAIxe,IAAI8G,CAAR,EAAWR,CAAX,CAAa,CAAb,CAAb,EAA8BkY,IAAIxe,IAAI8G,CAAR,EAAWR,CAAX,CAAa,CAAb,CAA9B,EAA+C,CAA/C,EAAkD,CAAlD;EACD;EACF;EACDuL,QAAIkN,aAAJ,CACEP,IAAIxe,CAAJ,EAAOsG,CAAP,CAAS,CAAT,CADF,EAEEkY,IAAIxe,CAAJ,EAAOsG,CAAP,CAAS,CAAT,CAFF,EAGEkY,IAAIxe,IAAI,CAAR,EAAWsG,CAAX,CAAa,CAAb,CAHF,EAIEkY,IAAIxe,IAAI,CAAR,EAAWsG,CAAX,CAAa,CAAb,CAJF,EAKEkY,IAAIxe,IAAI,CAAR,EAAWsG,CAAX,CAAa,CAAb,CALF,EAMEkY,IAAIxe,IAAI,CAAR,EAAWsG,CAAX,CAAa,CAAb,CANF;EAQD;EACF,CArBD;;EAuBA;EACA,IAAM0Y,kBAAkB,SAAlBA,eAAkB,SAAU;EAChC,MAAI7f,OAAOuS,kBAAP,KAA8B,QAAlC,EAA4C;EAC1C,WAAOvH,EAAEhL,MAAF,IAAY,CAAnB;EACD,GAFD,MAEO,IAAIA,OAAOuS,kBAAP,KAA8B,KAAlC,EAAyC;EAC9C,WAAO,CAAP;EACD,GAFM,MAEA;EACLuN,YAAQC,GAAR,CACE,kFADF;EAGD;EACD,SAAO/U,EAAEhL,MAAF,IAAY,CAAnB;EACD,CAXD;;EAaA,IAAMggB,aAAa,SAAbA,UAAa,CAAChgB,MAAD,EAAS8R,QAAT,EAAmBlR,CAAnB,EAAsB8R,GAAtB,EAA8B;EAC/ClR,SAAOC,IAAP,CAAYzB,OAAO0B,UAAnB,EACGtC,GADH,CACO;EAAA,WAAK,CACR0S,SAAStO,CAAT,CADQ,EAER5C,EAAE4C,CAAF,MAASzB,SAAT,GACI8d,gBAAgB7f,MAAhB,CADJ,GAEIA,OAAO0B,UAAP,CAAkB8B,CAAlB,EAAqBrB,MAArB,CAA4BvB,EAAE4C,CAAF,CAA5B,CAJI,CAAL;EAAA,GADP,EAOG4P,IAPH,CAOQ,UAACvH,CAAD,EAAIpF,CAAJ;EAAA,WAAUoF,EAAE,CAAF,IAAOpF,EAAE,CAAF,CAAjB;EAAA,GAPR,EAQG9F,OARH,CAQW,UAAC6C,CAAD,EAAI3C,CAAJ,EAAU;EACjBA,UAAM,CAAN,GAAU6R,IAAIgN,MAAJ,CAAWlc,EAAE,CAAF,CAAX,EAAiBA,EAAE,CAAF,CAAjB,CAAV,GAAmCkP,IAAIuN,MAAJ,CAAWzc,EAAE,CAAF,CAAX,EAAiBA,EAAE,CAAF,CAAjB,CAAnC;EACD,GAVH;EAWD,CAZD;;EAcA;EACA,IAAM0c,YAAY,SAAZA,SAAY,CAAClgB,MAAD,EAAS8R,QAAT,EAAmBlR,CAAnB,EAAsB8R,GAAtB,EAA8B;EAC9CA,MAAIiE,SAAJ;EACA,MACG3W,OAAOqV,eAAP,KAA2B,IAA3B,IAAmCrV,OAAOkf,gBAAP,GAA0B,CAA9D,IACAlf,OAAOof,UAAP,GAAoB,CAFtB,EAGE;EACAK,gBAAYzf,MAAZ,EAAoB8R,QAApB,EAA8BlR,CAA9B,EAAiC8R,GAAjC;EACD,GALD,MAKO;EACLsN,eAAWhgB,MAAX,EAAmB8R,QAAnB,EAA6BlR,CAA7B,EAAgC8R,GAAhC;EACD;EACDA,MAAIkE,MAAJ;EACD,CAXD;;ECzDA,IAAMuJ,WAAW,SAAXA,QAAW;EAAA,SAAM,OAAO1D,CAAP,KAAa,UAAb,GAA0BA,CAA1B,GAA8B;EAAA,WAAMA,CAAN;EAAA,GAApC;EAAA,CAAjB;;ECGA,IAAM2D,WAAW,SAAXA,QAAW,CAACpgB,MAAD,EAAS0S,GAAT,EAAcZ,QAAd;EAAA,SAA2B,UAAClR,CAAD,EAAIC,CAAJ,EAAU;EACpD6R,QAAI2B,MAAJ,CAAWV,WAAX,GAAyB0M,SAAQrgB,OAAO4T,KAAf,EAAsBhT,CAAtB,EAAyBC,CAAzB,CAAzB;EACA,WAAOqf,UAAUlgB,MAAV,EAAkB8R,QAAlB,EAA4BlR,CAA5B,EAA+B8R,IAAI2B,MAAnC,CAAP;EACD,GAHgB;EAAA,CAAjB;;EAKA,IAAMiM,sBAAsB,SAAtBA,mBAAsB,CAACtgB,MAAD,EAASmB,EAAT,EAAauR,GAAb,EAAkBZ,QAAlB;EAAA,SAA+B,YAAM;EAC/D3Q,OAAGrB,KAAH,CAAS,QAAT;;EAEA,QAAIE,OAAOqU,MAAP,CAAczU,MAAlB,EAA0B;EACxBI,aAAOqU,MAAP,CAAc1T,OAAd,CAAsByf,SAASpgB,MAAT,EAAiB0S,GAAjB,EAAsBZ,QAAtB,CAAtB;EACD;EACF,GAN2B;EAAA,CAA5B;;EAQA,IAAMyO,oBAAoB,SAApBA,iBAAoB,CAACvgB,MAAD,EAASwgB,WAAT;EAAA,SAAyB,YAAM;EACvD,QAAIxgB,OAAOqU,MAAX,EAAmB;EACjBmM,kBAAYxgB,OAAOqU,MAAnB;EACD,KAFD,MAEO;EACLmM,kBAAY,EAAZ,EADK;EAEN;EACF,GANyB;EAAA,CAA1B;;EAQA,IAAM7I,eAAe,SAAfA,YAAe,CAAC3X,MAAD,EAASmB,EAAT,EAAaoD,MAAb;EAAA,SACnB,YAAW;EACT,QAAI,CAAC/C,OAAOC,IAAP,CAAYzB,OAAO0B,UAAnB,EAA+B9B,MAApC,EAA4CuB,GAAGgU,gBAAH;;EAE5ChU,OAAGwW,YAAH,CAAgB3X,OAAO+Q,IAAvB;EACAxM,WAAO5B,IAAP,CAAY,QAAZ,EAAsB,IAAtB;EACA,WAAO,IAAP;EACD,GAPkB;EAAA,CAArB;;ECpBA,IAAM8d,cAAc,SAAdA,WAAc,CAACzgB,MAAD,EAAS0S,GAAT,EAAcZ,QAAd;EAAA,SAA2B,UAAClR,CAAD,EAAIC,CAAJ,EAAU;EACvD,QAAIb,OAAOkU,YAAP,KAAwB,IAA5B,EAAkC;EAChCxB,UAAIvP,OAAJ,CAAYwQ,WAAZ,GAA0B0M,SAAQrgB,OAAOkU,YAAf,EAA6BtT,CAA7B,EAAgCC,CAAhC,CAA1B;EACD,KAFD,MAEO;EACL6R,UAAIvP,OAAJ,CAAYwQ,WAAZ,GAA0B0M,SAAQrgB,OAAO4T,KAAf,EAAsBhT,CAAtB,EAAyBC,CAAzB,CAA1B;EACD;EACD,WAAOqf,UAAUlgB,MAAV,EAAkB8R,QAAlB,EAA4BlR,CAA5B,EAA+B8R,IAAIvP,OAAnC,CAAP;EACD,GAPmB;EAAA,CAApB;;EASA,IAAMud,uBAAuB,SAAvBA,oBAAuB,CAAC1gB,MAAD,EAAS0S,GAAT,EAAcZ,QAAd,EAAwB3Q,EAAxB,EAA4BmC,UAA5B;EAAA,SAA2C,YAAM;EAC5EnC,OAAGrB,KAAH,CAAS,SAAT;;EAEA,QAAI6Y,UAAU3Y,MAAV,EAAkBsD,UAAlB,KAAiCtD,OAAOmD,OAAP,KAAmB,KAAxD,EAA+D;EAC7DnD,aAAOmD,OAAP,CAAexC,OAAf,CAAuB8f,YAAYzgB,MAAZ,EAAoB0S,GAApB,EAAyBZ,QAAzB,CAAvB;EACD;EACF,GAN4B;EAAA,CAA7B;;EAQA,IAAM6O,qBAAqB,SAArBA,kBAAqB,CAAC3gB,MAAD,EAASsD,UAAT,EAAqBsd,YAArB;EAAA,SAAsC,YAAM;EACrE,QAAIjI,UAAU3Y,MAAV,EAAkBsD,UAAlB,CAAJ,EAAmC;EACjCsd,mBAAa5gB,OAAOmD,OAApB;EACD,KAFD,MAEO;EACLyd,mBAAa,EAAb,EADK;EAEN;EACF,GAN0B;EAAA,CAA3B;;EAQA,IAAM5d,gBAAgB,SAAhBA,aAAgB,CAAChD,MAAD,EAASmB,EAAT,EAAaoD,MAAb;EAAA,SACpB,YAAW;EACT,QAAI,CAAC/C,OAAOC,IAAP,CAAYzB,OAAO0B,UAAnB,EAA+B9B,MAApC,EAA4CuB,GAAGgU,gBAAH;;EAE5ChU,OAAG6B,aAAH,CAAiBhD,OAAO+Q,IAAxB;EACAxM,WAAO5B,IAAP,CAAY,QAAZ,EAAsB,IAAtB;EACA,WAAO,IAAP;EACD,GAPmB;EAAA,CAAtB;;EC3BA,IAAMM,eAAa,SAAbA,UAAa,CAACjD,MAAD,EAASmB,EAAT;EAAA,SACjB,UAAS+B,SAAT,EAAoB;EAClB,QAAM2d,gBAAgB,EAAtB;EACA,SAAK,IAAIlZ,IAAI,CAAb,EAAgBA,IAAI3H,OAAOsB,OAAP,CAAe1B,MAAnC,EAA2C+H,GAA3C,EAAgD;EAC9C,UAAI3H,OAAOsB,OAAP,CAAeqG,CAAf,EAAkB9I,IAAlB,KAA2BqE,SAA/B,EAA0C;EACxC2d,sBAAc/f,IAAd,CAAmBd,OAAOsB,OAAP,CAAeqG,CAAf,CAAnB;EACD;EACF;;EAED3H,WAAOsB,OAAP,GAAiBuf,aAAjB;EACA7gB,WAAOmD,OAAP,GAAiB,KAAjB;;EAEA,QAAIhC,GAAGoB,CAAH,OAAWR,SAAf,EAA0B;EACxB,UAAM4N,QAAQxO,GACXoB,CADW,GAEXC,SAFW,CAED,QAFC,EAGXmN,KAHW,EAAd;EAIA,WAAK,IAAI9O,IAAI,CAAb,EAAgBA,IAAI8O,MAAM/P,MAA1B,EAAkCiB,GAAlC,EAAuC;EACrC,YAAI8O,MAAM9O,CAAN,EAAS+O,QAAT,KAAsB1M,SAA1B,EAAqC;EACnC;EACAR,6BAAOA,mBAAOiN,MAAM9O,CAAN,CAAP,EAAiB8O,KAAjB,GAAyB,CAAzB,EAA4BoF,UAAnC,EACGvS,SADH,CACa,QADb,EAEGuD,MAFH;EAGA/F,iBAAO0B,UAAP,CAAkBwB,SAAlB,EAA6BpB,KAA7B,CAAmCc,IAAnC,CAAwCF,mBAAOiN,MAAM9O,CAAN,CAAP,EAAiB,IAAjB,CAAxC;EACD;EACF;EACF;;EAED,WAAO,IAAP;EACD,GA7BgB;EAAA,CAAnB;;ECFA;EACA,IAAMigB,SAAS,SAATA,MAAS,IAAK;EAClB,SAAO,GAAGvZ,QAAH,CACJ5E,IADI,CACC8Z,CADD,EAEJsE,KAFI,CAEE,eAFF,EAEmB,CAFnB,EAGJC,WAHI,EAAP;EAID,CALD;;ECDA;EACA,IAAMzZ,WAAW,SAAXA,QAAW;EAAA,SAAU;EAAA,WACzB,2BACA/F,OAAOC,IAAP,CAAYzB,OAAO0B,UAAnB,EAA+B9B,MAD/B,GAEA,eAFA,GAGA4B,OAAOC,IAAP,CAAYzB,OAAOnB,IAAP,CAAY,CAAZ,CAAZ,EAA4Be,MAH5B,GAIA,YAJA,GAKAI,OAAOnB,IAAP,CAAYe,MALZ,GAMA,OAPyB;EAAA,GAAV;EAAA,CAAjB;;ECDA;EACA,IAAMqhB,gBAAgB,SAAhBA,aAAgB,MAAO;EAC3B,MAAIC,MAAM,EAAV;EACA,OAAK,IAAIrgB,IAAI,CAAb,EAAgBA,IAAIsgB,IAAIvhB,MAAJ,GAAa,CAAjC,EAAoCiB,GAApC,EAAyC;EACvCqgB,QAAIpgB,IAAJ,CAAS,CAACqgB,IAAItgB,CAAJ,CAAD,EAASsgB,IAAItgB,IAAI,CAAR,CAAT,CAAT;EACD;EACD,SAAOqgB,GAAP;EACD,CAND;;ECIA,IAAME,gBAAgB,SAAhBA,aAAgB,CAACphB,MAAD,EAAS0S,GAAT,EAAcZ,QAAd;EAAA,SAA2B,UAAClR,CAAD,EAAIC,CAAJ,EAAU;EACzD6R,QAAIyB,SAAJ,CAAcR,WAAd,GAA4B0M,SAAQrgB,OAAO4T,KAAf,EAAsBhT,CAAtB,EAAyBC,CAAzB,CAA5B;EACA,WAAOqf,UAAUlgB,MAAV,EAAkB8R,QAAlB,EAA4BlR,CAA5B,EAA+B8R,IAAIyB,SAAnC,CAAP;EACD,GAHqB;EAAA,CAAtB;;EAKA;EACA,IAAMA,YAAY,SAAZA,SAAY,CAACnU,MAAD,EAASmB,EAAT,EAAaqM,MAAb,EAAqBjJ,MAArB,EAA6BmO,GAA7B,EAAkCZ,QAAlC;EAAA,SAChB,YAAsB;EAAA,QAAbjT,IAAa,uEAAN,IAAM;;EACpB,QAAIA,SAAS,IAAb,EAAmB;EACjB,aAAOmB,OAAOkY,WAAd;EACD;;EAEDlY,WAAOkY,WAAP,GAAqBrZ,IAArB;EACAsC,OAAGrB,KAAH,CAAS,WAAT;EACA0C,0BAAU,CAACgL,OAAOC,UAAR,EAAoBD,OAAOrK,OAA3B,CAAV,EAA+Cke,OAA/C,CAAuD,OAAvD,EAAgE,IAAhE;EACAxiB,SAAK8B,OAAL,CAAaygB,cAAcphB,MAAd,EAAsB0S,GAAtB,EAA2BZ,QAA3B,CAAb;EACAvN,WAAO5B,IAAP,CAAY,WAAZ,EAAyB,IAAzB,EAA+B9D,IAA/B;EACA,WAAO,IAAP;EACD,GAZe;EAAA,CAAlB;;ECTA;EACA,IAAMsZ,cAAc,SAAdA,WAAc,CAACnY,MAAD,EAASmB,EAAT,EAAaqM,MAAb;EAAA,SAClB,YAAW;EACTxN,WAAOkY,WAAP,GAAqB,EAArB;EACA/W,OAAGrB,KAAH,CAAS,WAAT;EACA0C,0BAAU,CAACgL,OAAOC,UAAR,EAAoBD,OAAOrK,OAA3B,CAAV,EAA+Cke,OAA/C,CAAuD,OAAvD,EAAgE,KAAhE;EACA,WAAO,IAAP;EACD,GANiB;EAAA,CAApB;;ECCA;EACA,IAAMhJ,OAAO,SAAPA,IAAO,CAACrY,MAAD,EAASmB,EAAT,EAAaqM,MAAb,EAAqBjJ,MAArB,EAA6BmO,GAA7B,EAAkCZ,QAAlC;EAAA,SACX,YAAsB;EAAA,QAAbjT,IAAa,uEAAN,IAAM;;EACpB,QAAIA,SAAS,IAAb,EAAmB;EACjB,aAAOmB,OAAOqU,MAAd;EACD;;EAED;EACArU,WAAOqU,MAAP,GAAgBrU,OAAOqU,MAAP,CAAc7U,MAAd,CAAqBX,IAArB,CAAhB;EACA2D,0BAAU,CAACgL,OAAOC,UAAR,EAAoBD,OAAOrK,OAA3B,CAAV,EAA+Cke,OAA/C,CAAuD,QAAvD,EAAiE,IAAjE;EACAxiB,SAAK8B,OAAL,CAAayf,SAASpgB,MAAT,EAAiB0S,GAAjB,EAAsBZ,QAAtB,CAAb;EACAvN,WAAO5B,IAAP,CAAY,MAAZ,EAAoB,IAApB,EAA0B9D,IAA1B;EACA,WAAO,IAAP;EACD,GAZU;EAAA,CAAb;;ECHA;EACA,IAAMuZ,SAAS,SAATA,MAAS,CAACpY,MAAD,EAASmB,EAAT,EAAaqM,MAAb;EAAA,SACb,YAAW;EACTxN,WAAOqU,MAAP,GAAgB,EAAhB;EACAlT,OAAGrB,KAAH,CAAS,QAAT;EACA0C,0BAAU,CAACgL,OAAOC,UAAR,EAAoBD,OAAOrK,OAA3B,CAAV,EAA+Cke,OAA/C,CAAuD,QAAvD,EAAiE,KAAjE;EACA,WAAO,IAAP;EACD,GANY;EAAA,CAAf;;ECHA,IAAMnL,aAAa,SAAbA,UAAa;EAAA,SACjB,YAAW;EACT/U,OAAGgV,EAAH,CAAMpQ,MAAN;;EAEA,WAAO5E,GAAGgV,EAAV;EACA,WAAO,IAAP;EACD,GANgB;EAAA,CAAnB;;ECAA;;;;;;;;;;;EAWA,IAAMrX,SAAS,SAATA,MAAS,CAACkB,MAAD,EAASmB,EAAT,EAAaoD,MAAb;EAAA,SACb,YAAW;EACT;EACA,QAAI,CAAC/C,OAAOC,IAAP,CAAYzB,OAAO0B,UAAnB,EAA+B9B,MAApC,EAA4C;EAC1CuB,SAAGgU,gBAAH;EACD;EACDhU,OAAGsR,SAAH;;EAEAtR,OAAGrC,MAAH,CAAUkB,OAAO+Q,IAAjB;;EAEAxM,WAAO5B,IAAP,CAAY,QAAZ,EAAsB,IAAtB;EACA,WAAO,IAAP;EACD,GAZY;EAAA,CAAf;;ECRA,IAAM2e,iBAAiB,SAAjBA,cAAiB,CAACthB,MAAD,EAAS0S,GAAT,EAAcZ,QAAd;EAAA,SAA2B,UAAClR,CAAD,EAAIC,CAAJ,EAAU;EAC1D6R,QAAIjF,UAAJ,CAAekG,WAAf,GAA6B0M,SAAQrgB,OAAO4T,KAAf,EAAsBhT,CAAtB,EAAyBC,CAAzB,CAA7B;EACA,WAAOqf,UAAUlgB,MAAV,EAAkB8R,QAAlB,EAA4BlR,CAA5B,EAA+B8R,IAAIjF,UAAnC,CAAP;EACD,GAHsB;EAAA,CAAvB;;EAKA,IAAM8T,gBAAgB,SAAhBA,aAAgB,CAACvhB,MAAD,EAASmB,EAAT,EAAauR,GAAb,EAAkBZ,QAAlB;EAAA,SAA+B,YAAM;EACzD3Q,OAAGrB,KAAH,CAAS,YAAT;EACAqB,OAAGrB,KAAH,CAAS,WAAT;;EAEAqB,OAAG6B,aAAH,CAAiBwe,OAAjB;EACArgB,OAAGwW,YAAH,CAAgB6J,OAAhB;;EAEAxhB,WAAOnB,IAAP,CAAY8B,OAAZ,CAAoB2gB,eAAethB,MAAf,EAAuB0S,GAAvB,EAA4BZ,QAA5B,CAApB;EACD,GARqB;EAAA,CAAtB;;EAUA,IAAM2P,qBAAqB,SAArBA,kBAAqB,CAACzhB,MAAD,EAASmB,EAAT,EAAaugB,eAAb;EAAA,SAAiC,YAAM;EAChEvgB,OAAG6B,aAAH,CAAiB2e,KAAjB;EACAxgB,OAAGwW,YAAH,CAAgBgK,KAAhB;EACAD,oBAAgB1hB,OAAOnB,IAAvB;EACD,GAJ0B;EAAA,CAA3B;;EChBA;EACA,IAAM+iB,sBAAsB,SAAtBA,mBAAsB;EAAA,SAC1BC,WAAWpF,CAAX,KAAiBA,CAAjB,IAAsBA,MAAM,IAA5B,GAAmC,QAAnC,GAA8CqE,OAAOrE,CAAP,CADpB;EAAA,CAA5B;;ECDA;EACA,IAAM9G,uBAAuB,SAAvBA,oBAAuB;EAAA,SAC3BnU,OAAOC,IAAP,CAAY5C,KAAK,CAAL,CAAZ,EAAqB8C,MAArB,CAA4B,UAACC,GAAD,EAAMC,GAAN,EAAc;EACxC,QAAM0M,MAAM3E,MAAM+D,OAAO9L,GAAP,CAAN,IAAqBA,GAArB,GAA2BigB,SAASjgB,GAAT,CAAvC;EACAD,QAAI2M,GAAJ,IAAWqT,oBAAoB/iB,KAAK,CAAL,EAAQgD,GAAR,CAApB,CAAX;;EAEA,WAAOD,GAAP;EACD,GALD,EAKG,EALH,CAD2B;EAAA,CAA7B;;ECDA,IAAMyJ,0BAA0B,SAA1BA,uBAA0B;EAAA,SAAU;EAAA,WACxC7J,OAAOC,IAAP,CAAYzB,OAAO0B,UAAnB,EAA+B0R,IAA/B,CAAoC,UAACxK,CAAD,EAAIC,CAAJ;EAAA,aAClCkZ,kBAAU/hB,OAAO0B,UAAP,CAAkBkH,CAAlB,EAAqBqN,KAA/B,EAAsCjW,OAAO0B,UAAP,CAAkBmH,CAAlB,EAAqBoN,KAA3D,CADkC;EAAA,KAApC,CADwC;EAAA,GAAV;EAAA,CAAhC;;ECFA,IAAM+L,cAAc,SAAdA,WAAc;EAAA,SAClB,YAAW;EACTjQ,UAAMiQ,WAAN,GAAoB,IAApB;EACA,WAAO,IAAP;EACD,GAJiB;EAAA,CAApB;;ECAA,IAAMC,UAAU,SAAVA,OAAU,CAAClQ,KAAD,EAAQ5Q,EAAR;EAAA,SACd,YAAW;EACT4Q,UAAMkQ,OAAN,GAAgB,IAAhB;EACA9gB,OAAG4X,cAAH,CAAkB,GAAlB;EACA5X,OAAGrC,MAAH;EACA,WAAO,IAAP;EACD,GANa;EAAA,CAAhB;;ECEA;;;;;;;;EAQA,IAAMojB,OAAO,SAAPA,IAAO,CAACliB,MAAD,EAASwN,MAAT,EAAiBkF,GAAjB,EAAyB;EACpC;;;;;;EAMA,MAAMvR,KAAK,SAALA,EAAK,CAASb,SAAT,EAAoB;EAC7BA,gBAAYa,GAAGb,SAAH,GAAeoC,mBAAOpC,SAAP,CAA3B;;EAEAN,WAAOC,KAAP,GAAeK,UAAU+E,IAAV,GAAiB4I,WAAhC;EACAjO,WAAOiL,MAAP,GAAgB3K,UAAU+E,IAAV,GAAiB6I,YAAjC;EACA;EACA,KAAC,MAAD,EAAS,YAAT,EAAuB,SAAvB,EAAkC,QAAlC,EAA4C,WAA5C,EAAyDvN,OAAzD,CAAiE,iBAAS;EACxE6M,aAAOqL,KAAP,IAAgBvY,UACbqF,MADa,CACN,QADM,EAEbC,IAFa,CAER,OAFQ,EAECiT,KAFD,EAGbxT,IAHa,EAAhB;EAIAqN,UAAImG,KAAJ,IAAarL,OAAOqL,KAAP,EAAczK,UAAd,CAAyB,IAAzB,CAAb;EACD,KAND;;EAQA;EACAjN,OAAG6I,GAAH,GAAS1J,UACNqF,MADM,CACC,KADD,EAENC,IAFM,CAED,OAFC,EAEQ5F,OAAOC,KAFf,EAGN2F,IAHM,CAGD,QAHC,EAGS5F,OAAOiL,MAHhB,EAINpF,KAJM,CAIA,MAJA,EAIQ,iBAJR,EAKNA,KALM,CAKA,UALA,EAKY,UALZ,EAONF,MAPM,CAOC,OAPD,EAQNC,IARM,CASL,WATK,EAUL,eAAe5F,OAAOE,MAAP,CAAcE,IAA7B,GAAoC,GAApC,GAA0CJ,OAAOE,MAAP,CAAc6K,GAAxD,GAA8D,GAVzD,CAAT;EAYA;EACA,WAAO5J,EAAP;EACD,GA7BD;;EA+BA;EACA,SAAOA,EAAP;EACD,CAxCD;;ECVA,IAAMiQ,OAAO,SAAPA,IAAO;EAAA,SACX,UAASxQ,CAAT,EAAY;EACV;EACAZ,WAAO0B,UAAP,CAAkBd,CAAlB,EAAqBuB,MAArB,CAA4B3B,MAA5B,CACER,OAAO0B,UAAP,CAAkBd,CAAlB,EAAqBuB,MAArB,CAA4B3B,MAA5B,GAAqCuC,OAArC,EADF,EAFU;;EAMV,WAAO,IAAP;EACD,GARU;EAAA,CAAb;;ECAA,IAAMoS,mBAAmB,SAAnBA,gBAAmB;EAAA,SACvB,YAAW;EACThU,OAAGO,UAAH,CAAcP,GAAGsU,sBAAH,EAAd;EACA,WAAO,IAAP;EACD,GAJsB;EAAA,CAAzB;;ECAA,IAAMlV,QAAQ,SAARA,KAAQ,CAACP,MAAD,EAASmB,EAAT;EAAA,SACZ,UAASP,CAAT,EAAYJ,MAAZ,EAAoB;EAClBR,WAAO0B,UAAP,CAAkBd,CAAlB,EAAqBuB,MAArB,CAA4B3B,MAA5B,CAAmCA,MAAnC;EACAW,OAAGrC,MAAH,CAAU0iB,OAAV;EACArgB,OAAG0Q,UAAH;;EAEA,WAAO,IAAP;EACD,GAPW;EAAA,CAAd;;;;ECAA,IAAMsQ,gBAAgB;EACpBtjB,QAAM,EADc;EAEpBqZ,eAAa,EAFO;EAGpB7D,UAAQ,EAHY;EAIpB3S,cAAY,EAJQ;EAKpBiQ,0BAAwB,CALJ;EAMpBrQ,WAAS,EANW;EAOpB6B,WAAS,KAPW;EAQpB+Q,gBAAc,IARM;EASpB6E,kBAAgB,GATI;EAUpBlF,aAAW,GAVS;EAWpBO,wBAAsB,CAXF;EAYpBrD,QAAM,SAZc;EAapBuD,mBAAiB,CAbG;EAcpBE,qBAAmB,SAdC;EAepBE,oBAAkB,EAfE;EAgBpBjV,QAAM,EAhBc;EAiBpBQ,SAAO,GAjBa;EAkBpBgL,UAAQ,GAlBY;EAmBpB/K,UAAQ,EAAE6K,KAAK,EAAP,EAAW5K,OAAO,EAAlB,EAAsB+K,QAAQ,EAA9B,EAAkC9K,MAAM,EAAxC,EAnBY;EAoBpBmS,sBAAoB,WApBA;EAqBpBC,6BAA2B,EAAEzH,KAAK,CAAP,EAAU5K,OAAO,CAAjB,EAAoB+K,QAAQ,CAA5B,EAA+B9K,MAAM,CAArC,EArBP;EAsBpBwT,SAAO,MAtBa;EAuBpBG,aAAW,aAvBS;EAwBpBE,SAAO,GAxBa;EAyBpBiL,oBAAkB,GAzBE;EA0BpB7J,mBAAiB,IA1BG;EA2BpB+J,cAAY,GA3BQ;EA4BpBO,qBAAmB,KA5BC;EA6BpB3Y,YAAU,EA7BU;EA8BpB+I,YAAU,EA9BU;EA+BpBwB,iBAAe,IA/BK;EAgCpBC,gBAAc;EAhCM,CAAtB;;;;ECOA,IAAM4Q,YAAY,SAAZA,SAAY,aAAc;EAC9B,MAAMpiB,SAASwB,OAAO+W,MAAP,CAAc,EAAd,EAAkB4J,aAAlB,EAAiCE,UAAjC,CAAf;;EAEA,MAAIA,cAAcA,WAAWC,eAA7B,EAA8C;EAC5CxC,YAAQyC,IAAR,CACE,oFADF;EAGA7L,yBAAQ2L,WAAWC,eAAnB,EAAoC3hB,OAApC,CAA4C,aAAK;EAC/C,UAAIX,OAAO0B,UAAP,CAAkBd,EAAE2N,GAApB,CAAJ,EAA8B;EAC5BvO,eAAO0B,UAAP,CAAkBd,EAAE2N,GAApB,EAAyB2C,KAAzB,GAAiClR,OAAO0B,UAAP,CAAkBd,EAAE2N,GAApB,EAAyB2C,KAAzB,GAC7BlR,OAAO0B,UAAP,CAAkBd,EAAE2N,GAApB,EAAyB2C,KADI,GAE7BtQ,EAAElB,KAFN;EAGD,OAJD,MAIO;EACLM,eAAO0B,UAAP,CAAkBd,EAAE2N,GAApB,IAA2B;EACzB2C,iBAAOtQ,EAAElB;EADgB,SAA3B;EAGD;EACF,KAVD;EAWD;;EAED,MAAM8iB,aAAa,CACjB,QADiB,EAEjB,QAFiB,EAGjB,WAHiB,EAIjB,MAJiB,EAKjB,OALiB,EAMjB,UANiB,EAOjB,YAPiB,EAQjB,aARiB,EASjBhjB,MATiB,CASViC,kBAAKzB,MAAL,CATU,CAAnB;;EAWA,MAAMuE,SAASke,oBAASC,KAAT,CAAe1a,OAAf,EAAqBwa,UAArB,CAAf;EAAA,MACEzQ,QAAQ;EACNK,eAAW,KADL;EAENC,iBAAa,KAFP;EAGN+D,UAAM,KAHA;EAIN4L,iBAAa,KAJP;EAKNW,WAAO;EALD,GADV;EAAA,MAQEvX,SAAS0H,oBARX;EAAA,MASEyE,WAAW,EATb;EAAA,MAUE5S,OAAOoS,kBAAWlB,KAAX,CAAiB,CAAjB,CAVT;EAAA,MAWEnD,MAAM,EAXR;EAAA,MAYElF,SAAS,EAZX;;EAcA,MAAM1L,QAAQ;EACZmE,WAAO;EACL2c,YAAM;EACJnd,iBAAS,iBAAStE,EAAT,EAAa,EADlB;EAEJ2E,mBAAW,mBAAS3E,EAAT,EAAa,EAFpB;EAGJkC,kBAAU,oBAAW;EACnB,iBAAO,EAAP;EACD,SALG;EAMJ6C,oBAAY,sBAAW;EACrB,iBAAO,EAAP;EACD;EARG;EADD,KADK;EAaZ6K,UAAM,MAbM;EAcZ9M,eAAW,KAdC;EAeZ4M,iBAAa,uBAAW;EACtB,aAAO,KAAK5K,KAAL,CAAW,KAAK8K,IAAhB,CAAP;EACD;EAjBW,GAAd;;EAoBA,SAAO;EACL/Q,kBADK;EAELuE,kBAFK;EAGLie,0BAHK;EAILzQ,gBAJK;EAKL3G,kBALK;EAMLmM,sBANK;EAOL5S,cAPK;EAQL+N,YARK;EASLlF,kBATK;EAUL1L;EAVK,GAAP;EAYD,CA7ED;;ECPA,IAAM+gB,0BAA0B,SAA1BA,uBAA0B,CAAC7iB,MAAD,EAASY,CAAT,EAAe;EAC7C,MAAMke,mBAAmB,IAAIgE,GAAJ,EAAzB;EACA,MAAMC,gBAAgB,IAAID,GAAJ,EAAtB;EACA;EACA9iB,SAAOnB,IAAP,CAAY8B,OAAZ,CAAoB,UAAS4U,GAAT,EAAc;EAChC,QAAInT,SAASpC,OAAO0B,UAAP,CAAkBd,CAAlB,EAAqBuB,MAArB,CAA4BoT,IAAI3U,CAAJ,CAA5B,CAAb;EACA,QAAI,CAACmiB,cAAcC,GAAd,CAAkB5gB,MAAlB,CAAL,EAAgC;EAC9B2gB,oBAAcE,GAAd,CAAkB7gB,MAAlB,EAA0B,CAA1B;EACD;EACD,QAAI8gB,QAAQH,cAAchE,GAAd,CAAkB3c,MAAlB,CAAZ;EACA2gB,kBAAcE,GAAd,CAAkB7gB,MAAlB,EAA0B8gB,QAAQ,CAAlC;EACD,GAPD;;EASAljB,SAAOnB,IAAP,CAAY8B,OAAZ,CAAoB,UAAS4U,GAAT,EAAc;EAChC/T,WAAOC,IAAP,CAAYzB,OAAO0B,UAAnB,EAA+BtC,GAA/B,CAAmC,aAAK;EACtC,UAAIgD,SAASpC,OAAO0B,UAAP,CAAkBd,CAAlB,EAAqBuB,MAArB,CAA4BoT,IAAI3U,CAAJ,CAA5B,CAAb;EACA,UAAI,CAACke,iBAAiBkE,GAAjB,CAAqB5gB,MAArB,CAAL,EAAmC;EACjC,YAAM+gB,OAAO,IAAIL,GAAJ,EAAb;EACAhE,yBAAiBmE,GAAjB,CAAqB7gB,MAArB,EAA6B+gB,IAA7B;EACD;EACD,UAAI,CAACrE,iBAAiBC,GAAjB,CAAqB3c,MAArB,EAA6B4gB,GAA7B,CAAiCxf,CAAjC,CAAL,EAA0C;EACxCsb,yBAAiBC,GAAjB,CAAqB3c,MAArB,EAA6B6gB,GAA7B,CAAiCzf,CAAjC,EAAoC,CAApC;EACD;EACD,UAAI9D,QAAQof,iBAAiBC,GAAjB,CAAqB3c,MAArB,EAA6B2c,GAA7B,CAAiCvb,CAAjC,CAAZ;EACA9D,eAASM,OAAO0B,UAAP,CAAkB8B,CAAlB,EAAqBrB,MAArB,CAA4BoT,IAAI/R,CAAJ,CAA5B,IAAsCuf,cAAchE,GAAd,CAAkB3c,MAAlB,CAA/C;EACA0c,uBAAiBC,GAAjB,CAAqB3c,MAArB,EAA6B6gB,GAA7B,CAAiCzf,CAAjC,EAAoC9D,KAApC;EACD,KAZD;EAaD,GAdD;;EAgBA,SAAOof,gBAAP;EACD,CA9BD;;;;ECKA,IAAMsE,UAAU,SAAVA,OAAU,CAACjC,GAAD,EAAMkC,KAAN,EAAgB;EAC9BA,QAAM1iB,OAAN,CAAc,cAAM;EAClB,WAAOwgB,IAAImC,EAAJ,CAAP;EACD,GAFD;EAGA,SAAOnC,GAAP;EACD,CALD;;EAOA,IAAMoC,cAAc,SAAdA,WAAc,CAClBvjB,MADkB,EAElB0S,GAFkB,EAGlBvR,EAHkB,EAIlBiK,MAJkB,EAKlBzG,IALkB,EAMlBoN,KANkB,EAOlB6O,YAPkB,EAQlBJ,WARkB,EASlBkB,eATkB;EAAA,SAWlBe,oBACGC,KADH,CACS1a,OADT,EACexG,OAAOC,IAAP,CAAYzB,MAAZ,CADf,EAEGsF,EAFH,CAEM,WAFN,EAEmB,aAAK;EACpBoN,QAAIjF,UAAJ,CAAeqG,wBAAf,GAA0ClT,EAAElB,KAA5C;EACAgT,QAAIvP,OAAJ,CAAY2Q,wBAAZ,GAAuClT,EAAElB,KAAzC;EACD,GALH,EAMG4F,EANH,CAMM,OANN,EAMe,aAAK;EAChBoN,QAAIjF,UAAJ,CAAeuG,WAAf,GAA6BpT,EAAElB,KAA/B;EACAgT,QAAIvP,OAAJ,CAAY6Q,WAAZ,GAA0BpT,EAAElB,KAA5B;EACD,GATH,EAUG4F,EAVH,CAUM,cAVN,EAUsB,aAAK;EACvBoN,QAAIvP,OAAJ,CAAYwQ,WAAZ,GAA0B/S,EAAElB,KAA5B;EACD,GAZH,EAaG4F,EAbH,CAaM,OAbN,EAae;EAAA,WAAKnE,GAAGyW,MAAH,EAAL;EAAA,GAbf,EAcGtS,EAdH,CAcM,QAdN,EAcgB;EAAA,WAAKnE,GAAGyW,MAAH,EAAL;EAAA,GAdhB,EAeGtS,EAfH,CAeM,QAfN,EAegB;EAAA,WAAKnE,GAAGyW,MAAH,EAAL;EAAA,GAfhB,EAgBGtS,EAhBH,CAgBM,MAhBN,EAgBc,aAAK;EACfsb,iBAAanhB,IAAb,CAAkBmB,EAAElB,KAApB;EACA8gB,gBAAY/gB,IAAZ,CAAiBmB,EAAElB,KAAnB;EACAgiB,oBAAgBjiB,IAAhB,CAAqBmB,EAAElB,KAAvB;EACD,GApBH,EAqBG4F,EArBH,CAqBM,YArBN,EAqBoB,aAAK;EACrBtF,WAAO0B,UAAP,GAAoBP,GAAGsU,sBAAH,CAA0BjU,OAAOC,IAAP,CAAYb,EAAElB,KAAd,CAA1B,CAApB;EACA0L,WAAO5K,MAAP,CAAcW,GAAGkK,uBAAH,EAAd;EACAlK,OAAGuW,cAAH;EACA,QAAI3F,MAAMiQ,WAAV,EAAuB;EACrB7gB,SAAGrC,MAAH,GAAY+S,UAAZ;EACD;EACF,GA5BH,EA6BGvM,EA7BH,CA6BM,iBA7BN,EA6ByB,aAAK;EAC1B,QAAI,CAAC9D,OAAOC,IAAP,CAAYzB,OAAO0B,UAAnB,EAA+B9B,MAApC,EAA4CuB,GAAGgU,gBAAH;EAC5ChU,OAAGsR,SAAH;EACA,QAAI,OAAO7R,EAAElB,KAAT,KAAmB,QAAvB,EAAiC;EAC/B,UAAIkB,EAAElB,KAAF,GAAU8B,OAAOC,IAAP,CAAYzB,OAAO0B,UAAnB,EAA+B9B,MAA7C,EAAqD;EACnDI,eAAOqV,eAAP,GAAyBrV,OAAO0B,UAAP,CAAkBd,EAAElB,KAApB,CAAzB;EACD,OAFD,MAEO,IAAIkB,EAAElB,KAAF,GAAUM,OAAOgH,QAAP,CAAgBpH,MAA9B,EAAsC;EAC3CI,eAAOqV,eAAP,GAAyBrV,OAAOgH,QAAP,CAAgBpG,EAAElB,KAAlB,CAAzB;EACD;EACF,KAND,MAMO;EACLM,aAAOqV,eAAP,GAAyBzU,EAAElB,KAA3B;EACD;;EAEDM,WAAO8e,gBAAP,GAA0B+D,wBACxB7iB,MADwB,EAExBA,OAAOqV,eAFiB,CAA1B;EAIA,QAAItD,MAAMiQ,WAAV,EAAuB;EACrB7gB,SAAGrC,MAAH;EACD;EACF,GAjDH,EAkDGwG,EAlDH,CAkDM,UAlDN,EAkDkB,aAAK;EACnBnE,OAAG8B,UAAH;EACA9B,OAAGO,UAAH,CAAcP,GAAGsU,sBAAH,EAAd;EACAtU,OAAGO,UAAH,CAAc0hB,QAAQpjB,OAAO0B,UAAf,EAA2Bd,EAAElB,KAA7B,CAAd;EACAyB,OAAGrC,MAAH;EACD,GAvDH,EAwDGwG,EAxDH,CAwDM,UAxDN,EAwDkB,aAAK;EACnB,QAAI1E,EAAElB,KAAF,IAAWkB,EAAElB,KAAF,CAAQE,MAAvB,EAA+B;EAC7BgB,QAAElB,KAAF,CAAQiB,OAAR,CAAgB,UAASuC,SAAT,EAAoB;EAClCiO,6BAAqBnR,MAArB,EAA6BmB,EAA7B,EAAiCwD,IAAjC,EAAuCzB,SAAvC;EACD,OAFD;EAGA/B,SAAG0Q,UAAH,CAAc,CAAd;EACD;EACF,GA/DH,CAXkB;EAAA,CAApB;;ECZA,IAAM2R,SAAS,SAATA,MAAS,CAAC9F,GAAD,EAAMxc,KAAN,EAAaqD,MAAb,EAAqBkf,YAArB,EAAsC;EACnDjiB,SAAOC,IAAP,CAAYP,KAAZ,EAAmBP,OAAnB,CAA2B,UAAS4N,GAAT,EAAc;EACvCmP,QAAInP,GAAJ,IAAW,UAAS3F,CAAT,EAAY;EACrB,UAAI,CAACjJ,UAAUC,MAAf,EAAuB;EACrB,eAAOsB,MAAMqN,GAAN,CAAP;EACD;EACD,UACEA,QAAQ,YAAR,IACA/M,OAAO4D,SAAP,CAAiBmC,QAAjB,CAA0B5E,IAA1B,CAA+BiG,CAA/B,MAAsC,gBAFxC,EAGE;EACAkX,gBAAQyC,IAAR,CAAa,wDAAb;EACA3Z,YAAI8U,IAAIjI,sBAAJ,CAA2B7M,CAA3B,CAAJ;EACD;EACD,UAAI8a,MAAMxiB,MAAMqN,GAAN,CAAV;EACArN,YAAMqN,GAAN,IAAa3F,CAAb;EACA6a,mBAAa9gB,IAAb,CAAkB4L,GAAlB,EAAuBmP,GAAvB,EAA4B,EAAEhe,OAAOkJ,CAAT,EAAY+a,UAAUD,GAAtB,EAA5B;EACAnf,aAAO5B,IAAP,CAAY4L,GAAZ,EAAiBmP,GAAjB,EAAsB,EAAEhe,OAAOkJ,CAAT,EAAY+a,UAAUD,GAAtB,EAAtB;EACA,aAAOhG,GAAP;EACD,KAhBD;EAiBD,GAlBD;EAmBD,CApBD;;ECAA;AACA;EAGA,IAAMkG,YAAY,SAAZA,SAAY,CAACC,MAAD,EAASC,MAAT,EAAiBC,MAAjB;EAAA,SAChB,YAAW;EACT,QAAMrkB,QAAQqkB,OAAOrB,KAAP,CAAaoB,MAAb,EAAqBnkB,SAArB,CAAd;EACA,WAAOD,UAAUokB,MAAV,GAAmBD,MAAnB,GAA4BnkB,KAAnC;EACD,GAJe;EAAA,CAAlB;;EAMA,IAAMskB,UAAU,SAAVA,OAAU,CAACH,MAAD,EAASC,MAAT,EAAiBC,MAAjB,EAA4B;EAC1CF,SAAOE,MAAP,IAAiBH,UAAUC,MAAV,EAAkBC,MAAlB,EAA0BA,OAAOC,MAAP,CAA1B,CAAjB;EACA,SAAOF,MAAP;EACD,CAHD;;EAKA,IAAMI,aAAa,SAAbA,UAAa,CACjBC,EADiB,EAEjBxR,GAFiB,EAGjBvR,EAHiB,EAIjBiK,MAJiB,EAKjB2G,KALiB,EAMjB6O,YANiB,EAOjBJ,WAPiB,EAQjBkB,eARiB,EASjBnd,MATiB,EAUjBI,IAViB,EAWd;EACH,MAAM8e,eAAeF,YACnBW,EADmB,EAEnBxR,GAFmB,EAGnBvR,EAHmB,EAInBiK,MAJmB,EAKnBzG,IALmB,EAMnBoN,KANmB,EAOnB6O,YAPmB,EAQnBJ,WARmB,EASnBkB,eATmB,CAArB;;EAYA;EACA8B,SAAOriB,EAAP,EAAW+iB,EAAX,EAAe3f,MAAf,EAAuBkf,YAAvB;;EAEA;EACA;EACAO,UAAQ7iB,EAAR,EAAYoD,MAAZ,EAAoB,IAApB;;EAEAyf,UACE7iB,EADF,EAEEwD,IAFF,EAGE,OAHF,EAIE,QAJF,EAKE,YALF,EAME,eANF,EAOE,UAPF,EAQE,aARF,EASE,YATF;EAWD,CA1CD;;ECfA;AACA;EAwEA,IAAMwf,YAAY,SAAZA,SAAY,aAAc;EAC9B,MAAMjjB,QAAQkhB,UAAUC,UAAV,CAAd;EAD8B,MAG5BriB,MAH4B,GAY1BkB,KAZ0B,CAG5BlB,MAH4B;EAAA,MAI5BuE,MAJ4B,GAY1BrD,KAZ0B,CAI5BqD,MAJ4B;EAAA,MAK5BwN,KAL4B,GAY1B7Q,KAZ0B,CAK5B6Q,KAL4B;EAAA,MAM5B3G,MAN4B,GAY1BlK,KAZ0B,CAM5BkK,MAN4B;EAAA,MAO5BmM,QAP4B,GAY1BrW,KAZ0B,CAO5BqW,QAP4B;EAAA,MAQ5B5S,IAR4B,GAY1BzD,KAZ0B,CAQ5ByD,IAR4B;EAAA,MAS5B+N,GAT4B,GAY1BxR,KAZ0B,CAS5BwR,GAT4B;EAAA,MAU5BlF,MAV4B,GAY1BtM,KAZ0B,CAU5BsM,MAV4B;EAAA,MAW5B1L,KAX4B,GAY1BZ,KAZ0B,CAW5BY,KAX4B;;;EAc9B,MAAMX,KAAK+gB,KAAKliB,MAAL,EAAawN,MAAb,EAAqBkF,GAArB,CAAX;;EAEA,MAAMZ,WAAW,SAAXA,QAAW,IAAK;EACpB,QAAI1G,OAAO3K,KAAP,GAAeb,MAAf,KAA0B,CAA9B,EAAiC;EAC/BwL,aAAO3K,KAAP,CAAa,CAAC,CAAD,EAAIV,EAAEC,MAAF,CAAJ,CAAb,EAA6B,CAA7B;EACD;EACD,WAAOuX,SAAS3W,CAAT,KAAe,IAAf,GAAsBwK,OAAOxK,CAAP,CAAtB,GAAkC2W,SAAS3W,CAAT,CAAzC;EACD,GALD;;EAOA,MAAMggB,eAAetiB,YAAYmiB,YAAYzgB,MAAZ,EAAoB0S,GAApB,EAAyBZ,QAAzB,CAAZ,EAClBrS,IADkB,CACb,EADa,EAElBK,KAFkB,CAEZ;EAAA,WAAMqB,GAAGrB,KAAH,CAAS,SAAT,CAAN;EAAA,GAFY,CAArB;;EAIA,MAAM0gB,cAAcliB,YAAY8hB,SAASpgB,MAAT,EAAiB0S,GAAjB,EAAsBZ,QAAtB,CAAZ,EACjBrS,IADiB,CACZ,EADY,EAEjBK,KAFiB,CAEX;EAAA,WAAMqB,GAAGrB,KAAH,CAAS,QAAT,CAAN;EAAA,GAFW,CAApB;;EAIA,MAAM4hB,kBAAkBpjB,YAAYgjB,eAAethB,MAAf,EAAuB0S,GAAvB,EAA4BZ,QAA5B,CAAZ,EACrBrS,IADqB,CAChB,EADgB,EAErBK,KAFqB,CAEf,YAAW;EAChBqB,OAAGrB,KAAH,CAAS,YAAT;EACAqB,OAAGrB,KAAH,CAAS,WAAT;EACD,GALqB,CAAxB;;EAOAmkB,aACEjkB,MADF,EAEE0S,GAFF,EAGEvR,EAHF,EAIEiK,MAJF,EAKE2G,KALF,EAME6O,YANF,EAOEJ,WAPF,EAQEkB,eARF,EASEnd,MATF,EAUEI,IAVF;;EAaA;EACAxD,KAAGD,KAAH,GAAWlB,MAAX;EACAmB,KAAG4Q,KAAH,GAAWA,KAAX;;EAEA5Q,KAAGsR,SAAH,GAAeA,UAAUzS,MAAV,EAAkBmB,EAAlB,EAAsBiK,MAAtB,EAA8BsH,GAA9B,CAAf;EACAvR,KAAGZ,KAAH,GAAWA,MAAMP,MAAN,EAAcmB,EAAd,CAAX;EACAA,KAAGiQ,IAAH,GAAUA,KAAKpR,MAAL,CAAV;EACAmB,KAAG6T,WAAH,GAAiBA,YAAYhV,MAAZ,EAAoBmB,EAApB,CAAjB;EACAA,KAAGgU,gBAAH,GAAsBA,iBAAiBhU,EAAjB,CAAtB;EACA;EACAA,KAAGwU,oBAAH,GAA0BA,oBAA1B;EACAxU,KAAGsU,sBAAH,GAA4BA,uBAAuBzV,MAAvB,EAA+BmB,EAA/B,CAA5B;EACAA,KAAGkK,uBAAH,GAA6BA,wBAAwBrL,MAAxB,CAA7B;;EAEA;EACAmB,KAAGrC,MAAH,GAAYA,OAAOkB,MAAP,EAAemB,EAAf,EAAmBoD,MAAnB,CAAZ;EACApD,KAAG6B,aAAH,GAAmBA,cAAchD,MAAd,EAAsBmB,EAAtB,EAA0BoD,MAA1B,CAAnB;EACApD,KAAGwW,YAAH,GAAkBA,aAAa3X,MAAb,EAAqBmB,EAArB,EAAyBoD,MAAzB,CAAlB;EACApD,KAAGrC,MAAH,CAAU0iB,OAAV,GAAoBD,cAAcvhB,MAAd,EAAsBmB,EAAtB,EAA0BuR,GAA1B,EAA+BZ,QAA/B,CAApB;EACA3Q,KAAGrC,MAAH,CAAU6iB,KAAV,GAAkBF,mBAAmBzhB,MAAnB,EAA2BmB,EAA3B,EAA+BugB,eAA/B,CAAlB;EACAvgB,KAAG6B,aAAH,CAAiBwe,OAAjB,GAA2Bd,qBACzB1gB,MADyB,EAEzB0S,GAFyB,EAGzBZ,QAHyB,EAIzB3Q,EAJyB,EAKzBW,KALyB,CAA3B;EAOAX,KAAG6B,aAAH,CAAiB2e,KAAjB,GAAyBhB,mBAAmB3gB,MAAnB,EAA2B8B,KAA3B,EAAkC8e,YAAlC,CAAzB;EACAzf,KAAGwW,YAAH,CAAgB6J,OAAhB,GAA0BlB,oBAAoBtgB,MAApB,EAA4BmB,EAA5B,EAAgCuR,GAAhC,EAAqCZ,QAArC,CAA1B;EACA3Q,KAAGwW,YAAH,CAAgBgK,KAAhB,GAAwBpB,kBAAkBvgB,MAAlB,EAA0BwgB,WAA1B,CAAxB;;EAEArf,KAAGijB,sBAAH,GAA4B9O,qBAAqBtV,MAArB,EAA6B8R,QAA7B,CAA5B;EACA3Q,KAAG8gB,OAAH,GAAaA,QAAQlQ,KAAR,EAAe5Q,EAAf,CAAb;EACAA,KAAGkV,QAAH,GAAcA,SAASrW,MAAT,EAAiBmB,EAAjB,EAAqB2Q,QAArB,CAAd;EACA3Q,KAAGrB,KAAH,GAAWA,MAAME,MAAN,EAAcmB,EAAd,EAAkBuR,GAAlB,EAAuB5Q,KAAvB,CAAX;EACAX,KAAGuE,UAAH,GAAgBA,WAAW1F,MAAX,EAAmBmB,EAAnB,EAAuBiK,MAAvB,EAA+B2G,KAA/B,EAAsCpN,IAAtC,CAAhB;EACAxD,KAAG+U,UAAH,GAAgBA,WAAW/U,EAAX,CAAhB;EACAA,KAAG0Q,UAAH,GAAgBA,WAAW7R,MAAX,EAAmBmB,EAAnB,EAAuB2Q,QAAvB,EAAiCnN,IAAjC,EAAuCoN,KAAvC,CAAhB;EACA5Q,KAAG+Q,eAAH,GAAqBA,eAArB;EACA/Q,KAAGiR,SAAH,GAAeA,UAAUpS,MAAV,EAAkBmB,EAAlB,EAAsB4Q,KAAtB,CAAf;EACA5Q,KAAG8B,UAAH,GAAgBA,aAAWjD,MAAX,EAAmBmB,EAAnB,CAAhB;EACAA,KAAGkC,QAAH,GAAcA,WAASrD,MAAT,EAAiBmB,EAAjB,CAAd;EACAA,KAAGkR,WAAH,GAAiBA,YAAYrS,MAAZ,EAAoBmB,EAApB,EAAwBiK,MAAxB,EAAgC0G,QAAhC,EAA0CyF,QAA1C,EAAoDxF,KAApD,CAAjB;;EAEA;EACA;EACA;EACA5Q,KAAG0W,OAAH,GAAaA,QAAQ7X,MAAR,EAAgBmB,EAAhB,EAAoBiK,MAApB,CAAb;EACAjK,KAAG4W,uBAAH,GAA6BA,wBAAwB/X,MAAxB,CAA7B;EACAmB,KAAGuW,cAAH,GAAoBA,eAAe1X,MAAf,EAAuB8R,QAAvB,CAApB;;EAEA;EACA3Q,KAAGkjB,cAAH,GAAoBpD,aAApB;EACA9f,KAAG6gB,WAAH,GAAiBA,YAAYjQ,KAAZ,CAAjB;;EAEA;EACA5Q,KAAGiK,MAAH,GAAYA,MAAZ;EACAjK,KAAGuR,GAAH,GAASA,GAAT;EACAvR,KAAGqM,MAAH,GAAYA,MAAZ;EACArM,KAAGoB,CAAH,GAAO;EAAA,WAAMpB,GAAGgV,EAAT;EAAA,GAAP;;EAEA;EACA;EACAhV,KAAGyW,MAAH,GAAYA,OAAO5X,MAAP,EAAemB,EAAf,EAAmB4Q,KAAnB,EAA0BxN,MAA1B,CAAZ;;EAEA;EACApD,KAAGgT,SAAH,GAAeA,UAAUnU,MAAV,EAAkBmB,EAAlB,EAAsBqM,MAAtB,EAA8BjJ,MAA9B,EAAsCmO,GAAtC,EAA2CZ,QAA3C,CAAf;EACA;EACA3Q,KAAGgX,WAAH,GAAiBA,YAAYnY,MAAZ,EAAoBmB,EAApB,EAAwBqM,MAAxB,CAAjB;;EAEA;EACArM,KAAGkX,IAAH,GAAUA,KAAKrY,MAAL,EAAamB,EAAb,EAAiBqM,MAAjB,EAAyBjJ,MAAzB,EAAiCmO,GAAjC,EAAsCZ,QAAtC,CAAV;EACA;EACA3Q,KAAGiX,MAAH,GAAYA,OAAOpY,MAAP,EAAemB,EAAf,EAAmBqM,MAAnB,CAAZ;;EAEA;EACA;EACArM,KAAG8L,YAAH,GAAkBA,YAAlB;;EAEA;EACA;EACA9L,KAAG+L,cAAH,GAAoBA,eAAe/L,EAAf,CAApB;EACAA,KAAG6P,UAAH,GAAgB;EAAA,WAAMxP,OAAOmI,mBAAP,CAA2B7H,MAAMmE,KAAjC,CAAN;EAAA,GAAhB;EACA9E,KAAG2P,SAAH,GAAeA,UAAUhP,KAAV,EAAiB9B,MAAjB,EAAyBmB,EAAzB,CAAf;;EAEA;EACA6E,gBAAclE,KAAd,EAAqB9B,MAArB,EAA6BmB,EAA7B,EAAiCoD,MAAjC;EACAoH,kBAAgB7J,KAAhB,EAAuB9B,MAAvB,EAA+BmB,EAA/B,EAAmCoD,MAAnC,EAA2C6G,MAA3C;EACA4B,sBAAoBlL,KAApB,EAA2B9B,MAA3B,EAAmCmB,EAAnC,EAAuCoD,MAAvC,EAA+C6G,MAA/C;EACAkZ,qBAAmBxiB,KAAnB,EAA0B9B,MAA1B,EAAkCmB,EAAlC,EAAsCoD,MAAtC;;EAEApD,KAAGojB,OAAH,GAAaA,OAAb;EACA;EACApjB,KAAGoG,QAAH,GAAcA,SAASvH,MAAT,CAAd;EACAmB,KAAG2f,MAAH,GAAYA,MAAZ;EACA;EACA3f,KAAGygB,mBAAH,GAAyBA,mBAAzB;;EAEA,SAAOzgB,EAAP;EACD,CAtJD;;;;;;;;"}